import{f as le,r,a as A,j as n,b as e,G as re,A as Q,L as ue,F as X,N as me,E as he,P as ge,D as pe,V as fe,c as $,d as M,e as j,g as U,h as Se,R as _e,U as Ne,i as ve,k as R,C as Y,l as Z,S as ee,m as xe,n as Ce,o as Ee,p as te,q as L,s as ne,t as Be,u as Fe,v as se,w as we,x as Ae}from"./vendor.71b7dffb.js";const ke=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))g(d);new MutationObserver(d=>{for(const o of d)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&g(h)}).observe(document,{childList:!0,subtree:!0});function l(d){const o={};return d.integrity&&(o.integrity=d.integrity),d.referrerpolicy&&(o.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?o.credentials="include":d.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function g(d){if(d.ep)return;d.ep=!0;const o=l(d);fetch(d.href,o)}};ke();const be="_nav_11k4b_2",De="_title_11k4b_12",Ie="_subTitle_11k4b_20",ye="_main_11k4b_29",Pe="_gameList_11k4b_33",Le="_singleGameEntryButton_11k4b_39",Te="_buttonIcon_11k4b_54",ze="_addIcon_11k4b_58",Ge="_createPanel_11k4b_65",Oe="_createPanelTitle_11k4b_75",$e="_createPanelInput_11k4b_81",Me="_createButton_11k4b_87";var k={nav:be,title:De,subTitle:Ie,main:ye,gameList:Pe,singleGameEntryButton:Le,buttonIcon:Te,addIcon:ze,createPanel:Ge,createPanelTitle:Oe,createPanelInput:$e,createButton:Me};const a=new le;a.set("updateEditor",!0);const ie={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[]},s=JSON.parse(JSON.stringify(ie)),je=()=>{const[t,c]=r.exports.useState(!0),[l,g]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refManagement",t),a.connect("refManagement",()=>{c(a.get("refManagement"))},"refManagementFunc"),d()},[]);const d=()=>{A.get(s.domain+"/api/manageGame/gameList").then(f=>{s.gameList=f.data,a.set("refManagement",!a.get("refManagement"))}).catch(f=>{console.log(f)})};let o=[];for(const f of s.gameList){const p=n("div",{className:k.singleGameEntryButton,onClick:()=>{for(const _ in s)s[_]=ie[_];s.currentEditGame=f,a.set("isManagement",!1)},children:[e(re,{theme:"outline",size:"24",fill:"#333",className:k.buttonIcon}),f]},f);o.push(p)}const h=f=>{const p=`${s.domain}/api/manageGame/createGame/${f}`;A.get(p).then(_=>{g(!1),d()})};return n("div",{children:[e("header",{children:e("nav",{children:e("div",{className:k.nav,children:e("div",{className:k.title,children:"WebGAL ORIGINE"})})})}),n("main",{className:k.main,children:[n("div",{className:k.subTitle,children:["\u6E38\u620F\u5217\u8868",n("span",{onClick:()=>g(!l),className:k.addIcon,children:[e(Q,{theme:"outline",size:"18",fill:"#8E354A"})," \u65B0\u5EFA\u6E38\u620F"]}),l&&n("div",{className:k.createPanel,children:[e("div",{className:k.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),n("div",{children:["\u6E38\u620F\u540D\u79F0\uFF1A",e("input",{id:"createInput",className:k.createPanelInput})]}),e("div",{style:{textAlign:"center"},children:e("div",{onClick:()=>h(document.getElementById("createInput").value),className:k.createButton,children:"\u521B\u5EFA"})})]})]}),e("div",{className:k.gameList,children:o})]})]})},Ue="_nav_fct5m_1",Re="_title_fct5m_13",Ve="_titleIcon_fct5m_21";var V={nav:Ue,title:Re,titleIcon:Ve};const qe=()=>n("div",{className:V.nav,children:[e(ue,{theme:"filled",size:"30",fill:"#333",className:V.titleIcon,onClick:()=>{a.set("isManagement",!0)}}),e("div",{className:V.title,children:"WebGAL ORIGINE"})]}),Je="_aside_ckeg5_1",We="_option_ckeg5_10",Ke="_optionMarker_ckeg5_20",He="_optionMarkerOff_ckeg5_28",Qe="_chooseItem_ckeg5_36",Xe="_chooseTitle_ckeg5_47",Ye="_chooseDescription_ckeg5_52",Ze="_tagButton_ckeg5_57",et="_tagButtonOn_ckeg5_65",tt="_sideBarContent_ckeg5_73";var I={aside:Je,option:We,optionMarker:Ke,optionMarkerOff:He,chooseItem:Qe,chooseTitle:Xe,chooseDescription:Ye,tagButton:Ze,tagButtonOn:et,sideBarContent:tt};const nt="_title_jfelw_1",st="_previewGameButton_jfelw_10",it="_gameNameInput_jfelw_20";var T={title:nt,previewGameButton:st,gameNameInput:it};const ct="_choosed_imeie_1",at="_chooseBox_imeie_7",ot="_chooseIcon_imeie_11",dt="_fileList_imeie_26",lt="_singleFile_imeie_38",rt="_fileIcon_imeie_49";var y={choosed:ct,chooseBox:at,chooseIcon:ot,fileList:dt,singleFile:lt,fileIcon:rt};const b=t=>{const[c,l]=r.exports.useState(!1),[g,d]=r.exports.useState(t.dir),[o,h]=r.exports.useState([]),[f,p]=r.exports.useState(""),_=u=>{const E={dir:`/${s.currentEditGame}/game/${u}`};A.post(`${s.domain}/api/editGame/getAssets/`,E).then(C=>{h(C.data)}).catch(C=>{console.log(C)})},v=u=>{let m=u.split("/");u="";let E=0;for(const C of m)C!==t.dir&&(E!==0&&(u=u+"/"),E++,u=u+C);return u},S=u=>{let m=g+"/"+u;m=v(m),t.set(m),t.hasOwnProperty("setShow")&&t.setShow(m)};r.exports.useEffect(()=>{_(g)},[]);let N=[];for(const u of o){let m=!0,E=!0;u.match(/\.json/)&&(E=!1),u.match(/\./)&&(m=!1);let C=e("div",{children:""});m?C=n("div",{className:y.singleFile,onClick:()=>{const F=g+"/"+u;d(F),_(F)},children:[e(X,{theme:"outline",size:"18",fill:"#333",className:y.fileIcon}),u]},u):C=n("div",{className:y.singleFile,onClick:()=>{p(v(g+"/"+u)),S(u),l(!c)},children:[e(me,{theme:"outline",size:"18",fill:"#333",className:y.fileIcon}),u]},u),E&&N.push(C)}return n("div",{children:[e("div",{className:y.chooseBox,children:n("div",{className:y.chooseIcon,onClick:()=>{c===!1&&(d(t.dir),p(""),_(t.dir)),l(!c)},children:[e(he,{theme:"outline",size:"16",fill:"#333"})," \u9009\u62E9\u6587\u4EF6"]})}),e("div",{style:{position:"relative"},children:c&&e("div",{className:y.fileList,children:N})})]})},ut=()=>{r.exports.useState(!1);const[t,c]=r.exports.useState(""),[l,g]=r.exports.useState(""),[d,o]=r.exports.useState(""),h=()=>{A.get(`${s.domain}/Games/${s.currentEditGame}/game/gameConfig.json`).then(S=>{let N=S.data;s.currentGameConfig=S.data,document.getElementById("gameNameInput").value=N.Game_name,c(N.Title_bgm),g(N.Title_img),o(N.Loading_img)})},f=()=>{s.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,v()},p=(S,N)=>{s.currentGameConfig[S]=N,v()},_=S=>N=>{p(S,N)},v=()=>{let S={currentEditGame:s.currentEditGame,config:s.currentGameConfig};A.post(`${s.domain}/api/manageGame/config`,S).then(N=>{})};return r.exports.useEffect(()=>{h()},[]),n("div",{style:{width:"100%"},children:[e("div",{children:e("a",{style:{color:"black",textDecoration:"none"},href:`${s.domain}/Games/${s.currentEditGame}`,target:"_blank",children:n("div",{className:T.previewGameButton,children:[e(ge,{theme:"outline",size:"28",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,5px)"}}),"\u9884\u89C8\u6E38\u620F"]})})}),n("div",{children:[e("div",{className:T.title,children:"\u6E38\u620F\u540D\u79F0"}),e("div",{children:e("input",{onBlur:f,id:"gameNameInput",className:T.gameNameInput})})]}),n("div",{children:[e("div",{className:T.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),n("div",{children:[t,e(b,{setShow:c,id:"bgmPicker",dir:"bgm",set:_("Title_bgm")})]})]}),n("div",{children:[e("div",{className:T.title,children:"\u6807\u9898\u80CC\u666F"}),n("div",{children:[l,e(b,{setShow:g,id:"bgPicker",dir:"background",set:_("Title_img")})]})]}),n("div",{children:[e("div",{className:T.title,children:"\u52A0\u8F7D\u56FE"}),n("div",{children:[d,e(b,{setShow:o,id:"loadImgPicker",dir:"background",set:_("Loading_img")})]})]})]})},mt="_dirButtonContainer_15ysv_2",ht="_icon_small_15ysv_8",gt="_controlPanel_15ysv_15",pt="_upload_15ysv_19",ft="_dirButton_15ysv_2",St="_fileElement_15ysv_41",_t="_title_15ysv_58",Nt="_currentDirShow_15ysv_68",vt="_panelButton_15ysv_78",xt="_uploadTitle_15ysv_90",Ct="_uploadButton_15ysv_98";var B={dirButtonContainer:mt,icon_small:ht,controlPanel:gt,upload:pt,dirButton:ft,fileElement:St,title:_t,currentDirShow:Nt,panelButton:vt,uploadTitle:xt,uploadButton:Ct};const ce={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},ae=t=>{let c=e(X,{theme:"outline",size:"22",fill:"#333"});switch(t.icon){case"background":c=e(U,{theme:"outline",size:"22",fill:"#333"});break;case"bgm":c=e(j,{theme:"outline",size:"22",fill:"#333"});break;case"figure":c=e(M,{theme:"outline",size:"22",fill:"#333"});break;case"video":c=e($,{theme:"outline",size:"22",fill:"#333"});break;case"vocal":c=e(fe,{theme:"outline",size:"22",fill:"#333"});break;case"file":c=e(pe,{theme:"outline",size:"22",fill:"#333"})}return c},Et=()=>{const[t,c]=r.exports.useState(!0),[l,g]=r.exports.useState(!1),[d,o]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refAssetsManagement",t),a.connect("refAssetsManagement",()=>{c(a.get("refAssetsManagement"))},"refAssetsManagement"),h()},[]);const h=()=>{const m=s.currentEditGame,E=s.currentDir,C={dir:`/${m}/game/${E}`};A.post(`${s.domain}/api/editGame/getAssets/`,C).then(F=>{s.currentDirContent=F.data,a.set("refAssetsManagement",!a.get("refAssetsManagement"))}).catch(F=>{console.log(F)})},f=()=>{if(s.currentDir==="")return;let m=s.currentDir.split("/");m.pop(),s.currentDir=m.reduce((E,C)=>""+E+"/"+C),h()},p=m=>{s.currentDir=s.currentDir+`/${m}`,h()},_=()=>{const m=s.currentEditGame,E=s.currentDir,C=`/${m}/game/${E}`;let F=new FormData;F.append("dir",C);const O=document.getElementById("uploadFile").files[0];let z=document.getElementById("uploadFile").value;F.append("file",O,z),A.post(`${s.domain}/api/editGame/addAsset/`,F,{headers:{"Content-Type":"multipart/form-data"}}).then(H=>{g(!1),h()}).catch(H=>{console.log(H)})},v=()=>{const m=s.currentEditGame,E=s.currentDir,C=`/${m}/game/${E}`,F=document.getElementById("addDirInput").value,O={current:C,Name:F};A.post(`${s.domain}/api/editGame/mkdir/`,O).then(z=>{o(!1),h()}).catch(z=>{console.log(z)})},S=()=>{g(!l)},N=()=>{o(!d)},u=[];for(const m of s.currentDirContent){let E="",C=!0;if(m.match(/\./))s.currentDir===""&&(C=!1),E=n("div",{className:B.fileElement,children:[e("span",{className:B.icon_small,children:e(ae,{icon:"file"})}),m]},m);else{let F=m;s.currentDir===""&&ce.hasOwnProperty(m)&&(F=ce[m]),E=n("div",{className:B.dirButton,onClick:()=>p(m),children:[e("span",{className:B.icon_small,children:e(ae,{icon:m})}),F]},m),m==="scene"&&s.currentDir===""&&(C=!1)}C&&u.push(E)}return n(Se,{children:[s.currentDir!==""&&e("div",{className:B.currentDirShow,children:s.currentDir}),s.currentDir!==""&&n("div",{className:B.controlPanel,children:[e("div",{children:e(_e,{theme:"outline",size:"24",fill:"#333",onClick:f,className:B.panelButton})}),n("div",{children:[e(Ne,{theme:"outline",size:"24",fill:"#333",onClick:S,className:B.panelButton}),l&&n("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u4E0A\u4F20\u6587\u4EF6"}),e("input",{id:"uploadFile",type:"file"}),e("div",{className:B.uploadButton,onClick:_,children:"\u4E0A\u4F20"})]})]}),n("div",{children:[e(ve,{theme:"outline",size:"24",fill:"#333",onClick:N,className:B.panelButton}),d&&n("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"}),e("input",{id:"addDirInput"}),e("div",{className:B.uploadButton,onClick:v,children:"\u65B0\u5EFA"})]})]})]}),e("div",{}),e("div",{className:B.dirButtonContainer,children:u})]})},Bt="_main_1dzb8_1",Ft="_addInput_1dzb8_12",wt="_title_1dzb8_20",At="_addButton_1dzb8_26";var G={main:Bt,addInput:Ft,title:wt,addButton:At};const kt=t=>{const c=()=>{const l={gameName:s.currentEditGame,sceneName:document.getElementById("addSceneName").value};A.post(`${s.domain}/api/editGame/addNewScene/`,l).then(g=>{t.added()}).catch(g=>{console.log(g)})};return n("div",{className:G.main,children:[n("div",{className:G.title,children:["\u573A\u666F\u540D\u79F0\uFF1A",e("input",{className:G.addInput,id:"addSceneName"})]}),e("div",{className:G.addButton,onClick:c,children:"\u65B0\u5EFA\u573A\u666F"})]})},bt="_titleText_1j8ez_1",Dt="_scene_1j8ez_11",It="_newSceneButton_1j8ez_22",yt="_sceneList_1j8ez_30";var q={titleText:bt,scene:Dt,newSceneButton:It,sceneList:yt};const Pt=()=>{const[t,c]=r.exports.useState([]),[l,g]=r.exports.useState(!1),d=()=>{const v={dir:`/${s.currentEditGame}/game/scene`};A.post(`${s.domain}/api/editGame/getAssets/`,v).then(S=>{c(S.data)}).catch(S=>{console.log(S)})},o=()=>{d(),g(!l)};r.exports.useEffect(()=>{d()},[]);const h=p=>{s.currentOpendSceneEdit.includes(p)||s.currentOpendSceneEdit.push(p),s.currentEditScene=p,a.set("updateEditor",!a.get("updateEditor"))},f=[];for(const p of t){let _=!1,v=p.split(".");v[v.length-1]==="json"&&(_=!0);const S=n("div",{className:q.scene,onClick:()=>h(p),children:[e(R,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),p]},p);_&&f.push(S)}return n("div",{style:{width:"100%"},children:[n("div",{className:q.newSceneButton,onClick:()=>{g(!l)},children:[e(Q,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0",transform:"translate(0,2px)"}}),"\u65B0\u5EFA\u573A\u666F"]}),e("div",{children:l&&e(kt,{added:o})}),e("div",{className:q.sceneList,children:f})]})},Lt=()=>{const t=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[c,l]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refSideBar",c),a.connect("refSideBar",()=>{l(a.get("refSideBar"))},"refSideBarFunc")},[]);const g=[];for(const o of t){let h;o===s.editorTag?h=e("div",{className:I.optionMarker}):h=e("div",{className:I.optionMarkerOff});const f=n("div",{className:o===s.editorTag?I.tagButtonOn:I.tagButton,onClick:()=>{s.editorTag=o,a.set("refSideBar",!a.get("refSideBar"))},children:[e("div",{children:o}),h]},o);g.push(f)}let d;switch(s.editorTag){case"\u6E38\u620F\u914D\u7F6E":d=e(ut,{});break;case"\u7D20\u6750\u7BA1\u7406":d=e(Et,{});break;case"\u573A\u666F\u7BA1\u7406":d=e(Pt,{});break}return n("aside",{className:I.aside,children:[e("div",{className:I.option,children:g}),e("div",{className:I.sideBarContent,children:d})]})},Tt="_main_19sml_1";var zt={main:Tt};const Gt="_main_p4702_1",Ot="_tag_p4702_7",$t="_tagOpened_p4702_17",Mt="_tagList_p4702_24",jt="_tagIcon_p4702_28",Ut="_closeIcon_p4702_33";var D={main:Gt,tag:Ot,tagOpened:$t,tagList:Mt,tagIcon:jt,closeIcon:Ut};const Rt="_topButtonList_r236b_1",Vt="_topButton_r236b_1",qt="_addSentencePanel_r236b_22",Jt="_addSentenceButton_r236b_31",Wt="_sentenceList_r236b_41",Kt="_sentence_r236b_41",Ht="_sentenceIn_r236b_1",Qt="_lineNumber_r236b_54",Xt="_sentenceMain_r236b_64";var x={topButtonList:Rt,topButton:Vt,addSentencePanel:qt,addSentenceButton:Jt,sentenceList:Wt,sentence:Kt,sentenceIn:Ht,lineNumber:Qt,sentenceMain:Xt};const Yt=t=>{let c;switch(t){case"dialog":c={type:t,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":c={type:t,bg:"",noBg:!1,next:!1};break;case"bgm":c={type:t,bgm:"",noBgm:!1};break;case"changeScene":c={type:t,newScene:""};break;case"video":c={type:t,video:""};break;case"changeP":c={type:t,newP:"",next:!1,noP:!1,pos:""};break;case"choose":c={type:t,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break}return c},Zt="_sentence_tjlyp_1",en="_dialog_input_tjlyp_7",tn="_singleOption_tjlyp_15",nn="_optionTitle_tjlyp_23",sn="_optionContent_tjlyp_31",cn="_isolate_tjlyp_35",an="_sentenceButtonList_tjlyp_40",on="_sentenceButton_tjlyp_40",dn="_sentenceIndexShow_tjlyp_60",ln="_barContainer_tjlyp_74",rn="_mainEdit_tjlyp_84",un="_topContainer_tjlyp_92";var i={sentence:Zt,dialog_input:en,singleOption:tn,optionTitle:nn,optionContent:sn,isolate:cn,sentenceButtonList:an,sentenceButton:on,sentenceIndexShow:dn,barContainer:ln,mainEdit:rn,topContainer:un};const mn=t=>{s.currentSceneSentenceList.splice(t,1),a.set("writeScene",!a.get("writeScene"))},oe=(t,c)=>{if(!(t===0&&c===-1||t===s.currentSceneSentenceList.length-1&&c===1)){{const l=s.currentSceneSentenceList[t];s.currentSceneSentenceList.splice(t,1),s.currentSceneSentenceList.splice(t+c,0,l)}a.set("writeScene",!a.get("writeScene"))}},de=t=>n("div",{className:x.addSentencePanel,children:[n("div",{className:x.addSentenceButton,onClick:()=>{w("dialog",t.index)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("changeP",t.index)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("bg",t.index)},children:[e(U,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("changeScene",t.index)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("choose",t.index)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("bgm",t.index)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("video",t.index)},children:[e($,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]}),P=t=>n("div",{className:i.sentenceButtonList,children:[n("div",{className:i.sentenceButton,onClick:()=>{mn(t.index)},children:[e(xe,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),n("div",{onClick:()=>{oe(t.index,-1)},className:i.sentenceButton,children:[e(Ce,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),n("div",{onClick:()=>{oe(t.index,1)},className:i.sentenceButton,children:[e(Ee,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),n("div",{onClick:()=>{t.data.setShowAddPre(!t.data.showAddPre)},className:i.sentenceButton,children:[e(te,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",t.data.showAddPre&&e(de,{index:t.data.indexPre})]}),n("div",{onClick:()=>{t.data.setShowAddAfter(!t.data.showAddAfter)},className:i.sentenceButton,children:[e(te,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",t.data.showAddAfter&&e(de,{index:t.data.indexAfter})]})]}),hn=t=>{const[c,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:c,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{document.getElementById("speakerInput"+t.index).value=t.data.speaker,document.getElementById("contentInput"+t.index).value=t.data.content});const p=()=>{s.currentSceneSentenceList[t.index].speaker=document.getElementById("speakerInput"+t.index).value,s.currentSceneSentenceList[t.index].content=document.getElementById("contentInput"+t.index).value,a.set("writeScene",!a.get("writeScene"))},_=u=>{s.currentSceneSentenceList[t.index].ignoreSpeaker=u,a.set("writeScene",!a.get("writeScene"))},[v,S]=r.exports.useState(t.data.vocal),N=()=>u=>{s.currentSceneSentenceList[t.index].vocal=u,a.set("writeScene",!a.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u57FA\u672C\u5BF9\u8BDD"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:f})})]}),n("main",{className:i.mainEdit,children:[n("div",{className:i.singleOption,children:["\u89D2\u8272\uFF1A",e("input",{className:i.dialog_input,onBlur:p,id:"speakerInput"+t.index}),e("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),n("div",{className:i.singleOption,children:["\u5BF9\u8BDD\uFF1A",e("input",{className:i.dialog_input,onBlur:p,id:"contentInput"+t.index})]}),n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u65C1\u767D\u6A21\u5F0F"}),n("span",{className:i.optionContent,children:[e(L,{size:"small",id:"dialog_pbms",checked:t.data.ignoreSpeaker,onChange:_}),"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"]}),e("div",{className:i.optionTitle,children:"\u914D\u97F3\u6587\u4EF6"}),e(b,{setShow:S,id:"vocalPicker",dir:"vocal",set:N()}),e("span",{className:i.optionContent,children:v})]})]})]},t.index+"dialog")},gn=t=>{const[c,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:c,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const p=u=>{s.currentSceneSentenceList[t.index].noBg=u,a.set("writeScene",!a.get("writeScene"))},_=u=>{s.currentSceneSentenceList[t.index].next=u,a.set("writeScene",!a.get("writeScene"))},[v,S]=r.exports.useState(t.data.bg),N=()=>u=>{s.currentSceneSentenceList[t.index].bg=u,a.set("writeScene",!a.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u66F4\u6539\u80CC\u666F"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:f})})]}),n("main",{className:i.mainEdit,children:[n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u80CC\u666F"}),n("span",{className:i.optionContent,children:[e(L,{size:"small",checked:t.data.noBg,id:"bg_none"+t.index,onChange:p}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"]}),e("span",{className:i.optionTitle,children:"\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"bg_next"+t.index,checked:t.data.next,onChange:_})})]}),n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u80CC\u666F\u6587\u4EF6"}),e(b,{setShow:S,id:"bgPicker",dir:"background",set:N()}),e("span",{className:i.optionContent,children:v})]})]})]},t.index+"bg")},pn=t=>{const[c,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:c,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const p=N=>{s.currentSceneSentenceList[t.index].noBgm=N,a.set("writeScene",!a.get("writeScene"))},[_,v]=r.exports.useState(t.data.bgm),S=()=>N=>{s.currentSceneSentenceList[t.index].bgm=N,a.set("writeScene",!a.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u66F4\u6539\u97F3\u4E50"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:f})})]}),n("main",{className:i.mainEdit,children:[n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u80CC\u666F\u97F3\u4E50"}),n("span",{className:i.optionContent,children:[e(L,{size:"small",id:"bgm_none"+t.index,checked:t.data.noBgm,onChange:p}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"]})]}),n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u80CC\u666F\u97F3\u4E50\u6587\u4EF6"}),e(b,{setShow:v,id:"bgmPicker",dir:"bgm",set:S()}),e("span",{className:i.optionContent,children:_})]})]})]},t.index+"bgm")},fn=t=>{const[c,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:c,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const[p,_]=r.exports.useState(t.data.newScene),v=()=>S=>{s.currentSceneSentenceList[t.index].newScene=S,a.set("writeScene",!a.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5207\u6362\u573A\u666F"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:f})})]}),e("main",{className:i.mainEdit,children:n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u65B0\u573A\u666F"}),e(b,{setShow:_,id:"scenePicker",dir:"scene",set:v()}),e("span",{className:i.optionContent,children:p})]})})]},t.index+"scene")},Sn=t=>{const[c,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:c,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const[p,_]=r.exports.useState(t.data.video),v=()=>S=>{s.currentSceneSentenceList[t.index].video=S,a.set("writeScene",!a.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u64AD\u653E\u89C6\u9891"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:f})})]}),e("main",{className:i.mainEdit,children:n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u89C6\u9891\u6587\u4EF6"}),e(b,{setShow:_,id:"videoPicker",dir:"video",set:v()}),e("span",{className:i.optionContent,children:p})]})})]},t.index+"scene")},{Option:J}=ne,_n=t=>{const[c,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:c,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const p=m=>{s.currentSceneSentenceList[t.index].noP=m,a.set("writeScene",!a.get("writeScene"))},_=m=>{s.currentSceneSentenceList[t.index].next=m,a.set("writeScene",!a.get("writeScene"))},[v,S]=r.exports.useState(t.data.newP),N=()=>m=>{s.currentSceneSentenceList[t.index].newP=m,a.set("writeScene",!a.get("writeScene"))},u=m=>{s.currentSceneSentenceList[t.index].pos=m,a.set("writeScene",!a.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5207\u6362\u7ACB\u7ED8"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:f})})]}),n("main",{className:i.mainEdit,children:[n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u7ACB\u7ED8"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"p_none",checked:t.data.noP,onChange:p})}),e("span",{className:i.optionContent,children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"}),e("span",{className:i.optionTitle,children:"\u7ACB\u7ED8\u4F4D\u7F6E"}),n(ne,{size:"small",defaultValue:t.data.pos,style:{width:120},onChange:u,children:[e(J,{value:"left",children:"\u5DE6"}),e(J,{value:"",children:"\u4E2D"}),e(J,{value:"right",children:"\u53F3"})]}),e("span",{className:i.optionContent,children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"}),e("span",{className:i.optionTitle,children:"\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"p_none",checked:t.data.next,onChange:_})})]}),n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u7ACB\u7ED8\u6587\u4EF6"}),e(b,{setShow:S,id:"pPicker",dir:"figure",set:N()}),e("span",{className:i.optionContent,children:v})]})]})]},t.index+"dialog")},Nn=t=>{const[c,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:c,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{for(let u=0;u<t.data.chooseItem.length;u++)document.getElementById("chooseInput"+t.index+"itemIndex"+u).value=t.data.chooseItem[u].text});const p=()=>{s.currentSceneSentenceList[t.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),a.set("writeScene",!a.get("writeScene"))},_=u=>{const m=parseInt(u.split("Index")[1]);console.log(m),s.currentSceneSentenceList[t.index].chooseItem[m].text=document.getElementById(u).value,a.set("writeScene",!a.get("writeScene"))},v=u=>m=>{s.currentSceneSentenceList[t.index].chooseItem[u].scene=m,a.set("writeScene",!a.get("writeScene"))};let S=[],N=0;for(const u of t.data.chooseItem){const m="chooseInput"+t.index+"itemIndex"+N;let E=n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5206\u652F\u540D\u79F0"}),e("input",{className:i.dialog_input,style:{width:"200px"},onBlur:()=>{_(m)},id:m}),e("span",{className:i.optionContent,children:e(Be,{theme:"outline",size:"24",fill:"#333"})}),e("span",{className:i.optionTitle,children:"\u8DF3\u8F6C\u7684\u573A\u666F"}),e(b,{id:"scenePicker",dir:"scene",set:v(N)}),e("span",{className:i.optionContent,children:u.scene})]},N);S.push(E),N++}return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5206\u652F\u9009\u62E9"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:f})})]}),n("main",{className:i.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:n("div",{onClick:p,className:i.sentenceButton,children:[e(Fe,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),S]})]},t.index+"choose")},vn=(t,c)=>{let l;switch(t.type){case"dialog":l=e(hn,{data:t,index:c},c);break;case"bg":l=e(gn,{data:t,index:c},c);break;case"bgm":l=e(pn,{data:t,index:c},c);break;case"changeScene":l=e(fn,{data:t,index:c},c);break;case"video":l=e(Sn,{data:t,index:c},c);break;case"changeP":l=e(_n,{data:t,index:c},c);break;case"choose":l=e(Nn,{data:t,index:c},c);break}return l};const xn=t=>{const[c,l]=r.exports.useState(!0),[g,d]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("updateScene",c),a.connect("updateScene",()=>{l(a.get("updateScene"))},"updateSceneFunc"),a.set("refScene",!0),a.connect("refScene",()=>{W()},"refSceneFunc"),a.get("writeScene")===void 0&&a.set("writeScene",!0),a.connect("writeScene",()=>{K()},"writeSceneFunc"),W()},[]);let o=[];const h=JSON.parse(JSON.stringify(s.currentSceneSentenceList));for(let p=0;p<h.length;p++){const _=h[p],v=vn(_,p),S=n("div",{className:x.sentence,children:[e("div",{className:x.lineNumber,children:p+1}),e("div",{className:x.sentenceMain,children:v})]});o.push(S)}const f=n("div",{className:x.addSentencePanel,children:[n("div",{className:x.addSentenceButton,onClick:()=>{w("dialog"),d(!1)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("changeP"),d(!1)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("bg"),d(!1)},children:[e(U,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("changeScene"),d(!1)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("choose"),d(!1)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("bgm"),d(!1)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),n("div",{className:x.addSentenceButton,onClick:()=>{w("video"),d(!1)},children:[e($,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]});return n("div",{children:[n("div",{className:x.topButtonList,children:[e("div",{className:x.topButton,onClick:K,children:"\u4FDD\u5B58\u573A\u666F"}),e("div",{className:x.topButton,onClick:()=>{d(!g)},children:"\u6DFB\u52A0\u8BED\u53E5"}),e("div",{children:g&&f})]}),e("div",{className:x.sentenceList,children:o})]})};function W(){let t=s.currentEditScene;if(t==="")return;const c=`${s.domain}/Games/${s.currentEditGame}/game/scene/${t}`;A.get(c).then(l=>{s.currentSceneSentenceList=l.data,a.set("updateScene",!a.get("updateScene"))}).catch(l=>console.log(l))}function w(t,c){const l=Yt(t);c!==void 0?s.currentSceneSentenceList.splice(c,0,l):s.currentSceneSentenceList.push(l),K()}function K(){const t=`${s.domain}/api/editGame/editScene/`,c={gameName:s.currentEditGame,sceneName:s.currentEditScene,sceneData:s.currentSceneSentenceList};A.post(t,c).then(l=>{W()}).catch(l=>console.log(l))}const Cn=()=>{const[t,c]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("updateEditor",t),a.connect("updateEditor",()=>{c(a.get("updateEditor")),a.set("refScene",!a.get("refScene"))},"updateEditorFunc")},[]);const l=o=>{s.currentEditScene=o,a.set("updateEditor",!a.get("updateEditor")),a.set("refScene",!a.get("refScene"))},g=o=>{const h=s.currentOpendSceneEdit.indexOf(o);s.currentOpendSceneEdit.splice(h,1);const f=s.currentOpendSceneEdit.length===0;o===s.currentEditScene&&(f?s.currentEditScene="":s.currentOpendSceneEdit.length<=h?s.currentEditScene=s.currentOpendSceneEdit[s.currentOpendSceneEdit.length-1]:s.currentEditScene=s.currentOpendSceneEdit[h]),a.set("updateEditor",!a.get("updateEditor"))},d=[];for(const o of s.currentOpendSceneEdit){let h;o===s.currentEditScene?h=n("div",{className:D.tagOpened,children:[e(R,{theme:"outline",size:"20",fill:"#333",className:D.tagIcon}),o,e(se,{theme:"outline",size:"20",fill:"#333",className:D.closeIcon,onClick:()=>{g(o)}})]},o):h=n("div",{className:D.tag,onClick:()=>{l(o)},children:[e(R,{theme:"outline",size:"20",fill:"#333",className:D.tagIcon}),o,e(se,{theme:"outline",size:"20",fill:"#333",className:D.tagIcon,onClick:f=>{f.preventDefault(),f.stopPropagation(),g(o)}})]},o),d.push(h)}return n("div",{className:D.main,children:[e("div",{className:D.tagList,children:d}),e("div",{children:s.currentEditScene!==""&&e(xn,{sceneName:s.currentEditScene})})]})},En=()=>{const[t,c]=r.exports.useState(!0);return r.exports.useEffect(()=>{a.set("updateEditor",!0),a.connect("updateEditor",()=>{c(a.get("updateEditor"))},"ForceUpdateEditor")},[]),n("div",{children:[e(qe,{}),n("main",{className:zt.main,children:[e(Lt,{}),e(Cn,{})]})]})};function Bn(){const[t,c]=r.exports.useState(!0);return r.exports.useEffect(()=>{a.set("isManageMent",!0),a.connect("isManagement",()=>{c(a.get("isManagement"))},"setIsManagementFunc")},[]),n("div",{className:"App",children:[t&&e(je,{}),!t&&e(En,{})]})}we.render(e(Ae.StrictMode,{children:e(Bn,{})}),document.getElementById("root"));
