import{f as me,r,a as A,j as s,b as e,G as he,A as X,L as ge,F as Y,N as Se,E as pe,P as fe,D as _e,V as Ne,c as $,d as M,e as j,g as q,h as xe,R as ve,U as Ee,i as Ce,k as U,C as Z,l as ee,S as te,m as ne,n as Be,o as we,p as Fe,q as se,s as L,t as ie,u as Ae,v as ce,w as ae,x as ke,y as Ie}from"./vendor.481b6769.js";const De=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))h(d);new MutationObserver(d=>{for(const l of d)if(l.type==="childList")for(const g of l.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&h(g)}).observe(document,{childList:!0,subtree:!0});function o(d){const l={};return d.integrity&&(l.integrity=d.integrity),d.referrerpolicy&&(l.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?l.credentials="include":d.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function h(d){if(d.ep)return;d.ep=!0;const l=o(d);fetch(d.href,l)}};De();const be="_nav_11k4b_2",ye="_title_11k4b_12",Pe="_subTitle_11k4b_20",Le="_main_11k4b_29",Te="_gameList_11k4b_33",ze="_singleGameEntryButton_11k4b_39",Oe="_buttonIcon_11k4b_54",Ge="_addIcon_11k4b_58",$e="_createPanel_11k4b_65",Me="_createPanelTitle_11k4b_75",je="_createPanelInput_11k4b_81",qe="_createButton_11k4b_87";var k={nav:be,title:ye,subTitle:Pe,main:Le,gameList:Te,singleGameEntryButton:ze,buttonIcon:Oe,addIcon:Ge,createPanel:$e,createPanelTitle:Me,createPanelInput:je,createButton:qe};const a=new me;a.set("updateEditor",!0);const oe={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[],sceneScrollTop:{}},n=JSON.parse(JSON.stringify(oe)),Ue=()=>{const[t,c]=r.exports.useState(!0),[o,h]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refManagement",t),a.connect("refManagement",()=>{c(a.get("refManagement"))},"refManagementFunc"),d()},[]);const d=()=>{A.get(n.domain+"/api/manageGame/gameList").then(p=>{n.gameList=p.data,a.set("refManagement",!a.get("refManagement"))}).catch(p=>{console.log(p)})};let l=[];for(const p of n.gameList){const S=s("div",{className:k.singleGameEntryButton,onClick:()=>{for(const N in n)n[N]=oe[N];n.currentEditGame=p,a.set("isManagement",!1)},children:[e(he,{theme:"outline",size:"24",fill:"#333",className:k.buttonIcon}),p]},p);l.push(S)}const g=p=>{const S=`${n.domain}/api/manageGame/createGame/${p}`;A.get(S).then(N=>{h(!1),d()})};return s("div",{children:[e("header",{children:e("nav",{children:e("div",{className:k.nav,children:e("div",{className:k.title,children:"WebGAL ORIGINE"})})})}),s("main",{className:k.main,children:[s("div",{className:k.subTitle,children:["\u6E38\u620F\u5217\u8868",s("span",{onClick:()=>h(!o),className:k.addIcon,children:[e(X,{theme:"outline",size:"18",fill:"#8E354A"})," \u65B0\u5EFA\u6E38\u620F"]}),o&&s("div",{className:k.createPanel,children:[e("div",{className:k.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),s("div",{children:["\u6E38\u620F\u540D\u79F0\uFF1A",e("input",{id:"createInput",className:k.createPanelInput})]}),e("div",{style:{textAlign:"center"},children:e("div",{onClick:()=>g(document.getElementById("createInput").value),className:k.createButton,children:"\u521B\u5EFA"})})]})]}),e("div",{className:k.gameList,children:l})]})]})},Re="_nav_fct5m_1",Ve="_title_fct5m_13",Je="_titleIcon_fct5m_21";var R={nav:Re,title:Ve,titleIcon:Je};const We=()=>s("div",{className:R.nav,children:[e(ge,{theme:"filled",size:"30",fill:"#333",className:R.titleIcon,onClick:()=>{a.set("isManagement",!0)}}),e("div",{className:R.title,children:"WebGAL ORIGINE"})]}),Ke="_aside_1lxuu_1",He="_option_1lxuu_10",Qe="_optionMarker_1lxuu_20",Xe="_optionMarkerOff_1lxuu_28",Ye="_chooseItem_1lxuu_36",Ze="_chooseTitle_1lxuu_47",et="_chooseDescription_1lxuu_52",tt="_tagButton_1lxuu_57",nt="_tagButtonOn_1lxuu_72",st="_sideBarContent_1lxuu_78";var D={aside:Ke,option:He,optionMarker:Qe,optionMarkerOff:Xe,chooseItem:Ye,chooseTitle:Ze,chooseDescription:et,tagButton:tt,tagButtonOn:nt,sideBarContent:st};const it="_title_jfelw_1",ct="_previewGameButton_jfelw_10",at="_gameNameInput_jfelw_20";var T={title:it,previewGameButton:ct,gameNameInput:at};const ot="_choosed_imeie_1",dt="_chooseBox_imeie_7",lt="_chooseIcon_imeie_11",rt="_fileList_imeie_26",ut="_singleFile_imeie_38",mt="_fileIcon_imeie_49";var P={choosed:ot,chooseBox:dt,chooseIcon:lt,fileList:rt,singleFile:ut,fileIcon:mt};const I=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(t.dir),[l,g]=r.exports.useState([]),[p,S]=r.exports.useState(""),N=u=>{const C={dir:`/${n.currentEditGame}/game/${u}`};A.post(`${n.domain}/api/editGame/getAssets/`,C).then(E=>{g(E.data)}).catch(E=>{console.log(E)})},x=u=>{let m=u.split("/");u="";let C=0;for(const E of m)E!==t.dir&&(C!==0&&(u=u+"/"),C++,u=u+E);return u},f=u=>{let m=h+"/"+u;m=x(m),t.set(m),t.hasOwnProperty("setShow")&&t.setShow(m)};r.exports.useEffect(()=>{N(h)},[]);let _=[];for(const u of l){let m=!0,C=!0;u.match(/\.json/)&&(C=!1),u.match(/\./)&&(m=!1);let E=e("div",{children:""});m?E=s("div",{className:P.singleFile,onClick:()=>{const F=h+"/"+u;d(F),N(F)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",className:P.fileIcon}),u]},u):E=s("div",{className:P.singleFile,onClick:()=>{S(x(h+"/"+u)),f(u),o(!c)},children:[e(Se,{theme:"outline",size:"18",fill:"#333",className:P.fileIcon}),u]},u),C&&_.push(E)}return s("div",{children:[e("div",{className:P.chooseBox,children:s("div",{className:P.chooseIcon,onClick:()=>{c===!1&&(d(t.dir),S(""),N(t.dir)),o(!c)},children:[e(pe,{theme:"outline",size:"16",fill:"#333"})," \u9009\u62E9\u6587\u4EF6"]})}),e("div",{style:{position:"relative"},children:c&&e("div",{className:P.fileList,children:_})})]})},ht=()=>{r.exports.useState(!1);const[t,c]=r.exports.useState(""),[o,h]=r.exports.useState(""),[d,l]=r.exports.useState(""),g=()=>{A.get(`${n.domain}/Games/${n.currentEditGame}/game/gameConfig.json`).then(f=>{let _=f.data;n.currentGameConfig=f.data,document.getElementById("gameNameInput").value=_.Game_name,c(_.Title_bgm),h(_.Title_img),l(_.Loading_img)})},p=()=>{n.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,x()},S=(f,_)=>{n.currentGameConfig[f]=_,x()},N=f=>_=>{S(f,_)},x=()=>{let f={currentEditGame:n.currentEditGame,config:n.currentGameConfig};A.post(`${n.domain}/api/manageGame/config`,f).then(_=>{})};return r.exports.useEffect(()=>{g()},[]),s("div",{style:{width:"100%"},children:[e("div",{children:e("a",{style:{color:"black",textDecoration:"none"},href:`${n.domain}/Games/${n.currentEditGame}`,target:"_blank",children:s("div",{className:T.previewGameButton,children:[e(fe,{theme:"outline",size:"28",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,5px)"}}),"\u9884\u89C8\u6E38\u620F"]})})}),s("div",{children:[e("div",{className:T.title,children:"\u6E38\u620F\u540D\u79F0"}),e("div",{children:e("input",{onBlur:p,id:"gameNameInput",className:T.gameNameInput})})]}),s("div",{children:[e("div",{className:T.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),s("div",{children:[t,e(I,{setShow:c,id:"bgmPicker",dir:"bgm",set:N("Title_bgm")})]})]}),s("div",{children:[e("div",{className:T.title,children:"\u6807\u9898\u80CC\u666F"}),s("div",{children:[o,e(I,{setShow:h,id:"bgPicker",dir:"background",set:N("Title_img")})]})]})]})},gt="_dirButtonContainer_iqtdj_2",St="_icon_small_iqtdj_8",pt="_controlPanel_iqtdj_15",ft="_upload_iqtdj_19",_t="_dirButton_iqtdj_2",Nt="_fileElement_iqtdj_41",xt="_title_iqtdj_58",vt="_currentDirShow_iqtdj_68",Et="_panelButton_iqtdj_78",Ct="_uploadTitle_iqtdj_90",Bt="_uploadButton_iqtdj_98";var B={dirButtonContainer:gt,icon_small:St,controlPanel:pt,upload:ft,dirButton:_t,fileElement:Nt,title:xt,currentDirShow:vt,panelButton:Et,uploadTitle:Ct,uploadButton:Bt};const de={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},le=t=>{let c=e(Y,{theme:"outline",size:"22",fill:"#333"});switch(t.icon){case"background":c=e(q,{theme:"outline",size:"22",fill:"#333"});break;case"bgm":c=e(j,{theme:"outline",size:"22",fill:"#333"});break;case"figure":c=e(M,{theme:"outline",size:"22",fill:"#333"});break;case"video":c=e($,{theme:"outline",size:"22",fill:"#333"});break;case"vocal":c=e(Ne,{theme:"outline",size:"22",fill:"#333"});break;case"file":c=e(_e,{theme:"outline",size:"22",fill:"#333"})}return c},wt=()=>{const[t,c]=r.exports.useState(!0),[o,h]=r.exports.useState(!1),[d,l]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refAssetsManagement",t),a.connect("refAssetsManagement",()=>{c(a.get("refAssetsManagement"))},"refAssetsManagement"),g()},[]);const g=()=>{const m=n.currentEditGame,C=n.currentDir,E={dir:`/${m}/game/${C}`};A.post(`${n.domain}/api/editGame/getAssets/`,E).then(F=>{n.currentDirContent=F.data,a.set("refAssetsManagement",!a.get("refAssetsManagement"))}).catch(F=>{console.log(F)})},p=()=>{if(n.currentDir==="")return;let m=n.currentDir.split("/");m.pop(),n.currentDir=m.reduce((C,E)=>""+C+"/"+E),g()},S=m=>{n.currentDir=n.currentDir+`/${m}`,g()},N=()=>{const m=n.currentEditGame,C=n.currentDir,E=`/${m}/game/${C}`;let F=new FormData;F.append("dir",E);const G=document.getElementById("uploadFile").files[0];let z=document.getElementById("uploadFile").value;F.append("file",G,z),A.post(`${n.domain}/api/editGame/addAsset/`,F,{headers:{"Content-Type":"multipart/form-data"}}).then(Q=>{h(!1),g()}).catch(Q=>{console.log(Q)})},x=()=>{const m=n.currentEditGame,C=n.currentDir,E=`/${m}/game/${C}`,F=document.getElementById("addDirInput").value,G={current:E,Name:F};A.post(`${n.domain}/api/editGame/mkdir/`,G).then(z=>{l(!1),g()}).catch(z=>{console.log(z)})},f=()=>{h(!o)},_=()=>{l(!d)},u=[];for(const m of n.currentDirContent){let C="",E=!0;if(m.match(/\./))n.currentDir===""&&(E=!1),C=s("div",{className:B.fileElement,children:[e("span",{className:B.icon_small,children:e(le,{icon:"file"})}),m]},m);else{let F=m;n.currentDir===""&&de.hasOwnProperty(m)&&(F=de[m]),C=s("div",{className:B.dirButton,onClick:()=>S(m),children:[e("span",{className:B.icon_small,children:e(le,{icon:m})}),F]},m),m==="scene"&&n.currentDir===""&&(E=!1)}E&&u.push(C)}return s(xe,{children:[n.currentDir!==""&&e("div",{className:B.currentDirShow,children:n.currentDir}),n.currentDir!==""&&s("div",{className:B.controlPanel,children:[e("div",{children:e(ve,{theme:"outline",size:"24",fill:"#333",onClick:p,className:B.panelButton})}),s("div",{children:[e(Ee,{theme:"outline",size:"24",fill:"#333",onClick:f,className:B.panelButton}),o&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u4E0A\u4F20\u6587\u4EF6"}),e("input",{id:"uploadFile",type:"file"}),e("div",{className:B.uploadButton,onClick:N,children:"\u4E0A\u4F20"})]})]}),s("div",{children:[e(Ce,{theme:"outline",size:"24",fill:"#333",onClick:_,className:B.panelButton}),d&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"}),e("input",{id:"addDirInput"}),e("div",{className:B.uploadButton,onClick:x,children:"\u65B0\u5EFA"})]})]})]}),e("div",{}),e("div",{className:B.dirButtonContainer,children:u})]})},Ft="_main_1dzb8_1",At="_addInput_1dzb8_12",kt="_title_1dzb8_20",It="_addButton_1dzb8_26";var O={main:Ft,addInput:At,title:kt,addButton:It};const Dt=t=>{const c=()=>{const o={gameName:n.currentEditGame,sceneName:document.getElementById("addSceneName").value};A.post(`${n.domain}/api/editGame/addNewScene/`,o).then(h=>{t.added()}).catch(h=>{console.log(h)})};return s("div",{className:O.main,children:[s("div",{className:O.title,children:["\u573A\u666F\u540D\u79F0\uFF1A",e("input",{className:O.addInput,id:"addSceneName"})]}),e("div",{className:O.addButton,onClick:c,children:"\u65B0\u5EFA\u573A\u666F"})]})},bt="_titleText_1j8ez_1",yt="_scene_1j8ez_11",Pt="_newSceneButton_1j8ez_22",Lt="_sceneList_1j8ez_30";var V={titleText:bt,scene:yt,newSceneButton:Pt,sceneList:Lt};const J=()=>{n.currentEditScene!==""&&(n.sceneScrollTop[n.currentEditScene]=document.getElementById("currentSentenceList").scrollTop)},Tt=()=>{const[t,c]=r.exports.useState([]),[o,h]=r.exports.useState(!1),d=()=>{const x={dir:`/${n.currentEditGame}/game/scene`};A.post(`${n.domain}/api/editGame/getAssets/`,x).then(f=>{c(f.data)}).catch(f=>{console.log(f)})},l=()=>{d(),h(!o)};r.exports.useEffect(()=>{d()},[]);const g=S=>{n.currentOpendSceneEdit.includes(S)||n.currentOpendSceneEdit.push(S),J(),n.currentEditScene=S,a.set("updateEditor",!a.get("updateEditor"))},p=[];for(const S of t){let N=!1,x=S.split(".");x[x.length-1]==="json"&&(N=!0);const f=s("div",{className:V.scene,onClick:()=>g(S),children:[e(U,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),S]},S);N&&p.push(f)}return s("div",{style:{width:"100%"},children:[s("div",{className:V.newSceneButton,onClick:()=>{h(!o)},children:[e(X,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0",transform:"translate(0,2px)"}}),"\u65B0\u5EFA\u573A\u666F"]}),e("div",{children:o&&e(Dt,{added:l})}),e("div",{className:V.sceneList,children:p})]})},zt=()=>{const t=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[c,o]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refSideBar",c),a.connect("refSideBar",()=>{o(a.get("refSideBar"))},"refSideBarFunc")},[]);const h=[];for(const l of t){l===n.editorTag?D.optionMarker:D.optionMarkerOff;const g=e("div",{className:l===n.editorTag?D.tagButton+" "+D.tagButtonOn:D.tagButton,onClick:()=>{n.editorTag=l,a.set("refSideBar",!a.get("refSideBar"))},children:e("div",{children:l})},l);h.push(g)}let d;switch(n.editorTag){case"\u6E38\u620F\u914D\u7F6E":d=e(ht,{});break;case"\u7D20\u6750\u7BA1\u7406":d=e(wt,{});break;case"\u573A\u666F\u7BA1\u7406":d=e(Tt,{});break}return s("aside",{className:D.aside,children:[e("div",{className:D.option,children:h}),e("div",{className:D.sideBarContent,children:d})]})},Ot="_main_19sml_1";var Gt={main:Ot};const $t="_main_1vjf8_1",Mt="_tag_1vjf8_7",jt="_tagOpened_1vjf8_17",qt="_tagList_1vjf8_24",Ut="_tagIcon_1vjf8_28",Rt="_closeIcon_1vjf8_33";var b={main:$t,tag:Mt,tagOpened:jt,tagList:qt,tagIcon:Ut,closeIcon:Rt};const Vt="_topButtonList_k9m8n_1",Jt="_topButton_k9m8n_1",Wt="_addSentencePanel_k9m8n_23",Kt="_addSentenceButton_k9m8n_32",Ht="_sentenceList_k9m8n_42",Qt="_sentence_k9m8n_42",Xt="_sentenceIn_k9m8n_1",Yt="_lineNumber_k9m8n_55",Zt="_sentenceMain_k9m8n_65";var v={topButtonList:Vt,topButton:Jt,addSentencePanel:Wt,addSentenceButton:Kt,sentenceList:Ht,sentence:Qt,sentenceIn:Xt,lineNumber:Yt,sentenceMain:Zt};const en=t=>{let c;switch(t){case"dialog":c={type:t,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":c={type:t,bg:"",noBg:!1,next:!1};break;case"bgm":c={type:t,bgm:"",noBgm:!1};break;case"changeScene":c={type:t,newScene:""};break;case"video":c={type:t,video:""};break;case"changeP":c={type:t,newP:"",next:!1,noP:!1,pos:""};break;case"choose":c={type:t,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break;case"intro":c={type:t,content:[]};break}return c},tn="_sentence_tjlyp_1",nn="_dialog_input_tjlyp_7",sn="_singleOption_tjlyp_15",cn="_optionTitle_tjlyp_23",an="_optionContent_tjlyp_31",on="_isolate_tjlyp_35",dn="_sentenceButtonList_tjlyp_40",ln="_sentenceButton_tjlyp_40",rn="_sentenceIndexShow_tjlyp_60",un="_barContainer_tjlyp_74",mn="_mainEdit_tjlyp_84",hn="_topContainer_tjlyp_92";var i={sentence:tn,dialog_input:nn,singleOption:sn,optionTitle:cn,optionContent:an,isolate:on,sentenceButtonList:dn,sentenceButton:ln,sentenceIndexShow:rn,barContainer:un,mainEdit:mn,topContainer:hn};const gn=t=>{n.currentSceneSentenceList.splice(t,1),a.set("writeScene",!a.get("writeScene"))},re=(t,c)=>{if(!(t===0&&c===-1||t===n.currentSceneSentenceList.length-1&&c===1)){{const o=n.currentSceneSentenceList[t];n.currentSceneSentenceList.splice(t,1),n.currentSceneSentenceList.splice(t+c,0,o)}a.set("writeScene",!a.get("writeScene"))}},ue=t=>s("div",{className:v.addSentencePanel,children:[s("div",{className:v.addSentenceButton,onClick:()=>{w("dialog",t.index)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("changeP",t.index)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("bg",t.index)},children:[e(q,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("changeScene",t.index)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("choose",t.index)},children:[e(te,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("bgm",t.index)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("video",t.index)},children:[e($,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("intro",t.index)},children:[e(ne,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u9ED1\u5C4F\u6587\u5B57"]})]}),y=t=>s("div",{className:i.sentenceButtonList,children:[s("div",{className:i.sentenceButton,onClick:()=>{gn(t.index)},children:[e(Be,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),s("div",{onClick:()=>{re(t.index,-1)},className:i.sentenceButton,children:[e(we,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{re(t.index,1)},className:i.sentenceButton,children:[e(Fe,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{t.data.setShowAddPre(!t.data.showAddPre)},className:i.sentenceButton,children:[e(se,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",t.data.showAddPre&&e(ue,{index:t.data.indexPre})]}),s("div",{onClick:()=>{t.data.setShowAddAfter(!t.data.showAddAfter)},className:i.sentenceButton,children:[e(se,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",t.data.showAddAfter&&e(ue,{index:t.data.indexAfter})]})]}),Sn=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),l=t.index,g=t.index+1,p={showAddPre:c,setShowAddPre:o,showAddAfter:h,setShowAddAfter:d,indexPre:l,indexAfter:g};r.exports.useEffect(()=>{document.getElementById("speakerInput"+t.index).value=t.data.speaker,document.getElementById("contentInput"+t.index).value=t.data.content});const S=()=>{n.currentSceneSentenceList[t.index].speaker=document.getElementById("speakerInput"+t.index).value,n.currentSceneSentenceList[t.index].content=document.getElementById("contentInput"+t.index).value,a.set("writeScene",!a.get("writeScene"))},N=u=>{n.currentSceneSentenceList[t.index].ignoreSpeaker=u,a.set("writeScene",!a.get("writeScene"))},[x,f]=r.exports.useState(t.data.vocal),_=()=>u=>{n.currentSceneSentenceList[t.index].vocal=u,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u57FA\u672C\u5BF9\u8BDD"}),e("div",{className:i.barContainer,children:e(y,{index:t.index,data:p})})]}),s("main",{className:i.mainEdit,children:[s("div",{className:i.singleOption,children:["\u89D2\u8272\uFF1A",e("input",{className:i.dialog_input,onBlur:S,id:"speakerInput"+t.index}),e("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),s("div",{className:i.singleOption,children:["\u5BF9\u8BDD\uFF1A",e("input",{className:i.dialog_input,onBlur:S,id:"contentInput"+t.index})]}),s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u65C1\u767D\u6A21\u5F0F"}),s("span",{className:i.optionContent,children:[e(L,{size:"small",id:"dialog_pbms",checked:t.data.ignoreSpeaker,onChange:N}),"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"]}),e("div",{className:i.optionTitle,children:"\u914D\u97F3\u6587\u4EF6"}),e(I,{setShow:f,id:"vocalPicker",dir:"vocal",set:_()}),e("span",{className:i.optionContent,children:x})]})]})]},t.index+"dialog")},pn=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),l=t.index,g=t.index+1,p={showAddPre:c,setShowAddPre:o,showAddAfter:h,setShowAddAfter:d,indexPre:l,indexAfter:g};r.exports.useEffect(()=>{});const S=u=>{n.currentSceneSentenceList[t.index].noBg=u,a.set("writeScene",!a.get("writeScene"))},N=u=>{n.currentSceneSentenceList[t.index].next=u,a.set("writeScene",!a.get("writeScene"))},[x,f]=r.exports.useState(t.data.bg),_=()=>u=>{n.currentSceneSentenceList[t.index].bg=u,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u66F4\u6539\u80CC\u666F"}),e("div",{className:i.barContainer,children:e(y,{index:t.index,data:p})})]}),s("main",{className:i.mainEdit,children:[s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u80CC\u666F"}),s("span",{className:i.optionContent,children:[e(L,{size:"small",checked:t.data.noBg,id:"bg_none"+t.index,onChange:S}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"]}),e("span",{className:i.optionTitle,children:"\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"bg_next"+t.index,checked:t.data.next,onChange:N})})]}),s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u80CC\u666F\u6587\u4EF6"}),e(I,{setShow:f,id:"bgPicker",dir:"background",set:_()}),e("span",{className:i.optionContent,children:x})]})]})]},t.index+"bg")},fn=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),l=t.index,g=t.index+1,p={showAddPre:c,setShowAddPre:o,showAddAfter:h,setShowAddAfter:d,indexPre:l,indexAfter:g};r.exports.useEffect(()=>{});const S=_=>{n.currentSceneSentenceList[t.index].noBgm=_,a.set("writeScene",!a.get("writeScene"))},[N,x]=r.exports.useState(t.data.bgm),f=()=>_=>{n.currentSceneSentenceList[t.index].bgm=_,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u66F4\u6539\u97F3\u4E50"}),e("div",{className:i.barContainer,children:e(y,{index:t.index,data:p})})]}),s("main",{className:i.mainEdit,children:[s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u80CC\u666F\u97F3\u4E50"}),s("span",{className:i.optionContent,children:[e(L,{size:"small",id:"bgm_none"+t.index,checked:t.data.noBgm,onChange:S}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"]})]}),s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u80CC\u666F\u97F3\u4E50\u6587\u4EF6"}),e(I,{setShow:x,id:"bgmPicker",dir:"bgm",set:f()}),e("span",{className:i.optionContent,children:N})]})]})]},t.index+"bgm")},_n=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),l=t.index,g=t.index+1,p={showAddPre:c,setShowAddPre:o,showAddAfter:h,setShowAddAfter:d,indexPre:l,indexAfter:g};r.exports.useEffect(()=>{});const[S,N]=r.exports.useState(t.data.newScene),x=()=>f=>{n.currentSceneSentenceList[t.index].newScene=f,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5207\u6362\u573A\u666F"}),e("div",{className:i.barContainer,children:e(y,{index:t.index,data:p})})]}),e("main",{className:i.mainEdit,children:s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u65B0\u573A\u666F"}),e(I,{setShow:N,id:"scenePicker",dir:"scene",set:x()}),e("span",{className:i.optionContent,children:S})]})})]},t.index+"scene")},Nn=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),l=t.index,g=t.index+1,p={showAddPre:c,setShowAddPre:o,showAddAfter:h,setShowAddAfter:d,indexPre:l,indexAfter:g};r.exports.useEffect(()=>{});const[S,N]=r.exports.useState(t.data.video),x=()=>f=>{n.currentSceneSentenceList[t.index].video=f,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u64AD\u653E\u89C6\u9891"}),e("div",{className:i.barContainer,children:e(y,{index:t.index,data:p})})]}),e("main",{className:i.mainEdit,children:s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u89C6\u9891\u6587\u4EF6"}),e(I,{setShow:N,id:"videoPicker",dir:"video",set:x()}),e("span",{className:i.optionContent,children:S})]})})]},t.index+"scene")},{Option:W}=ie,xn=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),l=t.index,g=t.index+1,p={showAddPre:c,setShowAddPre:o,showAddAfter:h,setShowAddAfter:d,indexPre:l,indexAfter:g};r.exports.useEffect(()=>{});const S=m=>{n.currentSceneSentenceList[t.index].noP=m,a.set("writeScene",!a.get("writeScene"))},N=m=>{n.currentSceneSentenceList[t.index].next=m,a.set("writeScene",!a.get("writeScene"))},[x,f]=r.exports.useState(t.data.newP),_=()=>m=>{n.currentSceneSentenceList[t.index].newP=m,a.set("writeScene",!a.get("writeScene"))},u=m=>{n.currentSceneSentenceList[t.index].pos=m,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5207\u6362\u7ACB\u7ED8"}),e("div",{className:i.barContainer,children:e(y,{index:t.index,data:p})})]}),s("main",{className:i.mainEdit,children:[s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u7ACB\u7ED8"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"p_none",checked:t.data.noP,onChange:S})}),e("span",{className:i.optionContent,children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"}),e("span",{className:i.optionTitle,children:"\u7ACB\u7ED8\u4F4D\u7F6E"}),s(ie,{size:"small",defaultValue:t.data.pos,style:{width:120},onChange:u,children:[e(W,{value:"left",children:"\u5DE6"}),e(W,{value:"",children:"\u4E2D"}),e(W,{value:"right",children:"\u53F3"})]}),e("span",{className:i.optionContent,children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"}),e("span",{className:i.optionTitle,children:"\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"p_none",checked:t.data.next,onChange:N})})]}),s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u7ACB\u7ED8\u6587\u4EF6"}),e(I,{setShow:f,id:"pPicker",dir:"figure",set:_()}),e("span",{className:i.optionContent,children:x})]})]})]},t.index+"dialog")},vn=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),l=t.index,g=t.index+1,p={showAddPre:c,setShowAddPre:o,showAddAfter:h,setShowAddAfter:d,indexPre:l,indexAfter:g};r.exports.useEffect(()=>{for(let u=0;u<t.data.chooseItem.length;u++)document.getElementById("chooseInput"+t.index+"itemIndex"+u).value=t.data.chooseItem[u].text});const S=()=>{n.currentSceneSentenceList[t.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),a.set("writeScene",!a.get("writeScene"))},N=u=>{const m=parseInt(u.split("Index")[1]);console.log(m),n.currentSceneSentenceList[t.index].chooseItem[m].text=document.getElementById(u).value,a.set("writeScene",!a.get("writeScene"))},x=u=>m=>{n.currentSceneSentenceList[t.index].chooseItem[u].scene=m,a.set("writeScene",!a.get("writeScene"))};let f=[],_=0;for(const u of t.data.chooseItem){const m="chooseInput"+t.index+"itemIndex"+_;let C=s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5206\u652F\u540D\u79F0"}),e("input",{className:i.dialog_input,style:{width:"200px"},onBlur:()=>{N(m)},id:m}),e("span",{className:i.optionContent,children:e(Ae,{theme:"outline",size:"24",fill:"#333"})}),e("span",{className:i.optionTitle,children:"\u8DF3\u8F6C\u7684\u573A\u666F"}),e(I,{id:"scenePicker",dir:"scene",set:x(_)}),e("span",{className:i.optionContent,children:u.scene})]},_);f.push(C),_++}return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5206\u652F\u9009\u62E9"}),e("div",{className:i.barContainer,children:e(y,{index:t.index,data:p})})]}),s("main",{className:i.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:S,className:i.sentenceButton,children:[e(ce,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),f]})]},t.index+"choose")},En=t=>{const[c,o]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),l=t.index,g=t.index+1,p={showAddPre:c,setShowAddPre:o,showAddAfter:h,setShowAddAfter:d,indexPre:l,indexAfter:g};r.exports.useEffect(()=>{for(let _=0;_<t.data.content.length;_++)document.getElementById("introInput"+t.index+"itemIndex"+_).value=t.data.content[_]});const S=()=>{n.currentSceneSentenceList[t.index].content.push("\u5728\u6B64\u586B\u5165\u8981\u5C55\u793A\u7684\u6587\u5B57"),a.set("writeScene",!a.get("writeScene"))},N=_=>{const u=parseInt(_.split("Index")[1]);console.log(u),n.currentSceneSentenceList[t.index].content[u]=document.getElementById(_).value,a.set("writeScene",!a.get("writeScene"))};let x=[],f=0;for(const _ of t.data.content){const u="introInput"+t.index+"itemIndex"+f;let m=s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u663E\u793A\u6587\u5B57"}),e("input",{className:i.dialog_input,style:{width:"200px"},onBlur:()=>{N(u)},id:u})]},f);x.push(m),f++}return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u9ED1\u5C4F\u6587\u5B57"}),e("div",{className:i.barContainer,children:e(y,{index:t.index,data:p})})]}),s("main",{className:i.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:S,className:i.sentenceButton,children:[e(ce,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u6587\u5B57"]})}),x]})]},t.index+"intro")},Cn=(t,c)=>{let o;switch(t.type){case"dialog":o=e(Sn,{data:t,index:c},c);break;case"bg":o=e(pn,{data:t,index:c},c);break;case"bgm":o=e(fn,{data:t,index:c},c);break;case"changeScene":o=e(_n,{data:t,index:c},c);break;case"video":o=e(Nn,{data:t,index:c},c);break;case"changeP":o=e(xn,{data:t,index:c},c);break;case"choose":o=e(vn,{data:t,index:c},c);break;case"intro":o=e(En,{data:t,index:c},c);break}return o};const Bn=t=>{const[c,o]=r.exports.useState(!0),[h,d]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("updateScene",c),a.connect("updateScene",()=>{o(a.get("updateScene"))},"updateSceneFunc"),a.set("refScene",!0),a.connect("refScene",()=>{K()},"refSceneFunc"),a.get("writeScene")===void 0&&a.set("writeScene",!0),a.connect("writeScene",()=>{H()},"writeSceneFunc"),K(),n.sceneScrollTop.hasOwnProperty(n.currentEditScene)&&setTimeout(()=>{document.getElementById("currentSentenceList").scrollTop=n.sceneScrollTop[n.currentEditScene]},0)},[]);let l=[];const g=JSON.parse(JSON.stringify(n.currentSceneSentenceList));for(let S=0;S<g.length;S++){const N=g[S],x=Cn(N,S),f=s("div",{className:v.sentence,children:[e("div",{className:v.lineNumber,children:S+1}),e("div",{className:v.sentenceMain,children:x})]},"sentence"+S);l.push(f)}const p=s("div",{className:v.addSentencePanel,children:[s("div",{className:v.addSentenceButton,onClick:()=>{w("dialog"),d(!1)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("changeP"),d(!1)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("bg"),d(!1)},children:[e(q,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("changeScene"),d(!1)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("choose"),d(!1)},children:[e(te,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("bgm"),d(!1)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("video"),d(!1)},children:[e($,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]}),s("div",{className:v.addSentenceButton,onClick:()=>{w("intro"),d(!1)},children:[e(ne,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u9ED1\u5C4F\u6587\u5B57"]})]});return s("div",{children:[s("div",{className:v.topButtonList,children:[e("div",{className:v.topButton,onClick:H,children:"\u4FDD\u5B58\u573A\u666F"}),e("div",{className:v.topButton,onClick:()=>{d(!h)},children:"\u6DFB\u52A0\u8BED\u53E5"}),e("div",{children:h&&p})]}),e("div",{className:v.sentenceList,id:"currentSentenceList",children:l})]})};function K(){let t=n.currentEditScene;if(t==="")return;const c=`${n.domain}/Games/${n.currentEditGame}/game/scene/${t}`;A.get(c).then(o=>{n.currentSceneSentenceList=o.data,a.set("updateScene",!a.get("updateScene"))}).catch(o=>console.log(o))}function w(t,c){const o=en(t);c!==void 0?n.currentSceneSentenceList.splice(c,0,o):n.currentSceneSentenceList.push(o),H()}function H(){const t=`${n.domain}/api/editGame/editScene/`,c={gameName:n.currentEditGame,sceneName:n.currentEditScene,sceneData:n.currentSceneSentenceList};A.post(t,c).then(o=>{K()}).catch(o=>console.log(o))}const wn=()=>{const[t,c]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("updateEditor",t),a.connect("updateEditor",()=>{c(a.get("updateEditor")),a.set("refScene",!a.get("refScene"))},"updateEditorFunc")},[]);const o=l=>{J(),n.currentEditScene=l,a.set("updateEditor",!a.get("updateEditor")),a.set("refScene",!a.get("refScene"))},h=l=>{J();const g=n.currentOpendSceneEdit.indexOf(l);n.currentOpendSceneEdit.splice(g,1);const p=n.currentOpendSceneEdit.length===0;l===n.currentEditScene&&(p?n.currentEditScene="":n.currentOpendSceneEdit.length<=g?n.currentEditScene=n.currentOpendSceneEdit[n.currentOpendSceneEdit.length-1]:n.currentEditScene=n.currentOpendSceneEdit[g]),a.set("updateEditor",!a.get("updateEditor"))},d=[];for(const l of n.currentOpendSceneEdit){let g;l===n.currentEditScene?g=s("div",{className:b.tagOpened,children:[e(U,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),l,e(ae,{theme:"outline",size:"20",fill:"#333",className:b.closeIcon,onClick:()=>{h(l)}})]},l):g=s("div",{className:b.tag,onClick:()=>{o(l)},children:[e(U,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),l,e(ae,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon,onClick:p=>{p.preventDefault(),p.stopPropagation(),h(l)}})]},l),d.push(g)}return s("div",{className:b.main,children:[e("div",{className:b.tagList,children:d}),e("div",{children:n.currentEditScene!==""&&e(Bn,{sceneName:n.currentEditScene},n.currentEditScene)})]})},Fn=()=>{const[t,c]=r.exports.useState(!0);return r.exports.useEffect(()=>{a.set("updateEditor",!0),a.connect("updateEditor",()=>{c(a.get("updateEditor"))},"ForceUpdateEditor")},[]),s("div",{children:[e(We,{}),s("main",{className:Gt.main,children:[e(zt,{}),e(wn,{})]})]})};function An(){const[t,c]=r.exports.useState(!0);return r.exports.useEffect(()=>{a.set("isManageMent",!0),a.connect("isManagement",()=>{c(a.get("isManagement"))},"setIsManagementFunc")},[]),s("div",{className:"App",children:[t&&e(Ue,{}),!t&&e(Fn,{})]})}ke.render(e(Ie.StrictMode,{children:e(An,{})}),document.getElementById("root"));
