import{f as he,r,a as A,j as s,b as e,G as ge,P as X,L as pe,m as fe,F as Y,N as Se,E as _e,c as Ne,D as ve,V as xe,d as q,A as R,e as W,g as U,R as Ce,U as Ee,h as Be,i as $,k as we,l as Fe,S as z,n as Ie,o as Ae,C as Z,p as ee,q as te,s as ne,t as ye,u as De,v as ke,w as se,x as ie,y as Pe,z as ae,B as ce,H as be,I as Le}from"./vendor.f05bf2fd.js";const Te=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))h(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&h(f)}).observe(document,{childList:!0,subtree:!0});function d(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function h(o){if(o.ep)return;o.ep=!0;const u=d(o);fetch(o.href,u)}};Te();const ze="_nav_v57rx_1",Ge="_title_v57rx_11",Oe="_subTitle_v57rx_18",$e="_main_v57rx_26",Me="_gameList_v57rx_30",je="_singleGameEntryButton_v57rx_36",qe="_buttonIcon_v57rx_51",Re="_addTitle_v57rx_55",We="_addIcon_v57rx_61",Ue="_createPanel_v57rx_77",Ve="_createPanelTitle_v57rx_89",Je="_createPanelInput_v57rx_95",He="_createButton_v57rx_102";var y={nav:ze,title:Ge,subTitle:Oe,main:$e,gameList:Me,singleGameEntryButton:je,buttonIcon:qe,addTitle:Re,addIcon:We,createPanel:Ue,createPanelTitle:Ve,createPanelInput:Je,createButton:He};const c=new he;c.set("updateEditor",!0);const oe={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[],sceneScrollTop:{},isRealtimeRefreashPreview:!0,wsConn:null},n=JSON.parse(JSON.stringify(oe)),Ke=()=>{const[t,i]=r.exports.useState(!0),[d,h]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refManagement",t),c.connect("refManagement",()=>{i(c.get("refManagement"))},"refManagementFunc"),o()},[]);const o=()=>{A.get(n.domain+"/api/manageGame/gameList").then(m=>{n.gameList=m.data,c.set("refManagement",!c.get("refManagement"))}).catch(m=>{console.log(m)})};let u=[];for(const m of n.gameList){const g=s("div",{className:y.singleGameEntryButton,onClick:()=>{for(const _ in n)n[_]=oe[_];n.currentEditGame=m,c.set("isManagement",!1)},children:[e(ge,{theme:"outline",size:"18",fill:"#333",className:y.buttonIcon}),m]},m);u.push(g)}const f=m=>{const g=`${n.domain}/api/manageGame/createGame/${m}`;A.get(g).then(_=>{h(!1),o()})};return s("div",{children:[e("header",{children:e("nav",{children:e("div",{className:y.nav,children:e("div",{children:e("span",{className:y.title,children:"WebGAL ORIGINE"})})})})}),s("main",{className:y.main,children:[s("div",{className:y.subTitle,children:[e("span",{className:y.addTitle,children:"\u6E38\u620F\u5217\u8868"}),s("div",{children:[s("span",{onClick:()=>h(!d),className:y.addIcon,children:[e(X,{theme:"outline",size:"16",fill:"#434343",style:{padding:"0 5px 0 0 "}}),"\u65B0\u5EFA\u6E38\u620F"]}),d&&s("div",{className:y.createPanel,children:[e("div",{className:y.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),s("div",{children:["\u6E38\u620F\u540D\u79F0",e("input",{id:"createInput",className:y.createPanelInput})]}),e("div",{style:{textAlign:"center"},children:e("div",{onClick:()=>f(document.getElementById("createInput").value),className:y.createButton,children:"\u521B\u5EFA"})})]})]})]}),e("div",{className:y.gameList,children:u})]})]})},Qe="_nav_15oeu_1",Xe="_title_15oeu_14",Ye="_titleIcon_15oeu_21",Ze="_ejectButon_15oeu_31";var G={nav:Qe,title:Xe,titleIcon:Ye,ejectButon:Ze};const et=()=>{const t=i=>{A.post(n.domain+"/api/manageGame/export",{gameName:n.currentEditGame,platform:i}).then(d=>{console.log(d.data),fe.success(`\u6E38\u620F\u5DF2\u88AB\u5BFC\u51FA\u81F3 Exported_Games/${n.currentEditGame}/${i}`).then()})};return s("div",{className:G.nav,children:[e(pe,{theme:"filled",size:"30",fill:"#333",className:G.titleIcon,onClick:()=>{c.set("isManagement",!0)}}),e("div",{className:G.title,children:"WebGAL ORIGINE"}),e("div",{style:{marginLeft:"auto"},className:G.ejectButon,onClick:()=>{t("web")},children:"\u5BFC\u51FA\u6E38\u620F\u4E3A\u7F51\u9875"}),e("div",{className:G.ejectButon,onClick:()=>{t("electron-windows")},children:"\u5BFC\u51FA\u6E38\u620F\u4E3A\u53EF\u6267\u884C\u6587\u4EF6"})]})},tt="_aside_1yqyp_1",nt="_option_1yqyp_11",st="_optionMarker_1yqyp_20",it="_optionMarkerOff_1yqyp_28",at="_chooseItem_1yqyp_36",ct="_chooseTitle_1yqyp_47",ot="_chooseDescription_1yqyp_52",dt="_tagButton_1yqyp_57",lt="_tagButtonOn_1yqyp_74",rt="_sideBarContent_1yqyp_81",ut="_previewWindow_1yqyp_88",mt="_sideBarMain_1yqyp_93",ht="_asidePreviewControlBar_1yqyp_102",gt="_gamePrevTitle_1yqyp_111",pt="_asidePreviewControlBar_button_1yqyp_119",ft="_asidePreviewControlBar_single_1yqyp_133";var I={aside:tt,option:nt,optionMarker:st,optionMarkerOff:it,chooseItem:at,chooseTitle:ct,chooseDescription:ot,tagButton:dt,tagButtonOn:lt,sideBarContent:rt,previewWindow:ut,sideBarMain:mt,asidePreviewControlBar:ht,gamePrevTitle:gt,asidePreviewControlBar_button:pt,asidePreviewControlBar_single:ft};const St="_title_11hgn_1",_t="_previewGameButton_11hgn_10",Nt="_gameNameInput_11hgn_19",vt="_optionContent_11hgn_32";var k={title:St,previewGameButton:_t,gameNameInput:Nt,optionContent:vt};const xt="_choosed_x0o7b_1",Ct="_chooseBox_x0o7b_7",Et="_chooseIcon_x0o7b_11",Bt="_chooseTitle_x0o7b_23",wt="_fileList_x0o7b_33",Ft="_singleFile_x0o7b_47",It="_fileIcon_x0o7b_63";var P={choosed:xt,chooseBox:Ct,chooseIcon:Et,chooseTitle:Bt,fileList:wt,singleFile:Ft,fileIcon:It};const D=t=>{const[i,d]=r.exports.useState(!1),[h,o]=r.exports.useState(t.dir),[u,f]=r.exports.useState([]),[m,g]=r.exports.useState(""),_=p=>{const v={dir:`/${n.currentEditGame}/game/${p}`};A.post(`${n.domain}/api/editGame/getAssets/`,v).then(E=>{f(E.data)}).catch(E=>{console.log(E)})},C=p=>{let l=p.split("/");p="";let v=0;for(const E of l)E!==t.dir&&(v!==0&&(p=p+"/"),v++,p=p+E);return p},N=p=>{let l=h+"/"+p;l=C(l),t.set(l),t.hasOwnProperty("setShow")&&t.setShow(l)};r.exports.useEffect(()=>{_(h)},[]);let x=[];for(const p of u){let l=!0,v=!0;p.match(/\.json/)&&(v=!1),p.match(/\./)&&(l=!1);let E=e("div",{children:""});l?E=s("div",{className:P.singleFile,onClick:()=>{const F=h+"/"+p;o(F),_(F)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",className:P.fileIcon}),p]},p):E=s("div",{className:P.singleFile,onClick:()=>{g(C(h+"/"+p)),N(p),d(!i)},children:[e(Se,{theme:"outline",size:"18",fill:"#333",className:P.fileIcon}),p]},p),v&&x.push(E)}return s("div",{children:[e("div",{className:P.chooseBox,children:s("div",{className:P.chooseIcon,onClick:()=>{i===!1&&(o(t.dir),g(""),_(t.dir)),d(!i)},children:[e(_e,{theme:"outline",size:"16",fill:"#333"}),e("span",{className:P.chooseTitle,children:"\u9009\u62E9\u6587\u4EF6"})]})}),e("div",{style:{position:"relative"},children:i&&e("div",{className:P.fileList,children:x})})]})},At=()=>{r.exports.useState(!1);const[t,i]=r.exports.useState(""),[d,h]=r.exports.useState(""),[o,u]=r.exports.useState(""),f=()=>{A.get(`${n.domain}/Games/${n.currentEditGame}/game/gameConfig.json`).then(N=>{let x=N.data;n.currentGameConfig=N.data,document.getElementById("gameNameInput").value=x.Game_name,i(x.Title_bgm),h(x.Title_img),u(x.Loading_img)})},m=()=>{n.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,C()},g=(N,x)=>{n.currentGameConfig[N]=x,C()},_=N=>x=>{g(N,x)},C=()=>{let N={currentEditGame:n.currentEditGame,config:n.currentGameConfig};A.post(`${n.domain}/api/manageGame/config`,N).then(x=>{})};return r.exports.useEffect(()=>{f()},[]),s("div",{style:{width:"100%"},children:[e("div",{children:e("a",{style:{color:"black",textDecoration:"none"},href:`${n.domain}/Games/${n.currentEditGame}`,target:"_blank",children:s("div",{className:k.previewGameButton,children:[e(Ne,{theme:"outline",size:"24",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,5px)"}}),"\u5728\u65B0\u6807\u7B7E\u9875\u9884\u89C8\u6E38\u620F"]})})}),s("div",{children:[e("div",{className:k.title,children:"\u6E38\u620F\u540D\u79F0"}),e("div",{className:k.optionContent,children:e("input",{onBlur:m,id:"gameNameInput",className:k.gameNameInput})})]}),s("div",{children:[e("div",{className:k.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),s("div",{className:k.optionContent,children:[t,e(D,{setShow:i,id:"bgmPicker",dir:"bgm",set:_("Title_bgm")})]})]}),s("div",{children:[e("div",{className:k.title,children:"\u6807\u9898\u80CC\u666F"}),s("div",{className:k.optionContent,children:[d,e(D,{setShow:h,id:"bgPicker",dir:"background",set:_("Title_img")})]})]})]})},yt="_main_z7pjj_2",Dt="_dirButtonContainer_z7pjj_8",kt="_icon_small_z7pjj_14",Pt="_controlPanel_z7pjj_21",bt="_upload_z7pjj_25",Lt="_dirButton_z7pjj_8",Tt="_fileElement_z7pjj_47",zt="_title_z7pjj_64",Gt="_currentDirShow_z7pjj_74",Ot="_panelButton_z7pjj_84",$t="_uploadTitle_z7pjj_96",Mt="_uploadButton_z7pjj_104";var B={main:yt,dirButtonContainer:Dt,icon_small:kt,controlPanel:Pt,upload:bt,dirButton:Lt,fileElement:Tt,title:zt,currentDirShow:Gt,panelButton:Ot,uploadTitle:$t,uploadButton:Mt};const de={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},le=t=>{let i=e(Y,{theme:"outline",size:"22",fill:"#333"});switch(t.icon){case"background":i=e(U,{theme:"outline",size:"22",fill:"#333"});break;case"bgm":i=e(W,{theme:"outline",size:"22",fill:"#333"});break;case"figure":i=e(R,{theme:"outline",size:"22",fill:"#333"});break;case"video":i=e(q,{theme:"outline",size:"22",fill:"#333"});break;case"vocal":i=e(xe,{theme:"outline",size:"22",fill:"#333"});break;case"file":i=e(ve,{theme:"outline",size:"22",fill:"#333"})}return i},jt=()=>{const[t,i]=r.exports.useState(!0),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refAssetsManagement",t),c.connect("refAssetsManagement",()=>{i(c.get("refAssetsManagement"))},"refAssetsManagement"),f()},[]);const f=()=>{const l=n.currentEditGame,v=n.currentDir,E={dir:`/${l}/game/${v}`};A.post(`${n.domain}/api/editGame/getAssets/`,E).then(F=>{n.currentDirContent=F.data,c.set("refAssetsManagement",!c.get("refAssetsManagement"))}).catch(F=>{console.log(F)})},m=()=>{if(n.currentDir==="")return;let l=n.currentDir.split("/");l.pop(),n.currentDir=l.reduce((v,E)=>""+v+"/"+E),f()},g=l=>{n.currentDir=n.currentDir+`/${l}`,f()},_=()=>{const l=n.currentEditGame,v=n.currentDir,E=`/${l}/game/${v}`;let F=new FormData;F.append("dir",E);const j=document.getElementById("uploadFile").files[0];let O=document.getElementById("uploadFile").value;F.append("file",j,O),A.post(`${n.domain}/api/editGame/addAsset/`,F,{headers:{"Content-Type":"multipart/form-data"}}).then(Q=>{h(!1),f()}).catch(Q=>{console.log(Q)})},C=()=>{const l=n.currentEditGame,v=n.currentDir,E=`/${l}/game/${v}`,F=document.getElementById("addDirInput").value,j={current:E,Name:F};A.post(`${n.domain}/api/editGame/mkdir/`,j).then(O=>{u(!1),f()}).catch(O=>{console.log(O)})},N=()=>{h(!d)},x=()=>{u(!o)},p=[];for(const l of n.currentDirContent){let v="",E=!0;if(l.match(/\./))n.currentDir===""&&(E=!1),v=s("div",{className:B.fileElement,children:[e("span",{className:B.icon_small,children:e(le,{icon:"file"})}),l]},l);else{let F=l;n.currentDir===""&&de.hasOwnProperty(l)&&(F=de[l]),v=s("div",{className:B.dirButton,onClick:()=>g(l),children:[e("span",{className:B.icon_small,children:e(le,{icon:l})}),F]},l),l==="scene"&&n.currentDir===""&&(E=!1)}E&&p.push(v)}return s("div",{className:B.main,children:[n.currentDir!==""&&e("div",{className:B.currentDirShow,children:n.currentDir}),n.currentDir!==""&&s("div",{className:B.controlPanel,children:[e("div",{children:e(Ce,{theme:"outline",size:"24",fill:"#333",onClick:m,className:B.panelButton})}),s("div",{children:[e(Ee,{theme:"outline",size:"24",fill:"#333",onClick:N,className:B.panelButton}),d&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u4E0A\u4F20\u6587\u4EF6"}),e("input",{id:"uploadFile",type:"file"}),e("div",{className:B.uploadButton,onClick:_,children:"\u4E0A\u4F20"})]})]}),s("div",{children:[e(Be,{theme:"outline",size:"24",fill:"#333",onClick:x,className:B.panelButton}),o&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"}),e("input",{id:"addDirInput"}),e("div",{className:B.uploadButton,onClick:C,children:"\u65B0\u5EFA"})]})]})]}),e("div",{}),e("div",{className:B.dirButtonContainer,children:p})]})},qt="_main_1p8zt_1",Rt="_addInput_1p8zt_12",Wt="_title_1p8zt_21",Ut="_addButton_1p8zt_29";var M={main:qt,addInput:Rt,title:Wt,addButton:Ut};const Vt=t=>{const i=()=>{const d={gameName:n.currentEditGame,sceneName:document.getElementById("addSceneName").value};A.post(`${n.domain}/api/editGame/addNewScene/`,d).then(h=>{t.added()}).catch(h=>{console.log(h)})};return s("div",{className:M.main,children:[s("div",{className:M.title,children:["\u573A\u666F\u540D\u79F0",e("input",{className:M.addInput,id:"addSceneName"})]}),e("div",{className:M.addButton,onClick:i,children:"\u65B0\u5EFA\u573A\u666F"})]})},Jt="_titleText_juf2g_1",Ht="_scene_juf2g_11",Kt="_newSceneButton_juf2g_22",Qt="_sceneList_juf2g_35";var V={titleText:Jt,scene:Ht,newSceneButton:Kt,sceneList:Qt};const J=()=>{n.currentEditScene!==""&&(n.sceneScrollTop[n.currentEditScene]=document.getElementById("currentSentenceList").scrollTop)},Xt=()=>{const[t,i]=r.exports.useState([]),[d,h]=r.exports.useState(!1),o=()=>{const C={dir:`/${n.currentEditGame}/game/scene`};A.post(`${n.domain}/api/editGame/getAssets/`,C).then(N=>{i(N.data)}).catch(N=>{console.log(N)})},u=()=>{o(),h(!d)};r.exports.useEffect(()=>{o()},[]);const f=g=>{n.currentOpendSceneEdit.includes(g)||n.currentOpendSceneEdit.push(g),J(),n.currentEditScene=g,c.set("updateEditor",!c.get("updateEditor"))},m=[];for(const g of t){let _=!1,C=g.split(".");C[C.length-1]==="json"&&(_=!0);const N=s("div",{className:V.scene,onClick:()=>f(g),children:[e($,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),g]},g);_&&m.push(N)}return s("div",{style:{width:"100%"},children:[s("div",{className:V.newSceneButton,onClick:()=>{h(!d)},children:[e(we,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0",transform:"translate(0,2px)"}}),"\u65B0\u5EFA\u573A\u666F"]}),e("div",{children:d&&e(Vt,{added:u})}),e("div",{className:V.sceneList,children:m})]})},Yt=()=>{const t=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[i,d]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refSideBar",i),c.connect("refSideBar",()=>{d(c.get("refSideBar"))},"refSideBarFunc")},[]);const h=[];for(const m of t){let g="#333";m===n.editorTag?(I.optionMarker,g="#8e354a"):I.optionMarkerOff;let _=e(Ie,{theme:"outline",size:"14",fill:g});m==="\u7D20\u6750\u7BA1\u7406"&&(_=e(Ae,{theme:"outline",size:"14",fill:g})),m==="\u573A\u666F\u7BA1\u7406"&&(_=e($,{theme:"outline",size:"14",fill:g}));const C=e("div",{className:m===n.editorTag?I.tagButton+" "+I.tagButtonOn:I.tagButton,onClick:()=>{n.editorTag=m,c.set("refSideBar",!c.get("refSideBar"))},children:s("div",{children:[_,e("span",{style:{margin:"0 5px 0 0 "}}),m]})},m);h.push(C)}let o;switch(n.editorTag){case"\u6E38\u620F\u914D\u7F6E":o=e(At,{});break;case"\u7D20\u6750\u7BA1\u7406":o=e(jt,{});break;case"\u573A\u666F\u7BA1\u7406":o=e(Xt,{});break}function u(m){n.isRealtimeRefreashPreview=m}function f(){const m=document.getElementById("gamePreviewIframe");m.src="",m.src=`${n.domain}/Games/${n.currentEditGame}`}return s("aside",{className:I.aside,children:[s("div",{className:I.asidePreviewControlBar,children:[e("div",{className:I.asidePreviewControlBar_single,children:e("span",{className:I.gamePrevTitle,children:"\u6E38\u620F\u9884\u89C8"})}),s("div",{id:"refPreviewButton",className:I.asidePreviewControlBar_button,onClick:f,children:[e(Fe,{style:{transform:"translate(0,0)",margin:"0 3px 0 0 "},theme:"outline",size:"14",fill:"#000",strokeWidth:3}),"\u5237\u65B0"]}),s("div",{className:I.asidePreviewControlBar_single,children:["\u5B9E\u65F6\u66F4\u65B0",e("span",{style:{margin:"0 10px 0 0 "}}),e(z,{defaultChecked:!0,onChange:u,size:"small"})]})]}),e("iframe",{id:"gamePreviewIframe",frameBorder:"0",className:I.previewWindow,src:`${n.domain}/Games/${n.currentEditGame}`}),s("div",{className:I.sideBarMain,children:[e("div",{className:I.option,children:h}),e("div",{className:I.sideBarContent,children:o})]})]})},Zt="_main_r7n8t_1";var en={main:Zt};const tn="_main_1m1df_1",nn="_tag_1m1df_8",sn="_tagOpened_1m1df_19",an="_tagList_1m1df_26",cn="_tagIcon_1m1df_33",on="_closeIcon_1m1df_38";var b={main:tn,tag:nn,tagOpened:sn,tagList:an,tagIcon:cn,closeIcon:on};const dn="_main_1m4ta_1",ln="_topButtonList_1m4ta_5",rn="_topButton_1m4ta_5",un="_addSentencePanel_1m4ta_32",mn="_addSentencePanel_main_1m4ta_44",hn="_addSentenceButton_1m4ta_57",gn="_sentenceList_1m4ta_67",pn="_sentence_1m4ta_67",fn="_sentenceIn_1m4ta_1",Sn="_lineNumber_1m4ta_81",_n="_sentenceMain_1m4ta_91",Nn="_addItemIcon_1m4ta_105";var S={main:dn,topButtonList:ln,topButton:rn,addSentencePanel:un,addSentencePanel_main:mn,addSentenceButton:hn,sentenceList:gn,sentence:pn,sentenceIn:fn,lineNumber:Sn,sentenceMain:_n,addItemIcon:Nn};const vn=t=>{let i;switch(t){case"dialog":i={type:t,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":i={type:t,bg:"",noBg:!1,next:!1};break;case"bgm":i={type:t,bgm:"",noBgm:!1};break;case"changeScene":i={type:t,newScene:""};break;case"video":i={type:t,video:""};break;case"changeP":i={type:t,newP:"",next:!1,noP:!1,pos:""};break;case"choose":i={type:t,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break;case"intro":i={type:t,content:[]};break}return i},xn="_sentence_leq4c_1",Cn="_dialog_input_leq4c_7",En="_singleOption_leq4c_14",Bn="_optionTitle_leq4c_22",wn="_dialog_edit_title_leq4c_29",Fn="_optionContent_leq4c_34",In="_isolate_leq4c_38",An="_sentenceButtonList_leq4c_43",yn="_sentenceButton_leq4c_43",Dn="_sentenceIndexShow_leq4c_67",kn="_barContainer_leq4c_82",Pn="_mainEdit_leq4c_93",bn="_topContainer_leq4c_101";var a={sentence:xn,dialog_input:Cn,singleOption:En,optionTitle:Bn,dialog_edit_title:wn,optionContent:Fn,isolate:In,sentenceButtonList:An,sentenceButton:yn,sentenceIndexShow:Dn,barContainer:kn,mainEdit:Pn,topContainer:bn};const Ln=t=>{n.currentSceneSentenceList.splice(t,1),c.set("writeScene",!c.get("writeScene"))},re=(t,i)=>{if(!(t===0&&i===-1||t===n.currentSceneSentenceList.length-1&&i===1)){{const d=n.currentSceneSentenceList[t];n.currentSceneSentenceList.splice(t,1),n.currentSceneSentenceList.splice(t+i,0,d)}c.set("writeScene",!c.get("writeScene"))}},ue=t=>e("div",{style:{lineHeight:"18px"},children:s("div",{className:S.addSentencePanel,children:[s("div",{className:S.addSentenceButton,onClick:()=>{w("dialog",t.index)},children:[e(Z,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeP",t.index)},children:[e(R,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bg",t.index)},children:[e(U,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeScene",t.index)},children:[e(ee,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("choose",t.index)},children:[e(te,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bgm",t.index)},children:[e(W,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("video",t.index)},children:[e(q,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("intro",t.index)},children:[e(ne,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u9ED1\u5C4F\u6587\u5B57"]})]})}),L=t=>s("div",{className:a.sentenceButtonList,children:[s("div",{className:a.sentenceButton,onClick:()=>{Ln(t.index)},children:[e(ye,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),s("div",{onClick:()=>{re(t.index,-1)},className:a.sentenceButton,children:[e(De,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{re(t.index,1)},className:a.sentenceButton,children:[e(ke,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{t.data.setShowAddPre(!t.data.showAddPre)},className:a.sentenceButton,children:[e(se,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",t.data.showAddPre&&e(ue,{index:t.data.indexPre})]}),s("div",{onClick:()=>{t.data.setShowAddAfter(!t.data.showAddAfter)},className:a.sentenceButton,children:[e(se,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",t.data.showAddAfter&&e(ue,{index:t.data.indexAfter})]})]}),T=t=>{const i=n.wsConn;n.isRealtimeRefreashPreview&&setTimeout(()=>{i.send(`jmp ${n.currentEditScene} ${t}`)},500)},Tn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{document.getElementById("speakerInput"+t.index).value=t.data.speaker,document.getElementById("contentInput"+t.index).value=t.data.content});const _=()=>{n.currentSceneSentenceList[t.index].speaker=document.getElementById("speakerInput"+t.index).value,n.currentSceneSentenceList[t.index].content=document.getElementById("contentInput"+t.index).value,c.set("writeScene",!c.get("writeScene")),i()},C=l=>{n.currentSceneSentenceList[t.index].ignoreSpeaker=l,c.set("writeScene",!c.get("writeScene")),i()},[N,x]=r.exports.useState(t.data.vocal),p=()=>l=>{n.currentSceneSentenceList[t.index].vocal=l,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u57FA\u672C\u5BF9\u8BDD"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.dialog_edit_title,children:"\u89D2\u8272\uFF1A"}),e("input",{className:a.dialog_input,onBlur:_,id:"speakerInput"+t.index}),e("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.dialog_edit_title,children:"\u5BF9\u8BDD\uFF1A"}),e("textarea",{className:a.dialog_input,onBlur:_,id:"contentInput"+t.index})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u65C1\u767D\u6A21\u5F0F"}),s("span",{className:a.optionContent,children:[e(z,{size:"small",id:"dialog_pbms",checked:t.data.ignoreSpeaker,onChange:C}),"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"]}),e("div",{className:a.optionTitle,children:"\u914D\u97F3\u6587\u4EF6"}),e(D,{setShow:x,id:"vocalPicker",dir:"vocal",set:p()}),e("span",{className:a.optionContent,children:N})]})]})]},t.index+"dialog")},zn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const _=l=>{n.currentSceneSentenceList[t.index].noBg=l,c.set("writeScene",!c.get("writeScene")),i()},C=l=>{n.currentSceneSentenceList[t.index].next=l,c.set("writeScene",!c.get("writeScene")),i()},[N,x]=r.exports.useState(t.data.bg),p=()=>l=>{n.currentSceneSentenceList[t.index].bg=l,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u66F4\u6539\u80CC\u666F"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u80CC\u666F"}),s("span",{className:a.optionContent,children:[e(z,{size:"small",checked:t.data.noBg,id:"bg_none"+t.index,onChange:_}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"]}),e("span",{className:a.optionTitle,children:"\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5"}),e("span",{className:a.optionContent,children:e(z,{size:"small",id:"bg_next"+t.index,checked:t.data.next,onChange:C})})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u80CC\u666F\u6587\u4EF6"}),e(D,{setShow:x,id:"bgPicker",dir:"background",set:p()}),e("span",{className:a.optionContent,children:N})]})]})]},t.index+"bg")},Gn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const _=p=>{n.currentSceneSentenceList[t.index].noBgm=p,c.set("writeScene",!c.get("writeScene")),i()},[C,N]=r.exports.useState(t.data.bgm),x=()=>p=>{n.currentSceneSentenceList[t.index].bgm=p,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u66F4\u6539\u97F3\u4E50"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u80CC\u666F\u97F3\u4E50"}),s("span",{className:a.optionContent,children:[e(z,{size:"small",id:"bgm_none"+t.index,checked:t.data.noBgm,onChange:_}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"]})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u80CC\u666F\u97F3\u4E50\u6587\u4EF6"}),e(D,{setShow:N,id:"bgmPicker",dir:"bgm",set:x()}),e("span",{className:a.optionContent,children:C})]})]})]},t.index+"bgm")},On=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const[_,C]=r.exports.useState(t.data.newScene),N=()=>x=>{n.currentSceneSentenceList[t.index].newScene=x,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5207\u6362\u573A\u666F"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),e("main",{className:a.mainEdit,children:s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u65B0\u573A\u666F"}),e(D,{setShow:C,id:"scenePicker",dir:"scene",set:N()}),e("span",{className:a.optionContent,children:_})]})})]},t.index+"scene")},$n=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const[_,C]=r.exports.useState(t.data.video),N=()=>x=>{n.currentSceneSentenceList[t.index].video=x,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u64AD\u653E\u89C6\u9891"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),e("main",{className:a.mainEdit,children:s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u89C6\u9891\u6587\u4EF6"}),e(D,{setShow:C,id:"videoPicker",dir:"video",set:N()}),e("span",{className:a.optionContent,children:_})]})})]},t.index+"scene")},{Option:H}=ie,Mn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const _=v=>{n.currentSceneSentenceList[t.index].noP=v,c.set("writeScene",!c.get("writeScene")),i()},C=v=>{n.currentSceneSentenceList[t.index].next=v,c.set("writeScene",!c.get("writeScene")),i()},[N,x]=r.exports.useState(t.data.newP),p=()=>v=>{n.currentSceneSentenceList[t.index].newP=v,c.set("writeScene",!c.get("writeScene")),i()},l=v=>{n.currentSceneSentenceList[t.index].pos=v,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5207\u6362\u7ACB\u7ED8"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u7ACB\u7ED8"}),e("span",{className:a.optionContent,children:e(z,{size:"small",id:"p_none",checked:t.data.noP,onChange:_})}),e("span",{className:a.optionContent,children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"}),e("span",{className:a.optionTitle,children:"\u7ACB\u7ED8\u4F4D\u7F6E"}),s(ie,{size:"small",defaultValue:t.data.pos,style:{width:120},onChange:l,children:[e(H,{value:"left",children:"\u5DE6"}),e(H,{value:"",children:"\u4E2D"}),e(H,{value:"right",children:"\u53F3"})]}),e("span",{className:a.optionContent,children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),e("span",{className:a.optionContent,children:e(z,{size:"small",id:"p_none",checked:t.data.next,onChange:C})})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u7ACB\u7ED8\u6587\u4EF6"}),e(D,{setShow:x,id:"pPicker",dir:"figure",set:p()}),e("span",{className:a.optionContent,children:N})]})]})]},t.index+"dialog")},jn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{for(let l=0;l<t.data.chooseItem.length;l++)document.getElementById("chooseInput"+t.index+"itemIndex"+l).value=t.data.chooseItem[l].text});const _=()=>{n.currentSceneSentenceList[t.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),c.set("writeScene",!c.get("writeScene")),i()},C=l=>{const v=parseInt(l.split("Index")[1]);console.log(v),n.currentSceneSentenceList[t.index].chooseItem[v].text=document.getElementById(l).value,c.set("writeScene",!c.get("writeScene")),i()},N=l=>v=>{n.currentSceneSentenceList[t.index].chooseItem[l].scene=v,c.set("writeScene",!c.get("writeScene")),i()};let x=[],p=0;for(const l of t.data.chooseItem){const v="chooseInput"+t.index+"itemIndex"+p;let E=s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5206\u652F\u540D\u79F0"}),e("input",{className:a.dialog_input,style:{width:"200px"},onBlur:()=>{C(v)},id:v}),e("span",{className:a.optionContent,children:e(Pe,{theme:"outline",size:"24",fill:"#333"})}),e("span",{className:a.optionTitle,children:"\u8DF3\u8F6C\u7684\u573A\u666F"}),e(D,{id:"scenePicker",dir:"scene",set:N(p)}),e("span",{className:a.optionContent,children:l.scene})]},p);x.push(E),p++}return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5206\u652F\u9009\u62E9"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:_,className:a.sentenceButton,children:[e(ae,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),x]})]},t.index+"choose")},qn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{for(let p=0;p<t.data.content.length;p++)document.getElementById("introInput"+t.index+"itemIndex"+p).value=t.data.content[p]});const _=()=>{n.currentSceneSentenceList[t.index].content.push("\u5728\u6B64\u586B\u5165\u8981\u5C55\u793A\u7684\u6587\u5B57"),c.set("writeScene",!c.get("writeScene")),i()},C=p=>{const l=parseInt(p.split("Index")[1]);console.log(l),n.currentSceneSentenceList[t.index].content[l]=document.getElementById(p).value,c.set("writeScene",!c.get("writeScene")),i()};let N=[],x=0;for(const p of t.data.content){const l="introInput"+t.index+"itemIndex"+x;let v=s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u663E\u793A\u6587\u5B57"}),e("input",{className:a.dialog_input,style:{width:"200px"},onBlur:()=>{C(l)},id:l})]},x);N.push(v),x++}return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u9ED1\u5C4F\u6587\u5B57"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:_,className:a.sentenceButton,children:[e(ae,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u6587\u5B57"]})}),N]})]},t.index+"intro")},Rn=(t,i)=>{let d;switch(t.type){case"dialog":d=e(Tn,{data:t,index:i},i);break;case"bg":d=e(zn,{data:t,index:i},i);break;case"bgm":d=e(Gn,{data:t,index:i},i);break;case"changeScene":d=e(On,{data:t,index:i},i);break;case"video":d=e($n,{data:t,index:i},i);break;case"changeP":d=e(Mn,{data:t,index:i},i);break;case"choose":d=e(jn,{data:t,index:i},i);break;case"intro":d=e(qn,{data:t,index:i},i);break}return d};const Wn=t=>{const[i,d]=r.exports.useState(!0),[h,o]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateScene",i),c.connect("updateScene",()=>{d(c.get("updateScene"))},"updateSceneFunc"),c.set("refScene",!0),c.connect("refScene",()=>{K()},"refSceneFunc"),c.get("writeScene")===void 0&&c.set("writeScene",!0),c.connect("writeScene",()=>{me()},"writeSceneFunc"),K(),n.sceneScrollTop.hasOwnProperty(n.currentEditScene)&&setTimeout(()=>{document.getElementById("currentSentenceList").scrollTop=n.sceneScrollTop[n.currentEditScene]},0)},[]);let u=[];const f=JSON.parse(JSON.stringify(n.currentSceneSentenceList));for(let g=0;g<f.length;g++){const _=f[g],C=Rn(_,g),N=s("div",{className:S.sentence,children:[e("div",{className:S.lineNumber,children:g+1}),e("div",{className:S.sentenceMain,children:C})]},"sentence"+g+n.currentEditScene);u.push(N)}const m=s("div",{className:S.addSentencePanel_main,children:[s("div",{className:S.addSentenceButton,onClick:()=>{w("dialog"),o(!1)},children:[e(Z,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeP"),o(!1)},children:[e(R,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bg"),o(!1)},children:[e(U,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeScene"),o(!1)},children:[e(ee,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("choose"),o(!1)},children:[e(te,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bgm"),o(!1)},children:[e(W,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("video"),o(!1)},children:[e(q,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("intro"),o(!1)},children:[e(ne,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u9ED1\u5C4F\u6587\u5B57"]})]});return s("div",{className:S.main,children:[s("div",{className:S.topButtonList,children:[e("div",{className:S.topButton,onClick:()=>{o(!h)},children:e(X,{theme:"outline",size:"24",fill:"#fff"})}),e("div",{children:h&&m})]}),e("div",{className:S.sentenceList,id:"currentSentenceList",children:u})]})};function K(){let t=n.currentEditScene;if(t==="")return;const i=`${n.domain}/Games/${n.currentEditGame}/game/scene/${t}`;A.get(i).then(d=>{n.currentSceneSentenceList=d.data,c.set("updateScene",!c.get("updateScene"))}).catch(d=>console.log(d))}function w(t,i){const d=vn(t);i!==void 0?n.currentSceneSentenceList.splice(i,0,d):n.currentSceneSentenceList.push(d),me()}function me(){const t=`${n.domain}/api/editGame/editScene/`,i={gameName:n.currentEditGame,sceneName:n.currentEditScene,sceneData:n.currentSceneSentenceList};A.post(t,i).then(d=>{K()}).catch(d=>console.log(d))}const Un=()=>{const[t,i]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateEditor",t),c.connect("updateEditor",()=>{i(c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},"updateEditorFunc")},[]);const d=u=>{J(),n.currentEditScene=u,c.set("updateEditor",!c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},h=u=>{J();const f=n.currentOpendSceneEdit.indexOf(u);n.currentOpendSceneEdit.splice(f,1);const m=n.currentOpendSceneEdit.length===0;u===n.currentEditScene&&(m?n.currentEditScene="":n.currentOpendSceneEdit.length<=f?n.currentEditScene=n.currentOpendSceneEdit[n.currentOpendSceneEdit.length-1]:n.currentEditScene=n.currentOpendSceneEdit[f]),c.set("updateEditor",!c.get("updateEditor"))},o=[];for(const u of n.currentOpendSceneEdit){let f;u===n.currentEditScene?f=s("div",{className:b.tagOpened,children:[e($,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),u,e(ce,{theme:"outline",size:"20",fill:"#333",className:b.closeIcon,onClick:()=>{h(u)}})]},u):f=s("div",{className:b.tag,onClick:()=>{d(u)},children:[e($,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),u,e(ce,{theme:"outline",size:"20",fill:"#333",className:b.closeIcon,onClick:m=>{m.preventDefault(),m.stopPropagation(),h(u)}})]},u),o.push(f)}return s("div",{className:b.main,children:[e("div",{className:b.tagList,children:o}),e("div",{children:n.currentEditScene!==""&&e(Wn,{sceneName:n.currentEditScene},n.currentEditScene)})]})},Vn=()=>{const[t,i]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("updateEditor",!0),c.connect("updateEditor",()=>{i(c.get("updateEditor"))},"ForceUpdateEditor");try{const h=`ws://${window.location.hostname}:9999`;console.log("\u6B63\u5728\u542F\u52A8socket\u8FDE\u63A5\u4F4D\u4E8E\uFF1A"+h);const o=new WebSocket(h);o.onopen=()=>{console.log("socket\u5DF2\u8FDE\u63A5"),o.send("WebGAL Origine \u5DF2\u548C Terre \u5EFA\u7ACB\u8FDE\u63A5")},o.onmessage=u=>{console.log("\u6536\u5230\u4FE1\u606F",u.data)},n.wsConn=o}catch{console.warn("ws\u8FDE\u63A5\u5931\u8D25")}},[]),s("div",{children:[e(et,{}),s("main",{className:en.main,children:[e(Yt,{}),e(Un,{})]})]})};function Jn(){const[t,i]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("isManageMent",!0),c.connect("isManagement",()=>{i(c.get("isManagement"))},"setIsManagementFunc"),console.log("WebGAL Origine 1.1.2"),console.log("Github: https://github.com/MakinoharaShoko/WebGAL "),console.log("Made with \u2764 by MakinoharaShoko")},[]),s("div",{className:"App",children:[t&&e(Ke,{}),!t&&e(Vn,{})]})}be.render(e(Le.StrictMode,{children:e(Jn,{})}),document.getElementById("root"));
