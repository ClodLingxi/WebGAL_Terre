import{f as re,r,a as A,j as s,b as e,G as ue,A as X,L as me,F as Y,N as he,E as ge,P as pe,D as Se,V as fe,c as $,d as M,e as j,g as q,h as _e,R as Ne,U as ve,i as xe,k as U,C as Z,l as ee,S as te,m as Ee,n as Ce,o as Be,p as ne,q as L,s as se,t as Fe,u as we,v as ie,w as Ae,x as ke}from"./vendor.71b7dffb.js";const De=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))h(d);new MutationObserver(d=>{for(const o of d)if(o.type==="childList")for(const g of o.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&h(g)}).observe(document,{childList:!0,subtree:!0});function l(d){const o={};return d.integrity&&(o.integrity=d.integrity),d.referrerpolicy&&(o.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?o.credentials="include":d.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function h(d){if(d.ep)return;d.ep=!0;const o=l(d);fetch(d.href,o)}};De();const Ie="_nav_11k4b_2",be="_title_11k4b_12",ye="_subTitle_11k4b_20",Pe="_main_11k4b_29",Le="_gameList_11k4b_33",Te="_singleGameEntryButton_11k4b_39",ze="_buttonIcon_11k4b_54",Ge="_addIcon_11k4b_58",Oe="_createPanel_11k4b_65",$e="_createPanelTitle_11k4b_75",Me="_createPanelInput_11k4b_81",je="_createButton_11k4b_87";var k={nav:Ie,title:be,subTitle:ye,main:Pe,gameList:Le,singleGameEntryButton:Te,buttonIcon:ze,addIcon:Ge,createPanel:Oe,createPanelTitle:$e,createPanelInput:Me,createButton:je};const a=new re;a.set("updateEditor",!0);const ce={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[],sceneScrollTop:{}},n=JSON.parse(JSON.stringify(ce)),qe=()=>{const[t,c]=r.exports.useState(!0),[l,h]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refManagement",t),a.connect("refManagement",()=>{c(a.get("refManagement"))},"refManagementFunc"),d()},[]);const d=()=>{A.get(n.domain+"/api/manageGame/gameList").then(S=>{n.gameList=S.data,a.set("refManagement",!a.get("refManagement"))}).catch(S=>{console.log(S)})};let o=[];for(const S of n.gameList){const p=s("div",{className:k.singleGameEntryButton,onClick:()=>{for(const _ in n)n[_]=ce[_];n.currentEditGame=S,a.set("isManagement",!1)},children:[e(ue,{theme:"outline",size:"24",fill:"#333",className:k.buttonIcon}),S]},S);o.push(p)}const g=S=>{const p=`${n.domain}/api/manageGame/createGame/${S}`;A.get(p).then(_=>{h(!1),d()})};return s("div",{children:[e("header",{children:e("nav",{children:e("div",{className:k.nav,children:e("div",{className:k.title,children:"WebGAL ORIGINE"})})})}),s("main",{className:k.main,children:[s("div",{className:k.subTitle,children:["\u6E38\u620F\u5217\u8868",s("span",{onClick:()=>h(!l),className:k.addIcon,children:[e(X,{theme:"outline",size:"18",fill:"#8E354A"})," \u65B0\u5EFA\u6E38\u620F"]}),l&&s("div",{className:k.createPanel,children:[e("div",{className:k.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),s("div",{children:["\u6E38\u620F\u540D\u79F0\uFF1A",e("input",{id:"createInput",className:k.createPanelInput})]}),e("div",{style:{textAlign:"center"},children:e("div",{onClick:()=>g(document.getElementById("createInput").value),className:k.createButton,children:"\u521B\u5EFA"})})]})]}),e("div",{className:k.gameList,children:o})]})]})},Ue="_nav_fct5m_1",Re="_title_fct5m_13",Ve="_titleIcon_fct5m_21";var R={nav:Ue,title:Re,titleIcon:Ve};const Je=()=>s("div",{className:R.nav,children:[e(me,{theme:"filled",size:"30",fill:"#333",className:R.titleIcon,onClick:()=>{a.set("isManagement",!0)}}),e("div",{className:R.title,children:"WebGAL ORIGINE"})]}),We="_aside_1lxuu_1",Ke="_option_1lxuu_10",He="_optionMarker_1lxuu_20",Qe="_optionMarkerOff_1lxuu_28",Xe="_chooseItem_1lxuu_36",Ye="_chooseTitle_1lxuu_47",Ze="_chooseDescription_1lxuu_52",et="_tagButton_1lxuu_57",tt="_tagButtonOn_1lxuu_72",nt="_sideBarContent_1lxuu_78";var I={aside:We,option:Ke,optionMarker:He,optionMarkerOff:Qe,chooseItem:Xe,chooseTitle:Ye,chooseDescription:Ze,tagButton:et,tagButtonOn:tt,sideBarContent:nt};const st="_title_jfelw_1",it="_previewGameButton_jfelw_10",ct="_gameNameInput_jfelw_20";var T={title:st,previewGameButton:it,gameNameInput:ct};const at="_choosed_imeie_1",ot="_chooseBox_imeie_7",dt="_chooseIcon_imeie_11",lt="_fileList_imeie_26",rt="_singleFile_imeie_38",ut="_fileIcon_imeie_49";var y={choosed:at,chooseBox:ot,chooseIcon:dt,fileList:lt,singleFile:rt,fileIcon:ut};const D=t=>{const[c,l]=r.exports.useState(!1),[h,d]=r.exports.useState(t.dir),[o,g]=r.exports.useState([]),[S,p]=r.exports.useState(""),_=u=>{const C={dir:`/${n.currentEditGame}/game/${u}`};A.post(`${n.domain}/api/editGame/getAssets/`,C).then(E=>{g(E.data)}).catch(E=>{console.log(E)})},v=u=>{let m=u.split("/");u="";let C=0;for(const E of m)E!==t.dir&&(C!==0&&(u=u+"/"),C++,u=u+E);return u},f=u=>{let m=h+"/"+u;m=v(m),t.set(m),t.hasOwnProperty("setShow")&&t.setShow(m)};r.exports.useEffect(()=>{_(h)},[]);let N=[];for(const u of o){let m=!0,C=!0;u.match(/\.json/)&&(C=!1),u.match(/\./)&&(m=!1);let E=e("div",{children:""});m?E=s("div",{className:y.singleFile,onClick:()=>{const F=h+"/"+u;d(F),_(F)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",className:y.fileIcon}),u]},u):E=s("div",{className:y.singleFile,onClick:()=>{p(v(h+"/"+u)),f(u),l(!c)},children:[e(he,{theme:"outline",size:"18",fill:"#333",className:y.fileIcon}),u]},u),C&&N.push(E)}return s("div",{children:[e("div",{className:y.chooseBox,children:s("div",{className:y.chooseIcon,onClick:()=>{c===!1&&(d(t.dir),p(""),_(t.dir)),l(!c)},children:[e(ge,{theme:"outline",size:"16",fill:"#333"})," \u9009\u62E9\u6587\u4EF6"]})}),e("div",{style:{position:"relative"},children:c&&e("div",{className:y.fileList,children:N})})]})},mt=()=>{r.exports.useState(!1);const[t,c]=r.exports.useState(""),[l,h]=r.exports.useState(""),[d,o]=r.exports.useState(""),g=()=>{A.get(`${n.domain}/Games/${n.currentEditGame}/game/gameConfig.json`).then(f=>{let N=f.data;n.currentGameConfig=f.data,document.getElementById("gameNameInput").value=N.Game_name,c(N.Title_bgm),h(N.Title_img),o(N.Loading_img)})},S=()=>{n.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,v()},p=(f,N)=>{n.currentGameConfig[f]=N,v()},_=f=>N=>{p(f,N)},v=()=>{let f={currentEditGame:n.currentEditGame,config:n.currentGameConfig};A.post(`${n.domain}/api/manageGame/config`,f).then(N=>{})};return r.exports.useEffect(()=>{g()},[]),s("div",{style:{width:"100%"},children:[e("div",{children:e("a",{style:{color:"black",textDecoration:"none"},href:`${n.domain}/Games/${n.currentEditGame}`,target:"_blank",children:s("div",{className:T.previewGameButton,children:[e(pe,{theme:"outline",size:"28",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,5px)"}}),"\u9884\u89C8\u6E38\u620F"]})})}),s("div",{children:[e("div",{className:T.title,children:"\u6E38\u620F\u540D\u79F0"}),e("div",{children:e("input",{onBlur:S,id:"gameNameInput",className:T.gameNameInput})})]}),s("div",{children:[e("div",{className:T.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),s("div",{children:[t,e(D,{setShow:c,id:"bgmPicker",dir:"bgm",set:_("Title_bgm")})]})]}),s("div",{children:[e("div",{className:T.title,children:"\u6807\u9898\u80CC\u666F"}),s("div",{children:[l,e(D,{setShow:h,id:"bgPicker",dir:"background",set:_("Title_img")})]})]}),s("div",{children:[e("div",{className:T.title,children:"\u52A0\u8F7D\u56FE"}),s("div",{children:[d,e(D,{setShow:o,id:"loadImgPicker",dir:"background",set:_("Loading_img")})]})]})]})},ht="_dirButtonContainer_iqtdj_2",gt="_icon_small_iqtdj_8",pt="_controlPanel_iqtdj_15",St="_upload_iqtdj_19",ft="_dirButton_iqtdj_2",_t="_fileElement_iqtdj_41",Nt="_title_iqtdj_58",vt="_currentDirShow_iqtdj_68",xt="_panelButton_iqtdj_78",Et="_uploadTitle_iqtdj_90",Ct="_uploadButton_iqtdj_98";var B={dirButtonContainer:ht,icon_small:gt,controlPanel:pt,upload:St,dirButton:ft,fileElement:_t,title:Nt,currentDirShow:vt,panelButton:xt,uploadTitle:Et,uploadButton:Ct};const ae={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},oe=t=>{let c=e(Y,{theme:"outline",size:"22",fill:"#333"});switch(t.icon){case"background":c=e(q,{theme:"outline",size:"22",fill:"#333"});break;case"bgm":c=e(j,{theme:"outline",size:"22",fill:"#333"});break;case"figure":c=e(M,{theme:"outline",size:"22",fill:"#333"});break;case"video":c=e($,{theme:"outline",size:"22",fill:"#333"});break;case"vocal":c=e(fe,{theme:"outline",size:"22",fill:"#333"});break;case"file":c=e(Se,{theme:"outline",size:"22",fill:"#333"})}return c},Bt=()=>{const[t,c]=r.exports.useState(!0),[l,h]=r.exports.useState(!1),[d,o]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refAssetsManagement",t),a.connect("refAssetsManagement",()=>{c(a.get("refAssetsManagement"))},"refAssetsManagement"),g()},[]);const g=()=>{const m=n.currentEditGame,C=n.currentDir,E={dir:`/${m}/game/${C}`};A.post(`${n.domain}/api/editGame/getAssets/`,E).then(F=>{n.currentDirContent=F.data,a.set("refAssetsManagement",!a.get("refAssetsManagement"))}).catch(F=>{console.log(F)})},S=()=>{if(n.currentDir==="")return;let m=n.currentDir.split("/");m.pop(),n.currentDir=m.reduce((C,E)=>""+C+"/"+E),g()},p=m=>{n.currentDir=n.currentDir+`/${m}`,g()},_=()=>{const m=n.currentEditGame,C=n.currentDir,E=`/${m}/game/${C}`;let F=new FormData;F.append("dir",E);const O=document.getElementById("uploadFile").files[0];let z=document.getElementById("uploadFile").value;F.append("file",O,z),A.post(`${n.domain}/api/editGame/addAsset/`,F,{headers:{"Content-Type":"multipart/form-data"}}).then(Q=>{h(!1),g()}).catch(Q=>{console.log(Q)})},v=()=>{const m=n.currentEditGame,C=n.currentDir,E=`/${m}/game/${C}`,F=document.getElementById("addDirInput").value,O={current:E,Name:F};A.post(`${n.domain}/api/editGame/mkdir/`,O).then(z=>{o(!1),g()}).catch(z=>{console.log(z)})},f=()=>{h(!l)},N=()=>{o(!d)},u=[];for(const m of n.currentDirContent){let C="",E=!0;if(m.match(/\./))n.currentDir===""&&(E=!1),C=s("div",{className:B.fileElement,children:[e("span",{className:B.icon_small,children:e(oe,{icon:"file"})}),m]},m);else{let F=m;n.currentDir===""&&ae.hasOwnProperty(m)&&(F=ae[m]),C=s("div",{className:B.dirButton,onClick:()=>p(m),children:[e("span",{className:B.icon_small,children:e(oe,{icon:m})}),F]},m),m==="scene"&&n.currentDir===""&&(E=!1)}E&&u.push(C)}return s(_e,{children:[n.currentDir!==""&&e("div",{className:B.currentDirShow,children:n.currentDir}),n.currentDir!==""&&s("div",{className:B.controlPanel,children:[e("div",{children:e(Ne,{theme:"outline",size:"24",fill:"#333",onClick:S,className:B.panelButton})}),s("div",{children:[e(ve,{theme:"outline",size:"24",fill:"#333",onClick:f,className:B.panelButton}),l&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u4E0A\u4F20\u6587\u4EF6"}),e("input",{id:"uploadFile",type:"file"}),e("div",{className:B.uploadButton,onClick:_,children:"\u4E0A\u4F20"})]})]}),s("div",{children:[e(xe,{theme:"outline",size:"24",fill:"#333",onClick:N,className:B.panelButton}),d&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"}),e("input",{id:"addDirInput"}),e("div",{className:B.uploadButton,onClick:v,children:"\u65B0\u5EFA"})]})]})]}),e("div",{}),e("div",{className:B.dirButtonContainer,children:u})]})},Ft="_main_1dzb8_1",wt="_addInput_1dzb8_12",At="_title_1dzb8_20",kt="_addButton_1dzb8_26";var G={main:Ft,addInput:wt,title:At,addButton:kt};const Dt=t=>{const c=()=>{const l={gameName:n.currentEditGame,sceneName:document.getElementById("addSceneName").value};A.post(`${n.domain}/api/editGame/addNewScene/`,l).then(h=>{t.added()}).catch(h=>{console.log(h)})};return s("div",{className:G.main,children:[s("div",{className:G.title,children:["\u573A\u666F\u540D\u79F0\uFF1A",e("input",{className:G.addInput,id:"addSceneName"})]}),e("div",{className:G.addButton,onClick:c,children:"\u65B0\u5EFA\u573A\u666F"})]})},It="_titleText_1j8ez_1",bt="_scene_1j8ez_11",yt="_newSceneButton_1j8ez_22",Pt="_sceneList_1j8ez_30";var V={titleText:It,scene:bt,newSceneButton:yt,sceneList:Pt};const J=()=>{n.currentEditScene!==""&&(n.sceneScrollTop[n.currentEditScene]=document.getElementById("currentSentenceList").scrollTop)},Lt=()=>{const[t,c]=r.exports.useState([]),[l,h]=r.exports.useState(!1),d=()=>{const v={dir:`/${n.currentEditGame}/game/scene`};A.post(`${n.domain}/api/editGame/getAssets/`,v).then(f=>{c(f.data)}).catch(f=>{console.log(f)})},o=()=>{d(),h(!l)};r.exports.useEffect(()=>{d()},[]);const g=p=>{n.currentOpendSceneEdit.includes(p)||n.currentOpendSceneEdit.push(p),J(),n.currentEditScene=p,a.set("updateEditor",!a.get("updateEditor"))},S=[];for(const p of t){let _=!1,v=p.split(".");v[v.length-1]==="json"&&(_=!0);const f=s("div",{className:V.scene,onClick:()=>g(p),children:[e(U,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),p]},p);_&&S.push(f)}return s("div",{style:{width:"100%"},children:[s("div",{className:V.newSceneButton,onClick:()=>{h(!l)},children:[e(X,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0",transform:"translate(0,2px)"}}),"\u65B0\u5EFA\u573A\u666F"]}),e("div",{children:l&&e(Dt,{added:o})}),e("div",{className:V.sceneList,children:S})]})},Tt=()=>{const t=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[c,l]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("refSideBar",c),a.connect("refSideBar",()=>{l(a.get("refSideBar"))},"refSideBarFunc")},[]);const h=[];for(const o of t){o===n.editorTag?I.optionMarker:I.optionMarkerOff;const g=e("div",{className:o===n.editorTag?I.tagButton+" "+I.tagButtonOn:I.tagButton,onClick:()=>{n.editorTag=o,a.set("refSideBar",!a.get("refSideBar"))},children:e("div",{children:o})},o);h.push(g)}let d;switch(n.editorTag){case"\u6E38\u620F\u914D\u7F6E":d=e(mt,{});break;case"\u7D20\u6750\u7BA1\u7406":d=e(Bt,{});break;case"\u573A\u666F\u7BA1\u7406":d=e(Lt,{});break}return s("aside",{className:I.aside,children:[e("div",{className:I.option,children:h}),e("div",{className:I.sideBarContent,children:d})]})},zt="_main_19sml_1";var Gt={main:zt};const Ot="_main_1vjf8_1",$t="_tag_1vjf8_7",Mt="_tagOpened_1vjf8_17",jt="_tagList_1vjf8_24",qt="_tagIcon_1vjf8_28",Ut="_closeIcon_1vjf8_33";var b={main:Ot,tag:$t,tagOpened:Mt,tagList:jt,tagIcon:qt,closeIcon:Ut};const Rt="_topButtonList_k9m8n_1",Vt="_topButton_k9m8n_1",Jt="_addSentencePanel_k9m8n_23",Wt="_addSentenceButton_k9m8n_32",Kt="_sentenceList_k9m8n_42",Ht="_sentence_k9m8n_42",Qt="_sentenceIn_k9m8n_1",Xt="_lineNumber_k9m8n_55",Yt="_sentenceMain_k9m8n_65";var x={topButtonList:Rt,topButton:Vt,addSentencePanel:Jt,addSentenceButton:Wt,sentenceList:Kt,sentence:Ht,sentenceIn:Qt,lineNumber:Xt,sentenceMain:Yt};const Zt=t=>{let c;switch(t){case"dialog":c={type:t,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":c={type:t,bg:"",noBg:!1,next:!1};break;case"bgm":c={type:t,bgm:"",noBgm:!1};break;case"changeScene":c={type:t,newScene:""};break;case"video":c={type:t,video:""};break;case"changeP":c={type:t,newP:"",next:!1,noP:!1,pos:""};break;case"choose":c={type:t,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break}return c},en="_sentence_tjlyp_1",tn="_dialog_input_tjlyp_7",nn="_singleOption_tjlyp_15",sn="_optionTitle_tjlyp_23",cn="_optionContent_tjlyp_31",an="_isolate_tjlyp_35",on="_sentenceButtonList_tjlyp_40",dn="_sentenceButton_tjlyp_40",ln="_sentenceIndexShow_tjlyp_60",rn="_barContainer_tjlyp_74",un="_mainEdit_tjlyp_84",mn="_topContainer_tjlyp_92";var i={sentence:en,dialog_input:tn,singleOption:nn,optionTitle:sn,optionContent:cn,isolate:an,sentenceButtonList:on,sentenceButton:dn,sentenceIndexShow:ln,barContainer:rn,mainEdit:un,topContainer:mn};const hn=t=>{n.currentSceneSentenceList.splice(t,1),a.set("writeScene",!a.get("writeScene"))},de=(t,c)=>{if(!(t===0&&c===-1||t===n.currentSceneSentenceList.length-1&&c===1)){{const l=n.currentSceneSentenceList[t];n.currentSceneSentenceList.splice(t,1),n.currentSceneSentenceList.splice(t+c,0,l)}a.set("writeScene",!a.get("writeScene"))}},le=t=>s("div",{className:x.addSentencePanel,children:[s("div",{className:x.addSentenceButton,onClick:()=>{w("dialog",t.index)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("changeP",t.index)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("bg",t.index)},children:[e(q,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("changeScene",t.index)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("choose",t.index)},children:[e(te,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("bgm",t.index)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("video",t.index)},children:[e($,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]}),P=t=>s("div",{className:i.sentenceButtonList,children:[s("div",{className:i.sentenceButton,onClick:()=>{hn(t.index)},children:[e(Ee,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),s("div",{onClick:()=>{de(t.index,-1)},className:i.sentenceButton,children:[e(Ce,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{de(t.index,1)},className:i.sentenceButton,children:[e(Be,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{t.data.setShowAddPre(!t.data.showAddPre)},className:i.sentenceButton,children:[e(ne,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",t.data.showAddPre&&e(le,{index:t.data.indexPre})]}),s("div",{onClick:()=>{t.data.setShowAddAfter(!t.data.showAddAfter)},className:i.sentenceButton,children:[e(ne,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",t.data.showAddAfter&&e(le,{index:t.data.indexAfter})]})]}),gn=t=>{const[c,l]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),o=t.index,g=t.index+1,S={showAddPre:c,setShowAddPre:l,showAddAfter:h,setShowAddAfter:d,indexPre:o,indexAfter:g};r.exports.useEffect(()=>{document.getElementById("speakerInput"+t.index).value=t.data.speaker,document.getElementById("contentInput"+t.index).value=t.data.content});const p=()=>{n.currentSceneSentenceList[t.index].speaker=document.getElementById("speakerInput"+t.index).value,n.currentSceneSentenceList[t.index].content=document.getElementById("contentInput"+t.index).value,a.set("writeScene",!a.get("writeScene"))},_=u=>{n.currentSceneSentenceList[t.index].ignoreSpeaker=u,a.set("writeScene",!a.get("writeScene"))},[v,f]=r.exports.useState(t.data.vocal),N=()=>u=>{n.currentSceneSentenceList[t.index].vocal=u,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u57FA\u672C\u5BF9\u8BDD"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:S})})]}),s("main",{className:i.mainEdit,children:[s("div",{className:i.singleOption,children:["\u89D2\u8272\uFF1A",e("input",{className:i.dialog_input,onBlur:p,id:"speakerInput"+t.index}),e("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),s("div",{className:i.singleOption,children:["\u5BF9\u8BDD\uFF1A",e("input",{className:i.dialog_input,onBlur:p,id:"contentInput"+t.index})]}),s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u65C1\u767D\u6A21\u5F0F"}),s("span",{className:i.optionContent,children:[e(L,{size:"small",id:"dialog_pbms",checked:t.data.ignoreSpeaker,onChange:_}),"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"]}),e("div",{className:i.optionTitle,children:"\u914D\u97F3\u6587\u4EF6"}),e(D,{setShow:f,id:"vocalPicker",dir:"vocal",set:N()}),e("span",{className:i.optionContent,children:v})]})]})]},t.index+"dialog")},pn=t=>{const[c,l]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),o=t.index,g=t.index+1,S={showAddPre:c,setShowAddPre:l,showAddAfter:h,setShowAddAfter:d,indexPre:o,indexAfter:g};r.exports.useEffect(()=>{});const p=u=>{n.currentSceneSentenceList[t.index].noBg=u,a.set("writeScene",!a.get("writeScene"))},_=u=>{n.currentSceneSentenceList[t.index].next=u,a.set("writeScene",!a.get("writeScene"))},[v,f]=r.exports.useState(t.data.bg),N=()=>u=>{n.currentSceneSentenceList[t.index].bg=u,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u66F4\u6539\u80CC\u666F"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:S})})]}),s("main",{className:i.mainEdit,children:[s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u80CC\u666F"}),s("span",{className:i.optionContent,children:[e(L,{size:"small",checked:t.data.noBg,id:"bg_none"+t.index,onChange:p}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"]}),e("span",{className:i.optionTitle,children:"\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"bg_next"+t.index,checked:t.data.next,onChange:_})})]}),s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u80CC\u666F\u6587\u4EF6"}),e(D,{setShow:f,id:"bgPicker",dir:"background",set:N()}),e("span",{className:i.optionContent,children:v})]})]})]},t.index+"bg")},Sn=t=>{const[c,l]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),o=t.index,g=t.index+1,S={showAddPre:c,setShowAddPre:l,showAddAfter:h,setShowAddAfter:d,indexPre:o,indexAfter:g};r.exports.useEffect(()=>{});const p=N=>{n.currentSceneSentenceList[t.index].noBgm=N,a.set("writeScene",!a.get("writeScene"))},[_,v]=r.exports.useState(t.data.bgm),f=()=>N=>{n.currentSceneSentenceList[t.index].bgm=N,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u66F4\u6539\u97F3\u4E50"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:S})})]}),s("main",{className:i.mainEdit,children:[s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u80CC\u666F\u97F3\u4E50"}),s("span",{className:i.optionContent,children:[e(L,{size:"small",id:"bgm_none"+t.index,checked:t.data.noBgm,onChange:p}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"]})]}),s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u80CC\u666F\u97F3\u4E50\u6587\u4EF6"}),e(D,{setShow:v,id:"bgmPicker",dir:"bgm",set:f()}),e("span",{className:i.optionContent,children:_})]})]})]},t.index+"bgm")},fn=t=>{const[c,l]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),o=t.index,g=t.index+1,S={showAddPre:c,setShowAddPre:l,showAddAfter:h,setShowAddAfter:d,indexPre:o,indexAfter:g};r.exports.useEffect(()=>{});const[p,_]=r.exports.useState(t.data.newScene),v=()=>f=>{n.currentSceneSentenceList[t.index].newScene=f,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5207\u6362\u573A\u666F"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:S})})]}),e("main",{className:i.mainEdit,children:s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u65B0\u573A\u666F"}),e(D,{setShow:_,id:"scenePicker",dir:"scene",set:v()}),e("span",{className:i.optionContent,children:p})]})})]},t.index+"scene")},_n=t=>{const[c,l]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),o=t.index,g=t.index+1,S={showAddPre:c,setShowAddPre:l,showAddAfter:h,setShowAddAfter:d,indexPre:o,indexAfter:g};r.exports.useEffect(()=>{});const[p,_]=r.exports.useState(t.data.video),v=()=>f=>{n.currentSceneSentenceList[t.index].video=f,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u64AD\u653E\u89C6\u9891"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:S})})]}),e("main",{className:i.mainEdit,children:s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u89C6\u9891\u6587\u4EF6"}),e(D,{setShow:_,id:"videoPicker",dir:"video",set:v()}),e("span",{className:i.optionContent,children:p})]})})]},t.index+"scene")},{Option:W}=se,Nn=t=>{const[c,l]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),o=t.index,g=t.index+1,S={showAddPre:c,setShowAddPre:l,showAddAfter:h,setShowAddAfter:d,indexPre:o,indexAfter:g};r.exports.useEffect(()=>{});const p=m=>{n.currentSceneSentenceList[t.index].noP=m,a.set("writeScene",!a.get("writeScene"))},_=m=>{n.currentSceneSentenceList[t.index].next=m,a.set("writeScene",!a.get("writeScene"))},[v,f]=r.exports.useState(t.data.newP),N=()=>m=>{n.currentSceneSentenceList[t.index].newP=m,a.set("writeScene",!a.get("writeScene"))},u=m=>{n.currentSceneSentenceList[t.index].pos=m,a.set("writeScene",!a.get("writeScene"))};return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5207\u6362\u7ACB\u7ED8"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:S})})]}),s("main",{className:i.mainEdit,children:[s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u7ACB\u7ED8"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"p_none",checked:t.data.noP,onChange:p})}),e("span",{className:i.optionContent,children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"}),e("span",{className:i.optionTitle,children:"\u7ACB\u7ED8\u4F4D\u7F6E"}),s(se,{size:"small",defaultValue:t.data.pos,style:{width:120},onChange:u,children:[e(W,{value:"left",children:"\u5DE6"}),e(W,{value:"",children:"\u4E2D"}),e(W,{value:"right",children:"\u53F3"})]}),e("span",{className:i.optionContent,children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"}),e("span",{className:i.optionTitle,children:"\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"p_none",checked:t.data.next,onChange:_})})]}),s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u7ACB\u7ED8\u6587\u4EF6"}),e(D,{setShow:f,id:"pPicker",dir:"figure",set:N()}),e("span",{className:i.optionContent,children:v})]})]})]},t.index+"dialog")},vn=t=>{const[c,l]=r.exports.useState(!1),[h,d]=r.exports.useState(!1),o=t.index,g=t.index+1,S={showAddPre:c,setShowAddPre:l,showAddAfter:h,setShowAddAfter:d,indexPre:o,indexAfter:g};r.exports.useEffect(()=>{for(let u=0;u<t.data.chooseItem.length;u++)document.getElementById("chooseInput"+t.index+"itemIndex"+u).value=t.data.chooseItem[u].text});const p=()=>{n.currentSceneSentenceList[t.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),a.set("writeScene",!a.get("writeScene"))},_=u=>{const m=parseInt(u.split("Index")[1]);console.log(m),n.currentSceneSentenceList[t.index].chooseItem[m].text=document.getElementById(u).value,a.set("writeScene",!a.get("writeScene"))},v=u=>m=>{n.currentSceneSentenceList[t.index].chooseItem[u].scene=m,a.set("writeScene",!a.get("writeScene"))};let f=[],N=0;for(const u of t.data.chooseItem){const m="chooseInput"+t.index+"itemIndex"+N;let C=s("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5206\u652F\u540D\u79F0"}),e("input",{className:i.dialog_input,style:{width:"200px"},onBlur:()=>{_(m)},id:m}),e("span",{className:i.optionContent,children:e(Fe,{theme:"outline",size:"24",fill:"#333"})}),e("span",{className:i.optionTitle,children:"\u8DF3\u8F6C\u7684\u573A\u666F"}),e(D,{id:"scenePicker",dir:"scene",set:v(N)}),e("span",{className:i.optionContent,children:u.scene})]},N);f.push(C),N++}return s("div",{className:i.sentence,children:[s("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5206\u652F\u9009\u62E9"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:S})})]}),s("main",{className:i.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:p,className:i.sentenceButton,children:[e(we,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),f]})]},t.index+"choose")},xn=(t,c)=>{let l;switch(t.type){case"dialog":l=e(gn,{data:t,index:c},c);break;case"bg":l=e(pn,{data:t,index:c},c);break;case"bgm":l=e(Sn,{data:t,index:c},c);break;case"changeScene":l=e(fn,{data:t,index:c},c);break;case"video":l=e(_n,{data:t,index:c},c);break;case"changeP":l=e(Nn,{data:t,index:c},c);break;case"choose":l=e(vn,{data:t,index:c},c);break}return l};const En=t=>{const[c,l]=r.exports.useState(!0),[h,d]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("updateScene",c),a.connect("updateScene",()=>{l(a.get("updateScene"))},"updateSceneFunc"),a.set("refScene",!0),a.connect("refScene",()=>{K()},"refSceneFunc"),a.get("writeScene")===void 0&&a.set("writeScene",!0),a.connect("writeScene",()=>{H()},"writeSceneFunc"),K(),n.sceneScrollTop.hasOwnProperty(n.currentEditScene)&&setTimeout(()=>{document.getElementById("currentSentenceList").scrollTop=n.sceneScrollTop[n.currentEditScene]},0)},[]);let o=[];const g=JSON.parse(JSON.stringify(n.currentSceneSentenceList));for(let p=0;p<g.length;p++){const _=g[p],v=xn(_,p),f=s("div",{className:x.sentence,children:[e("div",{className:x.lineNumber,children:p+1}),e("div",{className:x.sentenceMain,children:v})]},"sentence"+p);o.push(f)}const S=s("div",{className:x.addSentencePanel,children:[s("div",{className:x.addSentenceButton,onClick:()=>{w("dialog"),d(!1)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("changeP"),d(!1)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("bg"),d(!1)},children:[e(q,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("changeScene"),d(!1)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("choose"),d(!1)},children:[e(te,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("bgm"),d(!1)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:x.addSentenceButton,onClick:()=>{w("video"),d(!1)},children:[e($,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]});return s("div",{children:[s("div",{className:x.topButtonList,children:[e("div",{className:x.topButton,onClick:H,children:"\u4FDD\u5B58\u573A\u666F"}),e("div",{className:x.topButton,onClick:()=>{d(!h)},children:"\u6DFB\u52A0\u8BED\u53E5"}),e("div",{children:h&&S})]}),e("div",{className:x.sentenceList,id:"currentSentenceList",children:o})]})};function K(){let t=n.currentEditScene;if(t==="")return;const c=`${n.domain}/Games/${n.currentEditGame}/game/scene/${t}`;A.get(c).then(l=>{n.currentSceneSentenceList=l.data,a.set("updateScene",!a.get("updateScene"))}).catch(l=>console.log(l))}function w(t,c){const l=Zt(t);c!==void 0?n.currentSceneSentenceList.splice(c,0,l):n.currentSceneSentenceList.push(l),H()}function H(){const t=`${n.domain}/api/editGame/editScene/`,c={gameName:n.currentEditGame,sceneName:n.currentEditScene,sceneData:n.currentSceneSentenceList};A.post(t,c).then(l=>{K()}).catch(l=>console.log(l))}const Cn=()=>{const[t,c]=r.exports.useState(!1);r.exports.useEffect(()=>{a.set("updateEditor",t),a.connect("updateEditor",()=>{c(a.get("updateEditor")),a.set("refScene",!a.get("refScene"))},"updateEditorFunc")},[]);const l=o=>{J(),n.currentEditScene=o,a.set("updateEditor",!a.get("updateEditor")),a.set("refScene",!a.get("refScene"))},h=o=>{J();const g=n.currentOpendSceneEdit.indexOf(o);n.currentOpendSceneEdit.splice(g,1);const S=n.currentOpendSceneEdit.length===0;o===n.currentEditScene&&(S?n.currentEditScene="":n.currentOpendSceneEdit.length<=g?n.currentEditScene=n.currentOpendSceneEdit[n.currentOpendSceneEdit.length-1]:n.currentEditScene=n.currentOpendSceneEdit[g]),a.set("updateEditor",!a.get("updateEditor"))},d=[];for(const o of n.currentOpendSceneEdit){let g;o===n.currentEditScene?g=s("div",{className:b.tagOpened,children:[e(U,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),o,e(ie,{theme:"outline",size:"20",fill:"#333",className:b.closeIcon,onClick:()=>{h(o)}})]},o):g=s("div",{className:b.tag,onClick:()=>{l(o)},children:[e(U,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),o,e(ie,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon,onClick:S=>{S.preventDefault(),S.stopPropagation(),h(o)}})]},o),d.push(g)}return s("div",{className:b.main,children:[e("div",{className:b.tagList,children:d}),e("div",{children:n.currentEditScene!==""&&e(En,{sceneName:n.currentEditScene},n.currentEditScene)})]})},Bn=()=>{const[t,c]=r.exports.useState(!0);return r.exports.useEffect(()=>{a.set("updateEditor",!0),a.connect("updateEditor",()=>{c(a.get("updateEditor"))},"ForceUpdateEditor")},[]),s("div",{children:[e(Je,{}),s("main",{className:Gt.main,children:[e(Tt,{}),e(Cn,{})]})]})};function Fn(){const[t,c]=r.exports.useState(!0);return r.exports.useEffect(()=>{a.set("isManageMent",!0),a.connect("isManagement",()=>{c(a.get("isManagement"))},"setIsManagementFunc")},[]),s("div",{className:"App",children:[t&&e(qe,{}),!t&&e(Bn,{})]})}Ae.render(e(ke.StrictMode,{children:e(Fn,{})}),document.getElementById("root"));
