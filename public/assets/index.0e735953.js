import{f as le,r,a as A,j as n,b as e,G as re,A as Q,L as ue,F as X,N as me,E as he,P as ge,D as fe,V as pe,c as $,d as M,e as j,g as U,R as Se,U as _e,h as Ne,i as R,C as Y,k as Z,S as ee,l as xe,m as ve,n as Ce,o as te,p as L,q as ne,s as Ee,t as Be,u as se,v as we,w as Fe}from"./vendor.3f6af7d1.js";const Ae=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))g(d);new MutationObserver(d=>{for(const o of d)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&g(h)}).observe(document,{childList:!0,subtree:!0});function l(d){const o={};return d.integrity&&(o.integrity=d.integrity),d.referrerpolicy&&(o.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?o.credentials="include":d.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function g(d){if(d.ep)return;d.ep=!0;const o=l(d);fetch(d.href,o)}};Ae();const ke="_nav_11k4b_2",be="_title_11k4b_12",De="_subTitle_11k4b_20",Ie="_main_11k4b_29",ye="_gameList_11k4b_33",Pe="_singleGameEntryButton_11k4b_39",Le="_buttonIcon_11k4b_54",ze="_addIcon_11k4b_58",Te="_createPanel_11k4b_65",Ge="_createPanelTitle_11k4b_75",Oe="_createPanelInput_11k4b_81",$e="_createButton_11k4b_87";var k={nav:ke,title:be,subTitle:De,main:Ie,gameList:ye,singleGameEntryButton:Pe,buttonIcon:Le,addIcon:ze,createPanel:Te,createPanelTitle:Ge,createPanelInput:Oe,createButton:$e};const c=new le;c.set("updateEditor",!0);const ie={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[]},s=JSON.parse(JSON.stringify(ie)),Me=()=>{const[t,a]=r.exports.useState(!0),[l,g]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refManagement",t),c.connect("refManagement",()=>{a(c.get("refManagement"))},"refManagementFunc"),d()},[]);const d=()=>{A.get(s.domain+"/api/manageGame/gameList").then(p=>{s.gameList=p.data,c.set("refManagement",!c.get("refManagement"))}).catch(p=>{console.log(p)})};let o=[];for(const p of s.gameList){const f=n("div",{className:k.singleGameEntryButton,onClick:()=>{for(const _ in s)s[_]=ie[_];s.currentEditGame=p,c.set("isManagement",!1)},children:[e(re,{theme:"outline",size:"24",fill:"#333",className:k.buttonIcon}),p]},p);o.push(f)}const h=p=>{const f=`${s.domain}/api/manageGame/createGame/${p}`;A.get(f).then(_=>{g(!1),d()})};return n("div",{children:[e("header",{children:e("nav",{children:e("div",{className:k.nav,children:e("div",{className:k.title,children:"WebGAL ORIGINE"})})})}),n("main",{className:k.main,children:[n("div",{className:k.subTitle,children:["\u6E38\u620F\u5217\u8868",n("span",{onClick:()=>g(!l),className:k.addIcon,children:[e(Q,{theme:"outline",size:"18",fill:"#8E354A"})," \u65B0\u5EFA\u6E38\u620F"]}),l&&n("div",{className:k.createPanel,children:[e("div",{className:k.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),n("div",{children:["\u6E38\u620F\u540D\u79F0\uFF1A",e("input",{id:"createInput",className:k.createPanelInput})]}),e("div",{style:{textAlign:"center"},children:e("div",{onClick:()=>h(document.getElementById("createInput").value),className:k.createButton,children:"\u521B\u5EFA"})})]})]}),e("div",{className:k.gameList,children:o})]})]})},je="_nav_1x6hc_1",Ue="_title_1x6hc_11",Re="_titleIcon_1x6hc_19";var V={nav:je,title:Ue,titleIcon:Re};const Ve=()=>n("div",{className:V.nav,children:[e(ue,{theme:"filled",size:"30",fill:"#333",className:V.titleIcon,onClick:()=>{c.set("isManagement",!0)}}),e("div",{className:V.title,children:"WebGAL ORIGINE"})]}),qe="_aside_m7wa8_1",Je="_option_m7wa8_9",We="_optionMarker_m7wa8_18",Ke="_optionMarkerOff_m7wa8_26",He="_chooseItem_m7wa8_34",Qe="_chooseTitle_m7wa8_45",Xe="_chooseDescription_m7wa8_50",Ye="_tagButton_m7wa8_55",Ze="_tagButtonOn_m7wa8_63",et="_sideBarContent_m7wa8_71";var I={aside:qe,option:Je,optionMarker:We,optionMarkerOff:Ke,chooseItem:He,chooseTitle:Qe,chooseDescription:Xe,tagButton:Ye,tagButtonOn:Ze,sideBarContent:et};const tt="_title_9he3e_1",nt="_previewGameButton_9he3e_10",st="_gameNameInput_9he3e_20";var z={title:tt,previewGameButton:nt,gameNameInput:st};const it="_choosed_imeie_1",at="_chooseBox_imeie_7",ct="_chooseIcon_imeie_11",ot="_fileList_imeie_26",dt="_singleFile_imeie_38",lt="_fileIcon_imeie_49";var y={choosed:it,chooseBox:at,chooseIcon:ct,fileList:ot,singleFile:dt,fileIcon:lt};const b=t=>{const[a,l]=r.exports.useState(!1),[g,d]=r.exports.useState(t.dir),[o,h]=r.exports.useState([]),[p,f]=r.exports.useState(""),_=u=>{const E={dir:`/${s.currentEditGame}/game/${u}`};A.post(`${s.domain}/api/editGame/getAssets/`,E).then(C=>{h(C.data)}).catch(C=>{console.log(C)})},x=u=>{let m=u.split("/");u="";let E=0;for(const C of m)C!==t.dir&&(E!==0&&(u=u+"/"),E++,u=u+C);return u},S=u=>{let m=g+"/"+u;m=x(m),t.set(m),t.hasOwnProperty("setShow")&&t.setShow(m)};r.exports.useEffect(()=>{_(g)},[]);let N=[];for(const u of o){let m=!0,E=!0;u.match(/\.json/)&&(E=!1),u.match(/\./)&&(m=!1);let C=e("div",{children:""});m?C=n("div",{className:y.singleFile,onClick:()=>{const w=g+"/"+u;d(w),_(w)},children:[e(X,{theme:"outline",size:"18",fill:"#333",className:y.fileIcon}),u]},u):C=n("div",{className:y.singleFile,onClick:()=>{f(x(g+"/"+u)),S(u),l(!a)},children:[e(me,{theme:"outline",size:"18",fill:"#333",className:y.fileIcon}),u]},u),E&&N.push(C)}return n("div",{children:[e("div",{className:y.chooseBox,children:n("div",{className:y.chooseIcon,onClick:()=>{a===!1&&(d(t.dir),f(""),_(t.dir)),l(!a)},children:[e(he,{theme:"outline",size:"16",fill:"#333"})," \u9009\u62E9\u6587\u4EF6"]})}),e("div",{style:{position:"relative"},children:a&&e("div",{className:y.fileList,children:N})})]})},rt=()=>{r.exports.useState(!1);const[t,a]=r.exports.useState(""),[l,g]=r.exports.useState(""),[d,o]=r.exports.useState(""),h=()=>{A.get(`${s.domain}/Games/${s.currentEditGame}/game/gameConfig.json`).then(S=>{let N=S.data;s.currentGameConfig=S.data,document.getElementById("gameNameInput").value=N.Game_name,a(N.Title_bgm),g(N.Title_img),o(N.Loading_img)})},p=()=>{s.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,x()},f=(S,N)=>{s.currentGameConfig[S]=N,x()},_=S=>N=>{f(S,N)},x=()=>{let S={currentEditGame:s.currentEditGame,config:s.currentGameConfig};A.post(`${s.domain}/api/manageGame/config`,S).then(N=>{})};return r.exports.useEffect(()=>{h()},[]),n("div",{children:[e("div",{children:e("a",{style:{color:"black",textDecoration:"none"},href:`${s.domain}/Games/${s.currentEditGame}`,target:"_blank",children:n("div",{className:z.previewGameButton,children:[e(ge,{theme:"outline",size:"28",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,5px)"}}),"\u9884\u89C8\u6E38\u620F"]})})}),n("div",{children:[e("div",{className:z.title,children:"\u6E38\u620F\u540D\u79F0"}),e("div",{children:e("input",{onBlur:p,id:"gameNameInput",className:z.gameNameInput})})]}),n("div",{children:[e("div",{className:z.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),n("div",{children:[t,e(b,{setShow:a,id:"bgmPicker",dir:"bgm",set:_("Title_bgm")})]})]}),n("div",{children:[e("div",{className:z.title,children:"\u6807\u9898\u80CC\u666F"}),n("div",{children:[l,e(b,{setShow:g,id:"bgPicker",dir:"background",set:_("Title_img")})]})]}),n("div",{children:[e("div",{className:z.title,children:"\u52A0\u8F7D\u56FE"}),n("div",{children:[d,e(b,{setShow:o,id:"loadImgPicker",dir:"background",set:_("Loading_img")})]})]})]})},ut="_dirButtonContainer_1yjba_2",mt="_icon_small_1yjba_7",ht="_controlPanel_1yjba_14",gt="_upload_1yjba_18",ft="_dirButton_1yjba_2",pt="_fileElement_1yjba_39",St="_title_1yjba_56",_t="_currentDirShow_1yjba_66",Nt="_panelButton_1yjba_76",xt="_uploadTitle_1yjba_88",vt="_uploadButton_1yjba_96";var B={dirButtonContainer:ut,icon_small:mt,controlPanel:ht,upload:gt,dirButton:ft,fileElement:pt,title:St,currentDirShow:_t,panelButton:Nt,uploadTitle:xt,uploadButton:vt};const ae={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},ce=t=>{let a=e(X,{theme:"outline",size:"22",fill:"#333"});switch(t.icon){case"background":a=e(U,{theme:"outline",size:"22",fill:"#333"});break;case"bgm":a=e(j,{theme:"outline",size:"22",fill:"#333"});break;case"figure":a=e(M,{theme:"outline",size:"22",fill:"#333"});break;case"video":a=e($,{theme:"outline",size:"22",fill:"#333"});break;case"vocal":a=e(pe,{theme:"outline",size:"22",fill:"#333"});break;case"file":a=e(fe,{theme:"outline",size:"22",fill:"#333"})}return a},Ct=()=>{const[t,a]=r.exports.useState(!0),[l,g]=r.exports.useState(!1),[d,o]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refAssetsManagement",t),c.connect("refAssetsManagement",()=>{a(c.get("refAssetsManagement"))},"refAssetsManagement"),h()},[]);const h=()=>{const m=s.currentEditGame,E=s.currentDir,C={dir:`/${m}/game/${E}`};A.post(`${s.domain}/api/editGame/getAssets/`,C).then(w=>{s.currentDirContent=w.data,c.set("refAssetsManagement",!c.get("refAssetsManagement"))}).catch(w=>{console.log(w)})},p=()=>{if(s.currentDir==="")return;let m=s.currentDir.split("/");m.pop(),s.currentDir=m.reduce((E,C)=>""+E+"/"+C),h()},f=m=>{s.currentDir=s.currentDir+`/${m}`,h()},_=()=>{const m=s.currentEditGame,E=s.currentDir,C=`/${m}/game/${E}`;let w=new FormData;w.append("dir",C);const O=document.getElementById("uploadFile").files[0];let T=document.getElementById("uploadFile").value;w.append("file",O,T),A.post(`${s.domain}/api/editGame/addAsset/`,w,{headers:{"Content-Type":"multipart/form-data"}}).then(H=>{g(!1),h()}).catch(H=>{console.log(H)})},x=()=>{const m=s.currentEditGame,E=s.currentDir,C=`/${m}/game/${E}`,w=document.getElementById("addDirInput").value,O={current:C,Name:w};A.post(`${s.domain}/api/editGame/mkdir/`,O).then(T=>{o(!1),h()}).catch(T=>{console.log(T)})},S=()=>{g(!l)},N=()=>{o(!d)},u=[];for(const m of s.currentDirContent){let E="",C=!0;if(m.match(/\./))s.currentDir===""&&(C=!1),E=n("div",{className:B.fileElement,children:[e("span",{className:B.icon_small,children:e(ce,{icon:"file"})}),m]},m);else{let w=m;s.currentDir===""&&ae.hasOwnProperty(m)&&(w=ae[m]),E=n("div",{className:B.dirButton,onClick:()=>f(m),children:[e("span",{className:B.icon_small,children:e(ce,{icon:m})}),w]},m),m==="scene"&&s.currentDir===""&&(C=!1)}C&&u.push(E)}return n("div",{children:[s.currentDir!==""&&e("div",{className:B.currentDirShow,children:s.currentDir}),s.currentDir!==""&&n("div",{className:B.controlPanel,children:[e("div",{children:e(Se,{theme:"outline",size:"24",fill:"#333",onClick:p,className:B.panelButton})}),n("div",{children:[e(_e,{theme:"outline",size:"24",fill:"#333",onClick:S,className:B.panelButton}),l&&n("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u4E0A\u4F20\u6587\u4EF6"}),e("input",{id:"uploadFile",type:"file"}),e("div",{className:B.uploadButton,onClick:_,children:"\u4E0A\u4F20"})]})]}),n("div",{children:[e(Ne,{theme:"outline",size:"24",fill:"#333",onClick:N,className:B.panelButton}),d&&n("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"}),e("input",{id:"addDirInput"}),e("div",{className:B.uploadButton,onClick:x,children:"\u65B0\u5EFA"})]})]})]}),e("div",{}),e("div",{className:B.dirButtonContainer,children:u})]})},Et="_main_1dzb8_1",Bt="_addInput_1dzb8_12",wt="_title_1dzb8_20",Ft="_addButton_1dzb8_26";var G={main:Et,addInput:Bt,title:wt,addButton:Ft};const At=t=>{const a=()=>{const l={gameName:s.currentEditGame,sceneName:document.getElementById("addSceneName").value};A.post(`${s.domain}/api/editGame/addNewScene/`,l).then(g=>{t.added()}).catch(g=>{console.log(g)})};return n("div",{className:G.main,children:[n("div",{className:G.title,children:["\u573A\u666F\u540D\u79F0\uFF1A",e("input",{className:G.addInput,id:"addSceneName"})]}),e("div",{className:G.addButton,onClick:a,children:"\u65B0\u5EFA\u573A\u666F"})]})},kt="_titleText_17hh2_1",bt="_scene_17hh2_11",Dt="_newSceneButton_17hh2_22",It="_sceneList_17hh2_30";var q={titleText:kt,scene:bt,newSceneButton:Dt,sceneList:It};const yt=()=>{const[t,a]=r.exports.useState([]),[l,g]=r.exports.useState(!1),d=()=>{const x={dir:`/${s.currentEditGame}/game/scene`};A.post(`${s.domain}/api/editGame/getAssets/`,x).then(S=>{a(S.data)}).catch(S=>{console.log(S)})},o=()=>{d(),g(!l)};r.exports.useEffect(()=>{d()},[]);const h=f=>{s.currentOpendSceneEdit.includes(f)||s.currentOpendSceneEdit.push(f),s.currentEditScene=f,c.set("updateEditor",!c.get("updateEditor"))},p=[];for(const f of t){let _=!1,x=f.split(".");x[x.length-1]==="json"&&(_=!0);const S=n("div",{className:q.scene,onClick:()=>h(f),children:[e(R,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),f]},f);_&&p.push(S)}return n("div",{children:[n("div",{className:q.newSceneButton,onClick:()=>{g(!l)},children:[e(Q,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0",transform:"translate(0,2px)"}}),"\u65B0\u5EFA\u573A\u666F"]}),e("div",{children:l&&e(At,{added:o})}),e("div",{className:q.sceneList,children:p})]})},Pt=()=>{const t=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[a,l]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refSideBar",a),c.connect("refSideBar",()=>{l(c.get("refSideBar"))},"refSideBarFunc")},[]);const g=[];for(const o of t){let h;o===s.editorTag?h=e("div",{className:I.optionMarker}):h=e("div",{className:I.optionMarkerOff});const p=n("div",{className:o===s.editorTag?I.tagButtonOn:I.tagButton,onClick:()=>{s.editorTag=o,c.set("refSideBar",!c.get("refSideBar"))},children:[e("div",{children:o}),h]},o);g.push(p)}let d;switch(s.editorTag){case"\u6E38\u620F\u914D\u7F6E":d=e(rt,{});break;case"\u7D20\u6750\u7BA1\u7406":d=e(Ct,{});break;case"\u573A\u666F\u7BA1\u7406":d=e(yt,{});break}return n("aside",{className:I.aside,children:[e("div",{className:I.option,children:g}),e("div",{className:I.sideBarContent,children:d})]})},Lt="_main_19sml_1";var zt={main:Lt};const Tt="_main_lvf75_1",Gt="_tag_lvf75_7",Ot="_tagOpened_lvf75_17",$t="_tagList_lvf75_24",Mt="_tagIcon_lvf75_28";var D={main:Tt,tag:Gt,tagOpened:Ot,tagList:$t,tagIcon:Mt};const jt="_topButtonList_m44x1_1",Ut="_topButton_m44x1_1",Rt="_addSentencePanel_m44x1_21",Vt="_addSentenceButton_m44x1_30",qt="_sentenceList_m44x1_40",Jt="_sentence_m44x1_40",Wt="_sentenceIn_m44x1_1",Kt="_lineNumber_m44x1_52",Ht="_sentenceMain_m44x1_60";var v={topButtonList:jt,topButton:Ut,addSentencePanel:Rt,addSentenceButton:Vt,sentenceList:qt,sentence:Jt,sentenceIn:Wt,lineNumber:Kt,sentenceMain:Ht};const Qt=t=>{let a;switch(t){case"dialog":a={type:t,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":a={type:t,bg:"",noBg:!1,next:!1};break;case"bgm":a={type:t,bgm:"",noBgm:!1};break;case"changeScene":a={type:t,newScene:""};break;case"video":a={type:t,video:""};break;case"changeP":a={type:t,newP:"",next:!1,noP:!1,pos:""};break;case"choose":a={type:t,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break}return a},Xt="_sentence_1hcz0_1",Yt="_dialog_input_1hcz0_7",Zt="_singleOption_1hcz0_15",en="_optionTitle_1hcz0_23",tn="_optionContent_1hcz0_31",nn="_isolate_1hcz0_35",sn="_sentenceButtonList_1hcz0_40",an="_sentenceButton_1hcz0_40",cn="_sentenceIndexShow_1hcz0_58",on="_barContainer_1hcz0_70",dn="_mainEdit_1hcz0_79",ln="_topContainer_1hcz0_88";var i={sentence:Xt,dialog_input:Yt,singleOption:Zt,optionTitle:en,optionContent:tn,isolate:nn,sentenceButtonList:sn,sentenceButton:an,sentenceIndexShow:cn,barContainer:on,mainEdit:dn,topContainer:ln};const rn=t=>{s.currentSceneSentenceList.splice(t,1),c.set("writeScene",!c.get("writeScene"))},oe=(t,a)=>{if(!(t===0&&a===-1||t===s.currentSceneSentenceList.length-1&&a===1)){{const l=s.currentSceneSentenceList[t];s.currentSceneSentenceList.splice(t,1),s.currentSceneSentenceList.splice(t+a,0,l)}c.set("writeScene",!c.get("writeScene"))}},de=t=>n("div",{className:v.addSentencePanel,children:[n("div",{className:v.addSentenceButton,onClick:()=>{F("dialog",t.index)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("changeP",t.index)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("bg",t.index)},children:[e(U,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("changeScene",t.index)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("choose",t.index)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("bgm",t.index)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("video",t.index)},children:[e($,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]}),P=t=>n("div",{className:i.sentenceButtonList,children:[n("div",{className:i.sentenceButton,onClick:()=>{rn(t.index)},children:[e(xe,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),n("div",{onClick:()=>{oe(t.index,-1)},className:i.sentenceButton,children:[e(ve,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),n("div",{onClick:()=>{oe(t.index,1)},className:i.sentenceButton,children:[e(Ce,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),n("div",{onClick:()=>{t.data.setShowAddPre(!t.data.showAddPre)},className:i.sentenceButton,children:[e(te,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",t.data.showAddPre&&e(de,{index:t.data.indexPre})]}),n("div",{onClick:()=>{t.data.setShowAddAfter(!t.data.showAddAfter)},className:i.sentenceButton,children:[e(te,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",t.data.showAddAfter&&e(de,{index:t.data.indexAfter})]})]}),un=t=>{const[a,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,p={showAddPre:a,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{document.getElementById("speakerInput"+t.index).value=t.data.speaker,document.getElementById("contentInput"+t.index).value=t.data.content});const f=()=>{s.currentSceneSentenceList[t.index].speaker=document.getElementById("speakerInput"+t.index).value,s.currentSceneSentenceList[t.index].content=document.getElementById("contentInput"+t.index).value,c.set("writeScene",!c.get("writeScene"))},_=u=>{s.currentSceneSentenceList[t.index].ignoreSpeaker=u,c.set("writeScene",!c.get("writeScene"))},[x,S]=r.exports.useState(t.data.vocal),N=()=>u=>{s.currentSceneSentenceList[t.index].vocal=u,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u57FA\u672C\u5BF9\u8BDD"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:p})})]}),n("main",{className:i.mainEdit,children:[n("div",{className:i.singleOption,children:["\u89D2\u8272\uFF1A",e("input",{className:i.dialog_input,onBlur:f,id:"speakerInput"+t.index}),e("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),n("div",{className:i.singleOption,children:["\u5BF9\u8BDD\uFF1A",e("input",{className:i.dialog_input,onBlur:f,id:"contentInput"+t.index})]}),n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u65C1\u767D\u6A21\u5F0F"}),n("span",{className:i.optionContent,children:[e(L,{size:"small",id:"dialog_pbms",checked:t.data.ignoreSpeaker,onChange:_}),"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"]}),e("div",{className:i.optionTitle,children:"\u914D\u97F3\u6587\u4EF6"}),e(b,{setShow:S,id:"vocalPicker",dir:"vocal",set:N()}),e("span",{className:i.optionContent,children:x})]})]})]},t.index+"dialog")},mn=t=>{const[a,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,p={showAddPre:a,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const f=u=>{s.currentSceneSentenceList[t.index].noBg=u,c.set("writeScene",!c.get("writeScene"))},_=u=>{s.currentSceneSentenceList[t.index].next=u,c.set("writeScene",!c.get("writeScene"))},[x,S]=r.exports.useState(t.data.bg),N=()=>u=>{s.currentSceneSentenceList[t.index].bg=u,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u66F4\u6539\u80CC\u666F"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:p})})]}),n("main",{className:i.mainEdit,children:[n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u80CC\u666F"}),n("span",{className:i.optionContent,children:[e(L,{size:"small",checked:t.data.noBg,id:"bg_none"+t.index,onChange:f}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"]}),e("span",{className:i.optionTitle,children:"\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"bg_next"+t.index,checked:t.data.next,onChange:_})})]}),n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u80CC\u666F\u6587\u4EF6"}),e(b,{setShow:S,id:"bgPicker",dir:"background",set:N()}),e("span",{className:i.optionContent,children:x})]})]})]},t.index+"bg")},hn=t=>{const[a,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,p={showAddPre:a,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const f=N=>{s.currentSceneSentenceList[t.index].noBgm=N,c.set("writeScene",!c.get("writeScene"))},[_,x]=r.exports.useState(t.data.bgm),S=()=>N=>{s.currentSceneSentenceList[t.index].bgm=N,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u66F4\u6539\u97F3\u4E50"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:p})})]}),n("main",{className:i.mainEdit,children:[n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u80CC\u666F\u97F3\u4E50"}),n("span",{className:i.optionContent,children:[e(L,{size:"small",id:"bgm_none"+t.index,checked:t.data.noBgm,onChange:f}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"]})]}),n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u80CC\u666F\u97F3\u4E50\u6587\u4EF6"}),e(b,{setShow:x,id:"bgmPicker",dir:"bgm",set:S()}),e("span",{className:i.optionContent,children:_})]})]})]},t.index+"bgm")},gn=t=>{const[a,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,p={showAddPre:a,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const[f,_]=r.exports.useState(t.data.newScene),x=()=>S=>{s.currentSceneSentenceList[t.index].newScene=S,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5207\u6362\u573A\u666F"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:p})})]}),e("main",{className:i.mainEdit,children:n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u65B0\u573A\u666F"}),e(b,{setShow:_,id:"scenePicker",dir:"scene",set:x()}),e("span",{className:i.optionContent,children:f})]})})]},t.index+"scene")},fn=t=>{const[a,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,p={showAddPre:a,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const[f,_]=r.exports.useState(t.data.video),x=()=>S=>{s.currentSceneSentenceList[t.index].video=S,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u64AD\u653E\u89C6\u9891"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:p})})]}),e("main",{className:i.mainEdit,children:n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u89C6\u9891\u6587\u4EF6"}),e(b,{setShow:_,id:"videoPicker",dir:"video",set:x()}),e("span",{className:i.optionContent,children:f})]})})]},t.index+"scene")},{Option:J}=ne,pn=t=>{const[a,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,p={showAddPre:a,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const f=m=>{s.currentSceneSentenceList[t.index].noP=m,c.set("writeScene",!c.get("writeScene"))},_=m=>{s.currentSceneSentenceList[t.index].next=m,c.set("writeScene",!c.get("writeScene"))},[x,S]=r.exports.useState(t.data.newP),N=()=>m=>{s.currentSceneSentenceList[t.index].newP=m,c.set("writeScene",!c.get("writeScene"))},u=m=>{s.currentSceneSentenceList[t.index].pos=m,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5207\u6362\u7ACB\u7ED8"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:p})})]}),n("main",{className:i.mainEdit,children:[n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5173\u95ED\u7ACB\u7ED8"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"p_none",checked:t.data.noP,onChange:f})}),e("span",{className:i.optionContent,children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"}),e("span",{className:i.optionTitle,children:"\u7ACB\u7ED8\u4F4D\u7F6E"}),n(ne,{size:"small",defaultValue:t.data.pos,style:{width:120},onChange:u,children:[e(J,{value:"left",children:"\u5DE6"}),e(J,{value:"",children:"\u4E2D"}),e(J,{value:"right",children:"\u53F3"})]}),e("span",{className:i.optionContent,children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"}),e("span",{className:i.optionTitle,children:"\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),e("span",{className:i.optionContent,children:e(L,{size:"small",id:"p_none",checked:t.data.next,onChange:_})})]}),n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u7ACB\u7ED8\u6587\u4EF6"}),e(b,{setShow:S,id:"pPicker",dir:"figure",set:N()}),e("span",{className:i.optionContent,children:x})]})]})]},t.index+"dialog")},Sn=t=>{const[a,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,p={showAddPre:a,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{for(let u=0;u<t.data.chooseItem.length;u++)document.getElementById("chooseInput"+t.index+"itemIndex"+u).value=t.data.chooseItem[u].text});const f=()=>{s.currentSceneSentenceList[t.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),c.set("writeScene",!c.get("writeScene"))},_=u=>{const m=parseInt(u.split("Index")[1]);console.log(m),s.currentSceneSentenceList[t.index].chooseItem[m].text=document.getElementById(u).value,c.set("writeScene",!c.get("writeScene"))},x=u=>m=>{s.currentSceneSentenceList[t.index].chooseItem[u].scene=m,c.set("writeScene",!c.get("writeScene"))};let S=[],N=0;for(const u of t.data.chooseItem){const m="chooseInput"+t.index+"itemIndex"+N;let E=n("div",{className:i.singleOption,children:[e("span",{className:i.optionTitle,children:"\u5206\u652F\u540D\u79F0"}),e("input",{className:i.dialog_input,style:{width:"200px"},onBlur:()=>{_(m)},id:m}),e("span",{className:i.optionContent,children:e(Ee,{theme:"outline",size:"24",fill:"#333"})}),e("span",{className:i.optionTitle,children:"\u8DF3\u8F6C\u7684\u573A\u666F"}),e(b,{id:"scenePicker",dir:"scene",set:x(N)}),e("span",{className:i.optionContent,children:u.scene})]},N);S.push(E),N++}return n("div",{className:i.sentence,children:[n("div",{className:i.topContainer,children:[e("div",{className:i.sentenceIndexShow,children:"\u5206\u652F\u9009\u62E9"}),e("div",{className:i.barContainer,children:e(P,{index:t.index,data:p})})]}),n("main",{className:i.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:n("div",{onClick:f,className:i.sentenceButton,children:[e(Be,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),S]})]},t.index+"choose")},_n=(t,a)=>{let l;switch(t.type){case"dialog":l=e(un,{data:t,index:a},a);break;case"bg":l=e(mn,{data:t,index:a},a);break;case"bgm":l=e(hn,{data:t,index:a},a);break;case"changeScene":l=e(gn,{data:t,index:a},a);break;case"video":l=e(fn,{data:t,index:a},a);break;case"changeP":l=e(pn,{data:t,index:a},a);break;case"choose":l=e(Sn,{data:t,index:a},a);break}return l};const Nn=t=>{const[a,l]=r.exports.useState(!0),[g,d]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateScene",a),c.connect("updateScene",()=>{l(c.get("updateScene"))},"updateSceneFunc"),c.set("refScene",!0),c.connect("refScene",()=>{W()},"refSceneFunc"),c.get("writeScene")===void 0&&c.set("writeScene",!0),c.connect("writeScene",()=>{K()},"writeSceneFunc"),W()},[]);let o=[];const h=JSON.parse(JSON.stringify(s.currentSceneSentenceList));for(let f=0;f<h.length;f++){const _=h[f],x=_n(_,f),S=n("div",{className:v.sentence,children:[e("div",{className:v.lineNumber,children:f+1}),e("div",{className:v.sentenceMain,children:x})]});o.push(S)}const p=n("div",{className:v.addSentencePanel,children:[n("div",{className:v.addSentenceButton,onClick:()=>{F("dialog"),d(!1)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("changeP"),d(!1)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("bg"),d(!1)},children:[e(U,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("changeScene"),d(!1)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("choose"),d(!1)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("bgm"),d(!1)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),n("div",{className:v.addSentenceButton,onClick:()=>{F("video"),d(!1)},children:[e($,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]});return n("div",{children:[n("div",{className:v.topButtonList,children:[e("div",{className:v.topButton,onClick:K,children:"\u4FDD\u5B58\u573A\u666F"}),e("div",{className:v.topButton,onClick:()=>{d(!g)},children:"\u6DFB\u52A0\u8BED\u53E5"}),e("div",{children:g&&p})]}),e("div",{className:v.sentenceList,children:o})]})};function W(){let t=s.currentEditScene;if(t==="")return;const a=`${s.domain}/Games/${s.currentEditGame}/game/scene/${t}`;A.get(a).then(l=>{s.currentSceneSentenceList=l.data,c.set("updateScene",!c.get("updateScene"))}).catch(l=>console.log(l))}function F(t,a){const l=Qt(t);a!==void 0?s.currentSceneSentenceList.splice(a,0,l):s.currentSceneSentenceList.push(l),K()}function K(){const t=`${s.domain}/api/editGame/editScene/`,a={gameName:s.currentEditGame,sceneName:s.currentEditScene,sceneData:s.currentSceneSentenceList};A.post(t,a).then(l=>{W()}).catch(l=>console.log(l))}const xn=()=>{const[t,a]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateEditor",t),c.connect("updateEditor",()=>{a(c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},"updateEditorFunc")},[]);const l=o=>{s.currentEditScene=o,c.set("updateEditor",!c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},g=o=>{const h=s.currentOpendSceneEdit.indexOf(o);s.currentOpendSceneEdit.splice(h,1);const p=s.currentOpendSceneEdit.length===0;o===s.currentEditScene&&(p?s.currentEditScene="":s.currentOpendSceneEdit.length<=h?s.currentEditScene=s.currentOpendSceneEdit[s.currentOpendSceneEdit.length-1]:s.currentEditScene=s.currentOpendSceneEdit[h]),c.set("updateEditor",!c.get("updateEditor"))},d=[];for(const o of s.currentOpendSceneEdit){let h;o===s.currentEditScene?h=n("div",{className:D.tagOpened,children:[e(R,{theme:"outline",size:"20",fill:"#333",className:D.tagIcon}),o,e(se,{theme:"outline",size:"20",fill:"#333",className:D.tagIcon,onClick:()=>{g(o)}})]},o):h=n("div",{className:D.tag,onClick:()=>{l(o)},children:[e(R,{theme:"outline",size:"20",fill:"#333",className:D.tagIcon}),o,e(se,{theme:"outline",size:"20",fill:"#333",className:D.tagIcon,onClick:p=>{p.preventDefault(),p.stopPropagation(),g(o)}})]},o),d.push(h)}return n("div",{className:D.main,children:[e("div",{className:D.tagList,children:d}),e("div",{children:s.currentEditScene!==""&&e(Nn,{sceneName:s.currentEditScene})})]})},vn=()=>{const[t,a]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("updateEditor",!0),c.connect("updateEditor",()=>{a(c.get("updateEditor"))},"ForceUpdateEditor")},[]),n("div",{children:[e(Ve,{}),n("main",{className:zt.main,children:[e(Pt,{}),e(xn,{})]})]})};function Cn(){const[t,a]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("isManageMent",!0),c.connect("isManagement",()=>{a(c.get("isManagement"))},"setIsManagementFunc")},[]),n("div",{className:"App",children:[t&&e(Me,{}),!t&&e(vn,{})]})}we.render(e(Fe.StrictMode,{children:e(Cn,{})}),document.getElementById("root"));
