import{f as le,r,a as F,j as n,b as e,G as re,A as H,L as ue,F as Q,N as me,E as he,P as ge,V as Se,c as M,d as j,e as U,g as R,h as fe,D as X,R as pe,U as xe,i as _e,k as ve,C as Y,l as Z,S as ee,m as Ne,n as Ce,o as te,p as P,q as ne,s as Ee,t as Be,u as ie,v as se,w as we,x as Fe}from"./vendor.aef5ca88.js";const Ae=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))g(d);new MutationObserver(d=>{for(const o of d)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&g(h)}).observe(document,{childList:!0,subtree:!0});function l(d){const o={};return d.integrity&&(o.integrity=d.integrity),d.referrerpolicy&&(o.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?o.credentials="include":d.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function g(d){if(d.ep)return;d.ep=!0;const o=l(d);fetch(d.href,o)}};Ae();const ke="_nav_11k4b_2",De="_title_11k4b_12",be="_subTitle_11k4b_20",Ie="_main_11k4b_29",ye="_gameList_11k4b_33",Pe="_singleGameEntryButton_11k4b_39",Le="_buttonIcon_11k4b_54",ze="_addIcon_11k4b_58",Ge="_createPanel_11k4b_65",Te="_createPanelTitle_11k4b_75",Oe="_createPanelInput_11k4b_81",$e="_createButton_11k4b_87";var A={nav:ke,title:De,subTitle:be,main:Ie,gameList:ye,singleGameEntryButton:Pe,buttonIcon:Le,addIcon:ze,createPanel:Ge,createPanelTitle:Te,createPanelInput:Oe,createButton:$e};const c=new le;c.set("updateEditor",!0);const ce={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[]},i=JSON.parse(JSON.stringify(ce)),Me=()=>{const[t,s]=r.exports.useState(!0),[l,g]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refManagement",t),c.connect("refManagement",()=>{s(c.get("refManagement"))},"refManagementFunc"),d()},[]);const d=()=>{F.get(i.domain+"/api/manageGame/gameList").then(f=>{i.gameList=f.data,c.set("refManagement",!c.get("refManagement"))}).catch(f=>{console.log(f)})};let o=[];for(const f of i.gameList){const S=n("div",{className:A.singleGameEntryButton,onClick:()=>{for(const p in i)i[p]=ce[p];i.currentEditGame=f,c.set("isManagement",!1)},children:[e(re,{theme:"outline",size:"24",fill:"#333",className:A.buttonIcon}),f]},f);o.push(S)}const h=f=>{const S=`${i.domain}/api/manageGame/createGame/${f}`;F.get(S).then(p=>{g(!1),d()})};return n("div",{children:[e("header",{children:e("nav",{children:e("div",{className:A.nav,children:e("div",{className:A.title,children:"WebGAL ORIGINE"})})})}),n("main",{className:A.main,children:[n("div",{className:A.subTitle,children:["\u6E38\u620F\u5217\u8868",n("span",{onClick:()=>g(!l),className:A.addIcon,children:[e(H,{theme:"outline",size:"18",fill:"#8E354A"})," \u65B0\u5EFA\u6E38\u620F"]}),l&&n("div",{className:A.createPanel,children:[e("div",{className:A.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),n("div",{children:["\u6E38\u620F\u540D\u79F0\uFF1A",e("input",{id:"createInput",className:A.createPanelInput})]}),e("div",{style:{textAlign:"center"},children:e("div",{onClick:()=>h(document.getElementById("createInput").value),className:A.createButton,children:"\u521B\u5EFA"})})]})]}),e("div",{className:A.gameList,children:o})]})]})},je="_nav_1x6hc_1",Ue="_title_1x6hc_11",Re="_titleIcon_1x6hc_19";var V={nav:je,title:Ue,titleIcon:Re};const Ve=()=>n("div",{className:V.nav,children:[e(ue,{theme:"filled",size:"30",fill:"#333",className:V.titleIcon,onClick:()=>{c.set("isManagement",!0)}}),e("div",{className:V.title,children:"WebGAL ORIGINE"})]}),qe="_aside_jzyyx_1",Je="_option_jzyyx_9",We="_optionMarker_jzyyx_18",Ke="_chooseItem_jzyyx_26",He="_chooseTitle_jzyyx_37",Qe="_chooseDescription_jzyyx_42",Xe="_tagButton_jzyyx_47",Ye="_tagButtonOn_jzyyx_55",Ze="_sideBarContent_jzyyx_66";var L={aside:qe,option:Je,optionMarker:We,chooseItem:Ke,chooseTitle:He,chooseDescription:Qe,tagButton:Xe,tagButtonOn:Ye,sideBarContent:Ze};const et="_title_1xmzb_1",tt="_previewGameButton_1xmzb_9",nt="_gameNameInput_1xmzb_20";var z={title:et,previewGameButton:tt,gameNameInput:nt};const it="_choosed_whrvv_1",st="_chooseBox_whrvv_7",ct="_chooseIcon_whrvv_11",at="_fileList_whrvv_26",ot="_singleFile_whrvv_38",dt="_fileIcon_whrvv_49";var I={choosed:it,chooseBox:st,chooseIcon:ct,fileList:at,singleFile:ot,fileIcon:dt};const D=t=>{const[s,l]=r.exports.useState(!1),[g,d]=r.exports.useState(t.dir),[o,h]=r.exports.useState([]),[f,S]=r.exports.useState(""),p=u=>{const C={dir:`/${i.currentEditGame}/game/${u}`};F.post(`${i.domain}/api/editGame/getAssets/`,C).then(N=>{h(N.data)}).catch(N=>{console.log(N)})},v=u=>{let m=u.split("/");u="";let C=0;for(const N of m)N!==t.dir&&(C!==0&&(u=u+"/"),C++,u=u+N);return u},x=u=>{let m=g+"/"+u;m=v(m),t.set(m),t.hasOwnProperty("setShow")&&t.setShow(m)};r.exports.useEffect(()=>{p(g)},[]);let _=[];for(const u of o){let m=!0,C=!0;u.match(/\.json/)&&(C=!1),u.match(/\./)&&(m=!1);let N=e("div",{children:""});m?N=n("div",{className:I.singleFile,onClick:()=>{const B=g+"/"+u;d(B),p(B)},children:[e(Q,{theme:"outline",size:"18",fill:"#333",className:I.fileIcon}),u]},u):N=n("div",{className:I.singleFile,onClick:()=>{S(v(g+"/"+u)),x(u),l(!s)},children:[e(me,{theme:"outline",size:"18",fill:"#333",className:I.fileIcon}),u]},u),C&&_.push(N)}return n("div",{children:[e("div",{className:I.chooseBox,children:n("div",{className:I.chooseIcon,onClick:()=>{s===!1&&(d(t.dir),S(""),p(t.dir)),l(!s)},children:[e(he,{theme:"outline",size:"18",fill:"#333"})," \u9009\u62E9\u6587\u4EF6"]})}),e("div",{style:{position:"relative"},children:s&&e("div",{className:I.fileList,children:_})})]})},lt=()=>{r.exports.useState(!1);const[t,s]=r.exports.useState(""),[l,g]=r.exports.useState(""),[d,o]=r.exports.useState(""),h=()=>{F.get(`${i.domain}/Games/${i.currentEditGame}/game/gameConfig.json`).then(x=>{let _=x.data;i.currentGameConfig=x.data,document.getElementById("gameNameInput").value=_.Game_name,s(_.Title_bgm),g(_.Title_img),o(_.Loading_img)})},f=()=>{i.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,v()},S=(x,_)=>{i.currentGameConfig[x]=_,v()},p=x=>_=>{S(x,_)},v=()=>{let x={currentEditGame:i.currentEditGame,config:i.currentGameConfig};F.post(`${i.domain}/api/manageGame/config`,x).then(_=>{})};return r.exports.useEffect(()=>{h()},[]),n("div",{children:[e("div",{children:e("a",{style:{color:"black",textDecoration:"none"},href:`${i.domain}/Games/${i.currentEditGame}`,target:"_blank",children:n("div",{className:z.previewGameButton,children:[e(ge,{theme:"outline",size:"28",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,4px)"}}),"\u9884\u89C8\u6E38\u620F"]})})}),n("div",{children:[e("div",{className:z.title,children:"\u6E38\u620F\u540D\u79F0"}),e("div",{children:e("input",{onInput:f,id:"gameNameInput",className:z.gameNameInput})})]}),n("div",{children:[e("div",{className:z.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),n("div",{children:[t,e(D,{setShow:s,id:"bgmPicker",dir:"bgm",set:p("Title_bgm")})]})]}),n("div",{children:[e("div",{className:z.title,children:"\u6807\u9898\u80CC\u666F"}),n("div",{children:[l,e(D,{setShow:g,id:"bgPicker",dir:"background",set:p("Title_img")})]})]}),n("div",{children:[e("div",{className:z.title,children:"\u52A0\u8F7D\u56FE"}),n("div",{children:[d,e(D,{setShow:o,id:"loadImgPicker",dir:"background",set:p("Loading_img")})]})]})]})},rt="_dirButtonContainer_1bra8_1",ut="_icon_small_1bra8_6",mt="_controlPanel_1bra8_13",ht="_upload_1bra8_17",gt="_dirButton_1bra8_1",St="_fileElement_1bra8_36",ft="_title_1bra8_46",pt="_currentDirShow_1bra8_56",xt="_panelButton_1bra8_65";var k={dirButtonContainer:rt,icon_small:ut,controlPanel:mt,upload:ht,dirButton:gt,fileElement:St,title:ft,currentDirShow:pt,panelButton:xt};const ae={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},_t=t=>{let s=e(Q,{theme:"outline",size:"24",fill:"#333"});switch(t.icon){case"background":s=e(R,{theme:"outline",size:"24",fill:"#333"});break;case"bgm":s=e(U,{theme:"outline",size:"24",fill:"#333"});break;case"figure":s=e(j,{theme:"outline",size:"24",fill:"#333"});break;case"video":s=e(M,{theme:"outline",size:"24",fill:"#333"});break;case"vocal":s=e(Se,{theme:"outline",size:"24",fill:"#333"});break}return s},vt=()=>{const[t,s]=r.exports.useState(!0),[l,g]=r.exports.useState(!1),[d,o]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refAssetsManagement",t),c.connect("refAssetsManagement",()=>{s(c.get("refAssetsManagement"))},"refAssetsManagement"),h()},[]);const h=()=>{const m=i.currentEditGame,C=i.currentDir,N={dir:`/${m}/game/${C}`};F.post(`${i.domain}/api/editGame/getAssets/`,N).then(B=>{i.currentDirContent=B.data,c.set("refAssetsManagement",!c.get("refAssetsManagement"))}).catch(B=>{console.log(B)})},f=()=>{if(i.currentDir==="")return;let m=i.currentDir.split("/");m.pop(),i.currentDir=m.reduce((C,N)=>""+C+"/"+N),h()},S=m=>{i.currentDir=i.currentDir+`/${m}`,h()},p=()=>{const m=i.currentEditGame,C=i.currentDir,N=`/${m}/game/${C}`;let B=new FormData;B.append("dir",N);const $=document.getElementById("uploadFile").files[0];let G=document.getElementById("uploadFile").value;B.append("file",$,G),F.post(`${i.domain}/api/editGame/addAsset/`,B,{headers:{"Content-Type":"multipart/form-data"}}).then(K=>{g(!1),h()}).catch(K=>{console.log(K)})},v=()=>{const m=i.currentEditGame,C=i.currentDir,N=`/${m}/game/${C}`,B=document.getElementById("addDirInput").value,$={current:N,Name:B};F.post(`${i.domain}/api/editGame/mkdir/`,$).then(G=>{o(!1),h()}).catch(G=>{console.log(G)})},x=()=>{g(!l)},_=()=>{o(!d)},u=[];for(const m of i.currentDirContent){let C="",N=!0;if(m.match(/\./))i.currentDir===""&&(N=!1),C=n("div",{className:k.fileElement,children:[m,n("div",{children:[e(fe,{theme:"outline",size:"24",fill:"#333"}),e(X,{theme:"outline",size:"24",fill:"#333"})]})]},m);else{let B=m;i.currentDir===""&&ae.hasOwnProperty(m)&&(B=ae[m]),C=n("div",{className:k.dirButton,onClick:()=>S(m),children:[e("span",{className:k.icon_small,children:e(_t,{icon:m})}),B]},m),m==="scene"&&i.currentDir===""&&(N=!1)}N&&u.push(C)}return n("div",{children:[e("div",{className:k.title,children:"\u7D20\u6750\u7BA1\u7406"}),i.currentDir!==""&&e("div",{className:k.currentDirShow,children:i.currentDir}),i.currentDir!==""&&n("div",{className:k.controlPanel,children:[e("div",{children:e(pe,{theme:"outline",size:"24",fill:"#333",onClick:f,className:k.panelButton})}),n("div",{children:[e(xe,{theme:"outline",size:"24",fill:"#333",onClick:x,className:k.panelButton}),l&&n("div",{className:k.upload,children:["\u4E0A\u4F20\u6587\u4EF6",e("br",{}),e("input",{id:"uploadFile",type:"file"}),e("div",{onClick:p,children:"\u4E0A\u4F20"})]})]}),n("div",{children:[e(_e,{theme:"outline",size:"24",fill:"#333",onClick:_,className:k.panelButton}),d&&n("div",{className:k.upload,children:["\u65B0\u5EFA\u6587\u4EF6\u5939",e("br",{}),e("input",{id:"addDirInput"}),e("div",{onClick:v,children:"\u65B0\u5EFA"})]})]})]}),e("div",{}),e("div",{className:k.dirButtonContainer,children:u})]})},Nt="_main_1dzb8_1",Ct="_addInput_1dzb8_12",Et="_title_1dzb8_20",Bt="_addButton_1dzb8_26";var T={main:Nt,addInput:Ct,title:Et,addButton:Bt};const wt=t=>{const s=()=>{const l={gameName:i.currentEditGame,sceneName:document.getElementById("addSceneName").value};F.post(`${i.domain}/api/editGame/addNewScene/`,l).then(g=>{t.added()}).catch(g=>{console.log(g)})};return n("div",{className:T.main,children:[n("div",{className:T.title,children:["\u573A\u666F\u540D\u79F0\uFF1A",e("input",{className:T.addInput,id:"addSceneName"})]}),e("div",{className:T.addButton,onClick:s,children:"\u65B0\u5EFA\u573A\u666F"})]})},Ft="_titleText_il1uv_1",At="_scene_il1uv_11",kt="_newSceneButton_il1uv_22",Dt="_sceneList_il1uv_31";var O={titleText:Ft,scene:At,newSceneButton:kt,sceneList:Dt};const bt=()=>{const[t,s]=r.exports.useState([]),[l,g]=r.exports.useState(!1),d=()=>{const v={dir:`/${i.currentEditGame}/game/scene`};F.post(`${i.domain}/api/editGame/getAssets/`,v).then(x=>{s(x.data)}).catch(x=>{console.log(x)})},o=()=>{d(),g(!l)};r.exports.useEffect(()=>{d()},[]);const h=S=>{i.currentOpendSceneEdit.includes(S)||i.currentOpendSceneEdit.push(S),i.currentEditScene=S,c.set("updateEditor",!c.get("updateEditor"))},f=[];for(const S of t){let p=!1,v=S.split(".");v[v.length-1]==="json"&&(p=!0);const x=n("div",{className:O.scene,onClick:()=>h(S),children:[e(ve,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),S]},S);p&&f.push(x)}return n("div",{children:[e("div",{className:O.titleText,children:"\u573A\u666F\u7BA1\u7406"}),n("div",{className:O.newSceneButton,onClick:()=>{g(!l)},children:[e(H,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u65B0\u5EFA\u573A\u666F"]}),e("div",{children:l&&e(wt,{added:o})}),e("div",{className:O.sceneList,children:f})]})},It=()=>{const t=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[s,l]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refSideBar",s),c.connect("refSideBar",()=>{l(c.get("refSideBar"))},"refSideBarFunc")},[]);const g=[];for(const o of t){let h;o===i.editorTag?h=e("div",{className:L.optionMarker}):h=e("div",{});const f=n("div",{className:o===i.editorTag?L.tagButtonOn:L.tagButton,onClick:()=>{i.editorTag=o,c.set("refSideBar",!c.get("refSideBar"))},children:[e("div",{children:o}),h]},o);g.push(f)}let d;switch(i.editorTag){case"\u6E38\u620F\u914D\u7F6E":d=e(lt,{});break;case"\u7D20\u6750\u7BA1\u7406":d=e(vt,{});break;case"\u573A\u666F\u7BA1\u7406":d=e(bt,{});break}return n("aside",{className:L.aside,children:[e("div",{className:L.option,children:g}),e("div",{className:L.sideBarContent,children:d})]})},yt="_main_19sml_1";var Pt={main:yt};const Lt="_main_yjjiw_1",zt="_tag_yjjiw_7",Gt="_tagOpened_yjjiw_17",Tt="_tagList_yjjiw_24",Ot="_tagIcon_yjjiw_28";var b={main:Lt,tag:zt,tagOpened:Gt,tagList:Tt,tagIcon:Ot};const $t="_topButtonList_nuwbr_1",Mt="_topButton_nuwbr_1",jt="_addSentencePanel_nuwbr_16",Ut="_addSentenceButton_nuwbr_25",Rt="_sentenceList_nuwbr_35";var E={topButtonList:$t,topButton:Mt,addSentencePanel:jt,addSentenceButton:Ut,sentenceList:Rt};const Vt=t=>{let s;switch(t){case"dialog":s={type:t,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":s={type:t,bg:"",noBg:!1,next:!1};break;case"bgm":s={type:t,bgm:"",noBgm:!1};break;case"changeScene":s={type:t,newScene:""};break;case"video":s={type:t,video:""};break;case"changeP":s={type:t,newP:"",next:!1,noP:!1,pos:""};break;case"choose":s={type:t,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break}return s},qt="_sentence_xlujx_1",Jt="_sentenceIn_xlujx_62",Wt="_dialog_input_xlujx_12",Kt="_singleOption_xlujx_20",Ht="_optionTitle_xlujx_27",Qt="_optionContent_xlujx_35",Xt="_isolate_xlujx_39",Yt="_sentenceButtonList_xlujx_44",Zt="_sentenceButton_xlujx_44",en="_sentenceIndexShow_xlujx_62",tn="_topContainer_xlujx_70";var a={sentence:qt,sentenceIn:Jt,dialog_input:Wt,singleOption:Kt,optionTitle:Ht,optionContent:Qt,isolate:Xt,sentenceButtonList:Yt,sentenceButton:Zt,sentenceIndexShow:en,topContainer:tn};const nn=t=>{i.currentSceneSentenceList.splice(t,1),c.set("writeScene",!c.get("writeScene"))},oe=(t,s)=>{if(!(t===0&&s===-1||t===i.currentSceneSentenceList.length-1&&s===1)){{const l=i.currentSceneSentenceList[t];i.currentSceneSentenceList.splice(t,1),i.currentSceneSentenceList.splice(t+s,0,l)}c.set("writeScene",!c.get("writeScene"))}},de=t=>n("div",{className:E.addSentencePanel,children:[n("div",{className:E.addSentenceButton,onClick:()=>{w("dialog",t.index)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("changeP",t.index)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("bg",t.index)},children:[e(R,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("changeScene",t.index)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("choose",t.index)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("bgm",t.index)},children:[e(U,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("video",t.index)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]}),y=t=>n("div",{className:a.sentenceButtonList,children:[n("div",{className:a.sentenceButton,onClick:()=>{nn(t.index)},children:[e(X,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),n("div",{onClick:()=>{oe(t.index,-1)},className:a.sentenceButton,children:[e(Ne,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),n("div",{onClick:()=>{oe(t.index,1)},className:a.sentenceButton,children:[e(Ce,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),n("div",{onClick:()=>{t.data.setShowAddPre(!t.data.showAddPre)},className:a.sentenceButton,children:[e(te,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",t.data.showAddPre&&e(de,{index:t.data.indexPre})]}),n("div",{onClick:()=>{t.data.setShowAddAfter(!t.data.showAddAfter)},className:a.sentenceButton,children:[e(te,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",t.data.showAddAfter&&e(de,{index:t.data.indexAfter})]})]}),sn=t=>{const[s,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:s,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{document.getElementById("speakerInput"+t.index).value=t.data.speaker,document.getElementById("contentInput"+t.index).value=t.data.content});const S=()=>{i.currentSceneSentenceList[t.index].speaker=document.getElementById("speakerInput"+t.index).value,i.currentSceneSentenceList[t.index].content=document.getElementById("contentInput"+t.index).value,c.set("writeScene",!c.get("writeScene"))},p=u=>{i.currentSceneSentenceList[t.index].ignoreSpeaker=u,c.set("writeScene",!c.get("writeScene"))},[v,x]=r.exports.useState(t.data.vocal),_=()=>u=>{i.currentSceneSentenceList[t.index].vocal=u,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:a.sentence,children:[n("div",{className:a.topContainer,children:[n("div",{className:a.sentenceIndexShow,children:["#",t.index+1," \u57FA\u672C\u5BF9\u8BDD"]}),e(y,{index:t.index,data:f})]}),n("main",{children:[n("div",{className:a.singleOption,children:["\u89D2\u8272\uFF1A",e("input",{className:a.dialog_input,onChange:S,id:"speakerInput"+t.index}),e("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),n("div",{className:a.singleOption,children:["\u5BF9\u8BDD\uFF1A",e("input",{className:a.dialog_input,onChange:S,id:"contentInput"+t.index})]}),n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u65C1\u767D\u6A21\u5F0F"}),n("span",{className:a.optionContent,children:[e(P,{id:"dialog_pbms",checked:t.data.ignoreSpeaker,onChange:p}),"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"]}),e("div",{className:a.optionTitle,children:"\u914D\u97F3\u6587\u4EF6"}),e(D,{setShow:x,id:"vocalPicker",dir:"vocal",set:_()}),e("span",{className:a.optionContent,children:v})]})]})]},t.index+"dialog")},cn=t=>{const[s,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:s,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const S=u=>{i.currentSceneSentenceList[t.index].noBg=u,c.set("writeScene",!c.get("writeScene"))},p=u=>{i.currentSceneSentenceList[t.index].next=u,c.set("writeScene",!c.get("writeScene"))},[v,x]=r.exports.useState(t.data.bg),_=()=>u=>{i.currentSceneSentenceList[t.index].bg=u,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:a.sentence,children:[n("div",{className:a.topContainer,children:[n("div",{className:a.sentenceIndexShow,children:["#",t.index+1," \u66F4\u6539\u80CC\u666F"]}),e(y,{index:t.index,data:f})]}),n("main",{children:[n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u80CC\u666F"}),n("span",{className:a.optionContent,children:[e(P,{checked:t.data.noBg,id:"bg_none"+t.index,onChange:S}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"]}),e("span",{className:a.optionTitle,children:"\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5"}),e("span",{className:a.optionContent,children:e(P,{id:"bg_next"+t.index,checked:t.data.next,onChange:p})})]}),n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u80CC\u666F\u6587\u4EF6"}),e(D,{setShow:x,id:"bgPicker",dir:"background",set:_()}),e("span",{className:a.optionContent,children:v})]})]})]},t.index+"bg")},an=t=>{const[s,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:s,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const S=_=>{i.currentSceneSentenceList[t.index].noBgm=_,c.set("writeScene",!c.get("writeScene"))},[p,v]=r.exports.useState(t.data.bgm),x=()=>_=>{i.currentSceneSentenceList[t.index].bgm=_,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:a.sentence,children:[n("div",{className:a.topContainer,children:[n("div",{className:a.sentenceIndexShow,children:["#",t.index+1," \u66F4\u6539\u97F3\u4E50"]}),e(y,{index:t.index,data:f})]}),n("main",{children:[n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u80CC\u666F\u97F3\u4E50"}),n("span",{className:a.optionContent,children:[e(P,{id:"bgm_none"+t.index,checked:t.data.noBgm,onChange:S}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"]})]}),n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u80CC\u666F\u97F3\u4E50\u6587\u4EF6"}),e(D,{setShow:v,id:"bgmPicker",dir:"bgm",set:x()}),e("span",{className:a.optionContent,children:p})]})]})]},t.index+"bgm")},on=t=>{const[s,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:s,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const[S,p]=r.exports.useState(t.data.newScene),v=()=>x=>{i.currentSceneSentenceList[t.index].newScene=x,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:a.sentence,children:[n("div",{className:a.topContainer,children:[n("div",{className:a.sentenceIndexShow,children:["#",t.index+1," \u5207\u6362\u573A\u666F"]}),e(y,{index:t.index,data:f})]}),e("main",{children:n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u65B0\u573A\u666F"}),e(D,{setShow:p,id:"scenePicker",dir:"scene",set:v()}),e("span",{className:a.optionContent,children:S})]})})]},t.index+"scene")},dn=t=>{const[s,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:s,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const[S,p]=r.exports.useState(t.data.video),v=()=>x=>{i.currentSceneSentenceList[t.index].video=x,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:a.sentence,children:[n("div",{className:a.topContainer,children:[n("div",{className:a.sentenceIndexShow,children:["#",t.index+1," \u64AD\u653E\u89C6\u9891"]}),e(y,{index:t.index,data:f})]}),e("main",{children:n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u89C6\u9891\u6587\u4EF6"}),e(D,{setShow:p,id:"videoPicker",dir:"video",set:v()}),e("span",{className:a.optionContent,children:S})]})})]},t.index+"scene")},{Option:q}=ne,ln=t=>{const[s,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:s,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{});const S=m=>{i.currentSceneSentenceList[t.index].noP=m,c.set("writeScene",!c.get("writeScene"))},p=m=>{i.currentSceneSentenceList[t.index].next=m,c.set("writeScene",!c.get("writeScene"))},[v,x]=r.exports.useState(t.data.newP),_=()=>m=>{i.currentSceneSentenceList[t.index].newP=m,c.set("writeScene",!c.get("writeScene"))},u=m=>{i.currentSceneSentenceList[t.index].pos=m,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:a.sentence,children:[n("div",{className:a.topContainer,children:[n("div",{className:a.sentenceIndexShow,children:["#",t.index+1," \u5207\u6362\u7ACB\u7ED8"]}),e(y,{index:t.index,data:f})]}),n("main",{children:[n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u7ACB\u7ED8"}),e("span",{className:a.optionContent,children:e(P,{id:"p_none",checked:t.data.noP,onChange:S})}),e("span",{className:a.optionContent,children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"}),e("span",{className:a.optionTitle,children:"\u7ACB\u7ED8\u4F4D\u7F6E"}),n(ne,{defaultValue:t.data.pos,style:{width:120},onChange:u,children:[e(q,{value:"left",children:"\u5DE6"}),e(q,{value:"",children:"\u4E2D"}),e(q,{value:"right",children:"\u53F3"})]}),e("span",{className:a.optionContent,children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"}),e("span",{className:a.optionTitle,children:"\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),e(P,{id:"p_none",checked:t.data.next,onChange:p})]}),n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u7ACB\u7ED8\u6587\u4EF6"}),e(D,{setShow:x,id:"pPicker",dir:"figure",set:_()}),e("span",{className:a.optionContent,children:v})]})]})]},t.index+"dialog")},rn=t=>{const[s,l]=r.exports.useState(!1),[g,d]=r.exports.useState(!1),o=t.index,h=t.index+1,f={showAddPre:s,setShowAddPre:l,showAddAfter:g,setShowAddAfter:d,indexPre:o,indexAfter:h};r.exports.useEffect(()=>{for(let u=0;u<t.data.chooseItem.length;u++)document.getElementById("chooseInput"+t.index+"itemIndex"+u).value=t.data.chooseItem[u].text});const S=()=>{i.currentSceneSentenceList[t.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),c.set("writeScene",!c.get("writeScene"))},p=u=>{const m=parseInt(u.split("Index")[1]);console.log(m),i.currentSceneSentenceList[t.index].chooseItem[m].text=document.getElementById(u).value,c.set("writeScene",!c.get("writeScene"))},v=u=>m=>{i.currentSceneSentenceList[t.index].chooseItem[u].scene=m,c.set("writeScene",!c.get("writeScene"))};let x=[],_=0;for(const u of t.data.chooseItem){const m="chooseInput"+t.index+"itemIndex"+_;let C=n("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5206\u652F\u540D\u79F0"}),e("input",{className:a.dialog_input,style:{width:"200px"},onChange:()=>{p(m)},id:m}),e("span",{className:a.optionContent,children:e(Ee,{theme:"outline",size:"24",fill:"#333"})}),e("span",{className:a.optionTitle,children:"\u8DF3\u8F6C\u7684\u573A\u666F"}),e(D,{id:"scenePicker",dir:"scene",set:v(_)}),e("span",{className:a.optionContent,children:u.scene})]},_);x.push(C),_++}return n("div",{className:a.sentence,children:[n("div",{className:a.topContainer,children:[n("div",{className:a.sentenceIndexShow,children:["#",t.index+1," \u5206\u652F\u9009\u62E9"]}),e(y,{index:t.index,data:f})]}),n("main",{children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:n("div",{onClick:S,className:a.sentenceButton,children:[e(Be,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),x]})]},t.index+"choose")},un=(t,s)=>{let l;switch(t.type){case"dialog":l=e(sn,{data:t,index:s},s);break;case"bg":l=e(cn,{data:t,index:s},s);break;case"bgm":l=e(an,{data:t,index:s},s);break;case"changeScene":l=e(on,{data:t,index:s},s);break;case"video":l=e(dn,{data:t,index:s},s);break;case"changeP":l=e(ln,{data:t,index:s},s);break;case"choose":l=e(rn,{data:t,index:s},s);break}return l};const mn=t=>{const[s,l]=r.exports.useState(!0),[g,d]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateScene",s),c.connect("updateScene",()=>{l(c.get("updateScene"))},"updateSceneFunc"),c.set("refScene",!0),c.connect("refScene",()=>{J()},"refSceneFunc"),c.get("writeScene")===void 0&&c.set("writeScene",!0),c.connect("writeScene",()=>{W()},"writeSceneFunc"),J()},[]);let o=[];const h=JSON.parse(JSON.stringify(i.currentSceneSentenceList));for(let S=0;S<h.length;S++){const p=h[S],v=un(p,S);o.push(v)}const f=n("div",{className:E.addSentencePanel,children:[n("div",{className:E.addSentenceButton,onClick:()=>{w("dialog"),d(!1)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("changeP"),d(!1)},children:[e(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("bg"),d(!1)},children:[e(R,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("changeScene"),d(!1)},children:[e(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("choose"),d(!1)},children:[e(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("bgm"),d(!1)},children:[e(U,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),n("div",{className:E.addSentenceButton,onClick:()=>{w("video"),d(!1)},children:[e(M,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]});return n("div",{children:[n("div",{className:E.topButtonList,children:[e("div",{className:E.topButton,onClick:W,children:"\u4FDD\u5B58\u573A\u666F"}),e("div",{className:E.topButton,onClick:()=>{d(!g)},children:"\u6DFB\u52A0\u8BED\u53E5"}),e("div",{children:g&&f})]}),e("div",{className:E.sentenceList,children:o})]})};function J(){let t=i.currentEditScene;if(t==="")return;const s=`${i.domain}/Games/${i.currentEditGame}/game/scene/${t}`;F.get(s).then(l=>{i.currentSceneSentenceList=l.data,c.set("updateScene",!c.get("updateScene"))}).catch(l=>console.log(l))}function w(t,s){const l=Vt(t);s!==void 0?i.currentSceneSentenceList.splice(s,0,l):i.currentSceneSentenceList.push(l),W()}function W(){const t=`${i.domain}/api/editGame/editScene/`,s={gameName:i.currentEditGame,sceneName:i.currentEditScene,sceneData:i.currentSceneSentenceList};F.post(t,s).then(l=>{J()}).catch(l=>console.log(l))}const hn=()=>{const[t,s]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateEditor",t),c.connect("updateEditor",()=>{s(c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},"updateEditorFunc")},[]);const l=o=>{i.currentEditScene=o,c.set("updateEditor",!c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},g=o=>{const h=i.currentOpendSceneEdit.indexOf(o);i.currentOpendSceneEdit.splice(h,1);const f=i.currentOpendSceneEdit.length===0;o===i.currentEditScene&&(f?i.currentEditScene="":i.currentOpendSceneEdit.length<=h?i.currentEditScene=i.currentOpendSceneEdit[i.currentOpendSceneEdit.length-1]:i.currentEditScene=i.currentOpendSceneEdit[h]),c.set("updateEditor",!c.get("updateEditor"))},d=[];for(const o of i.currentOpendSceneEdit){let h;o===i.currentEditScene?h=n("div",{className:b.tagOpened,children:[e(ie,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),o,e(se,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon,onClick:()=>{g(o)}})]},o):h=n("div",{className:b.tag,onClick:()=>{l(o)},children:[e(ie,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),o,e(se,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon,onClick:f=>{f.preventDefault(),f.stopPropagation(),g(o)}})]},o),d.push(h)}return n("div",{className:b.main,children:[e("div",{className:b.tagList,children:d}),e("div",{children:i.currentEditScene!==""&&e(mn,{sceneName:i.currentEditScene})})]})},gn=()=>{const[t,s]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("updateEditor",!0),c.connect("updateEditor",()=>{s(c.get("updateEditor"))},"ForceUpdateEditor")},[]),n("div",{children:[e(Ve,{}),n("main",{className:Pt.main,children:[e(It,{}),e(hn,{})]})]})};function Sn(){const[t,s]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("isManageMent",!0),c.connect("isManagement",()=>{s(c.get("isManagement"))},"setIsManagementFunc")},[]),n("div",{className:"App",children:[t&&e(Me,{}),!t&&e(gn,{})]})}we.render(e(Fe.StrictMode,{children:e(Sn,{})}),document.getElementById("root"));
