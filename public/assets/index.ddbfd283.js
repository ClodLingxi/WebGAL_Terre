import{f as he,r,a as A,j as s,b as e,G as ge,P as X,L as pe,m as fe,F as Y,N as Se,E as _e,c as Ne,D as ve,V as xe,d as q,A as R,e as W,g as U,R as Ce,U as Ee,h as Be,i as $,k as we,l as Fe,S as z,n as Ie,o as Ae,C as Z,p as ee,q as te,s as ne,t as ye,u as De,v as ke,w as se,x as ie,y as Pe,z as ae,B as ce,H as be,I as Le}from"./vendor.14a14191.js";const Te=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))h(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const p of l.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&h(p)}).observe(document,{childList:!0,subtree:!0});function d(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function h(o){if(o.ep)return;o.ep=!0;const l=d(o);fetch(o.href,l)}};Te();const ze="_nav_v57rx_1",Ge="_title_v57rx_11",Oe="_subTitle_v57rx_18",$e="_main_v57rx_26",Me="_gameList_v57rx_30",je="_singleGameEntryButton_v57rx_36",qe="_buttonIcon_v57rx_51",Re="_addTitle_v57rx_55",We="_addIcon_v57rx_61",Ue="_createPanel_v57rx_77",Ve="_createPanelTitle_v57rx_89",Je="_createPanelInput_v57rx_95",He="_createButton_v57rx_102";var y={nav:ze,title:Ge,subTitle:Oe,main:$e,gameList:Me,singleGameEntryButton:je,buttonIcon:qe,addTitle:Re,addIcon:We,createPanel:Ue,createPanelTitle:Ve,createPanelInput:Je,createButton:He};const c=new he;c.set("updateEditor",!0);const oe={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[],sceneScrollTop:{},isRealtimeRefreashPreview:!0,wsConn:null},n=JSON.parse(JSON.stringify(oe)),Ke=()=>{const[t,i]=r.exports.useState(!0),[d,h]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refManagement",t),c.connect("refManagement",()=>{i(c.get("refManagement"))},"refManagementFunc"),o()},[]);const o=()=>{A.get(n.domain+"/api/manageGame/gameList").then(u=>{n.gameList=u.data,c.set("refManagement",!c.get("refManagement"))}).catch(u=>{console.log(u)})};let l=[];for(const u of n.gameList){const m=s("div",{className:y.singleGameEntryButton,onClick:()=>{for(const _ in n)n[_]=oe[_];n.currentEditGame=u,c.set("isManagement",!1)},children:[e(ge,{theme:"outline",size:"18",fill:"#333",className:y.buttonIcon}),u]},u);l.push(m)}const p=u=>{const m=`${n.domain}/api/manageGame/createGame/${u}`;A.get(m).then(_=>{h(!1),o()})};return s("div",{children:[e("header",{children:e("nav",{children:e("div",{className:y.nav,children:e("div",{children:e("span",{className:y.title,children:"WebGAL ORIGINE"})})})})}),s("main",{className:y.main,children:[s("div",{className:y.subTitle,children:[e("span",{className:y.addTitle,children:"\u6E38\u620F\u5217\u8868"}),s("div",{children:[s("span",{onClick:()=>h(!d),className:y.addIcon,children:[e(X,{theme:"outline",size:"16",fill:"#434343",style:{padding:"0 5px 0 0 "}}),"\u65B0\u5EFA\u6E38\u620F"]}),d&&s("div",{className:y.createPanel,children:[e("div",{className:y.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),s("div",{children:["\u6E38\u620F\u540D\u79F0",e("input",{id:"createInput",className:y.createPanelInput})]}),e("div",{style:{textAlign:"center"},children:e("div",{onClick:()=>p(document.getElementById("createInput").value),className:y.createButton,children:"\u521B\u5EFA"})})]})]})]}),e("div",{className:y.gameList,children:l})]})]})},Qe="_nav_15oeu_1",Xe="_title_15oeu_14",Ye="_titleIcon_15oeu_21",Ze="_ejectButon_15oeu_31";var G={nav:Qe,title:Xe,titleIcon:Ye,ejectButon:Ze};const et=()=>{const t=i=>{A.post(n.domain+"/api/manageGame/export",{gameName:n.currentEditGame,platform:i}).then(d=>{console.log(d.data),fe.success(`\u6E38\u620F\u5DF2\u88AB\u5BFC\u51FA\u81F3 Exported_Games/${n.currentEditGame}/${i}`).then()})};return s("div",{className:G.nav,children:[e(pe,{theme:"filled",size:"30",fill:"#333",className:G.titleIcon,onClick:()=>{c.set("isManagement",!0)}}),e("div",{className:G.title,children:"WebGAL ORIGINE"}),e("div",{style:{marginLeft:"auto"},className:G.ejectButon,onClick:()=>{t("web")},children:"\u5BFC\u51FA\u6E38\u620F\u4E3A\u7F51\u9875"}),e("div",{className:G.ejectButon,onClick:()=>{t("electron-windows")},children:"\u5BFC\u51FA\u6E38\u620F\u4E3A\u53EF\u6267\u884C\u6587\u4EF6"})]})},tt="_aside_1yqyp_1",nt="_option_1yqyp_11",st="_optionMarker_1yqyp_20",it="_optionMarkerOff_1yqyp_28",at="_chooseItem_1yqyp_36",ct="_chooseTitle_1yqyp_47",ot="_chooseDescription_1yqyp_52",dt="_tagButton_1yqyp_57",lt="_tagButtonOn_1yqyp_74",rt="_sideBarContent_1yqyp_81",ut="_previewWindow_1yqyp_88",mt="_sideBarMain_1yqyp_93",ht="_asidePreviewControlBar_1yqyp_102",gt="_gamePrevTitle_1yqyp_111",pt="_asidePreviewControlBar_button_1yqyp_119",ft="_asidePreviewControlBar_single_1yqyp_133";var I={aside:tt,option:nt,optionMarker:st,optionMarkerOff:it,chooseItem:at,chooseTitle:ct,chooseDescription:ot,tagButton:dt,tagButtonOn:lt,sideBarContent:rt,previewWindow:ut,sideBarMain:mt,asidePreviewControlBar:ht,gamePrevTitle:gt,asidePreviewControlBar_button:pt,asidePreviewControlBar_single:ft};const St="_title_11hgn_1",_t="_previewGameButton_11hgn_10",Nt="_gameNameInput_11hgn_19",vt="_optionContent_11hgn_32";var k={title:St,previewGameButton:_t,gameNameInput:Nt,optionContent:vt};const xt="_choosed_x0o7b_1",Ct="_chooseBox_x0o7b_7",Et="_chooseIcon_x0o7b_11",Bt="_chooseTitle_x0o7b_23",wt="_fileList_x0o7b_33",Ft="_singleFile_x0o7b_47",It="_fileIcon_x0o7b_63";var P={choosed:xt,chooseBox:Ct,chooseIcon:Et,chooseTitle:Bt,fileList:wt,singleFile:Ft,fileIcon:It};const D=t=>{const[i,d]=r.exports.useState(!1),[h,o]=r.exports.useState(t.dir),[l,p]=r.exports.useState([]),[u,m]=r.exports.useState(""),_=f=>{const C={dir:`/${n.currentEditGame}/game/${f}`};A.post(`${n.domain}/api/editGame/getAssets/`,C).then(E=>{p(E.data)}).catch(E=>{console.log(E)})},x=f=>{let g=f.split("/");f="";let C=0;for(const E of g)E!==t.dir&&(C!==0&&(f=f+"/"),C++,f=f+E);return f},N=f=>{let g=h+"/"+f;g=x(g),t.set(g),t.hasOwnProperty("setShow")&&t.setShow(g)};r.exports.useEffect(()=>{_(h)},[]);let v=[];for(const f of l){let g=!0,C=!0;f.match(/\.json/)&&(C=!1),f.match(/\./)&&(g=!1);let E=e("div",{children:""});g?E=s("div",{className:P.singleFile,onClick:()=>{const F=h+"/"+f;o(F),_(F)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",className:P.fileIcon}),f]},f):E=s("div",{className:P.singleFile,onClick:()=>{m(x(h+"/"+f)),N(f),d(!i)},children:[e(Se,{theme:"outline",size:"18",fill:"#333",className:P.fileIcon}),f]},f),C&&v.push(E)}return s("div",{children:[e("div",{className:P.chooseBox,children:s("div",{className:P.chooseIcon,onClick:()=>{i===!1&&(o(t.dir),m(""),_(t.dir)),d(!i)},children:[e(_e,{theme:"outline",size:"16",fill:"#333"}),e("span",{className:P.chooseTitle,children:"\u9009\u62E9\u6587\u4EF6"})]})}),e("div",{style:{position:"relative"},children:i&&e("div",{className:P.fileList,children:v})})]})},At=()=>{r.exports.useState(!1);const[t,i]=r.exports.useState(""),[d,h]=r.exports.useState(""),[o,l]=r.exports.useState(""),p=()=>{A.get(`${n.domain}/Games/${n.currentEditGame}/game/gameConfig.json`).then(N=>{let v=N.data;n.currentGameConfig=N.data,document.getElementById("gameNameInput").value=v.Game_name,i(v.Title_bgm),h(v.Title_img),l(v.Loading_img)})},u=()=>{n.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,x()},m=(N,v)=>{n.currentGameConfig[N]=v,x()},_=N=>v=>{m(N,v)},x=()=>{let N={currentEditGame:n.currentEditGame,config:n.currentGameConfig};A.post(`${n.domain}/api/manageGame/config`,N).then(v=>{})};return r.exports.useEffect(()=>{p()},[]),s("div",{style:{width:"100%"},children:[e("div",{children:e("a",{style:{color:"black",textDecoration:"none"},href:`${n.domain}/Games/${n.currentEditGame}`,target:"_blank",children:s("div",{className:k.previewGameButton,children:[e(Ne,{theme:"outline",size:"24",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,5px)"}}),"\u5728\u65B0\u6807\u7B7E\u9875\u9884\u89C8\u6E38\u620F"]})})}),s("div",{children:[e("div",{className:k.title,children:"\u6E38\u620F\u540D\u79F0"}),e("div",{className:k.optionContent,children:e("input",{onBlur:u,id:"gameNameInput",className:k.gameNameInput})})]}),s("div",{children:[e("div",{className:k.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),s("div",{className:k.optionContent,children:[t,e(D,{setShow:i,id:"bgmPicker",dir:"bgm",set:_("Title_bgm")})]})]}),s("div",{children:[e("div",{className:k.title,children:"\u6807\u9898\u80CC\u666F"}),s("div",{className:k.optionContent,children:[d,e(D,{setShow:h,id:"bgPicker",dir:"background",set:_("Title_img")})]})]})]})},yt="_main_z7pjj_2",Dt="_dirButtonContainer_z7pjj_8",kt="_icon_small_z7pjj_14",Pt="_controlPanel_z7pjj_21",bt="_upload_z7pjj_25",Lt="_dirButton_z7pjj_8",Tt="_fileElement_z7pjj_47",zt="_title_z7pjj_64",Gt="_currentDirShow_z7pjj_74",Ot="_panelButton_z7pjj_84",$t="_uploadTitle_z7pjj_96",Mt="_uploadButton_z7pjj_104";var B={main:yt,dirButtonContainer:Dt,icon_small:kt,controlPanel:Pt,upload:bt,dirButton:Lt,fileElement:Tt,title:zt,currentDirShow:Gt,panelButton:Ot,uploadTitle:$t,uploadButton:Mt};const de={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},le=t=>{let i=e(Y,{theme:"outline",size:"22",fill:"#333"});switch(t.icon){case"background":i=e(U,{theme:"outline",size:"22",fill:"#333"});break;case"bgm":i=e(W,{theme:"outline",size:"22",fill:"#333"});break;case"figure":i=e(R,{theme:"outline",size:"22",fill:"#333"});break;case"video":i=e(q,{theme:"outline",size:"22",fill:"#333"});break;case"vocal":i=e(xe,{theme:"outline",size:"22",fill:"#333"});break;case"file":i=e(ve,{theme:"outline",size:"22",fill:"#333"})}return i},jt=()=>{const[t,i]=r.exports.useState(!0),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refAssetsManagement",t),c.connect("refAssetsManagement",()=>{i(c.get("refAssetsManagement"))},"refAssetsManagement"),p()},[]);const p=()=>{const g=n.currentEditGame,C=n.currentDir,E={dir:`/${g}/game/${C}`};A.post(`${n.domain}/api/editGame/getAssets/`,E).then(F=>{n.currentDirContent=F.data,c.set("refAssetsManagement",!c.get("refAssetsManagement"))}).catch(F=>{console.log(F)})},u=()=>{if(n.currentDir==="")return;let g=n.currentDir.split("/");g.pop(),n.currentDir=g.reduce((C,E)=>""+C+"/"+E),p()},m=g=>{n.currentDir=n.currentDir+`/${g}`,p()},_=()=>{const g=n.currentEditGame,C=n.currentDir,E=`/${g}/game/${C}`;let F=new FormData;F.append("dir",E);const j=document.getElementById("uploadFile").files[0];let O=document.getElementById("uploadFile").value;F.append("file",j,O),A.post(`${n.domain}/api/editGame/addAsset/`,F,{headers:{"Content-Type":"multipart/form-data"}}).then(Q=>{h(!1),p()}).catch(Q=>{console.log(Q)})},x=()=>{const g=n.currentEditGame,C=n.currentDir,E=`/${g}/game/${C}`,F=document.getElementById("addDirInput").value,j={current:E,Name:F};A.post(`${n.domain}/api/editGame/mkdir/`,j).then(O=>{l(!1),p()}).catch(O=>{console.log(O)})},N=()=>{h(!d)},v=()=>{l(!o)},f=[];for(const g of n.currentDirContent){let C="",E=!0;if(g.match(/\./))n.currentDir===""&&(E=!1),C=s("div",{className:B.fileElement,children:[e("span",{className:B.icon_small,children:e(le,{icon:"file"})}),g]},g);else{let F=g;n.currentDir===""&&de.hasOwnProperty(g)&&(F=de[g]),C=s("div",{className:B.dirButton,onClick:()=>m(g),children:[e("span",{className:B.icon_small,children:e(le,{icon:g})}),F]},g),g==="scene"&&n.currentDir===""&&(E=!1)}E&&f.push(C)}return s("div",{className:B.main,children:[n.currentDir!==""&&e("div",{className:B.currentDirShow,children:n.currentDir}),n.currentDir!==""&&s("div",{className:B.controlPanel,children:[e("div",{children:e(Ce,{theme:"outline",size:"24",fill:"#333",onClick:u,className:B.panelButton})}),s("div",{children:[e(Ee,{theme:"outline",size:"24",fill:"#333",onClick:N,className:B.panelButton}),d&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u4E0A\u4F20\u6587\u4EF6"}),e("input",{id:"uploadFile",type:"file"}),e("div",{className:B.uploadButton,onClick:_,children:"\u4E0A\u4F20"})]})]}),s("div",{children:[e(Be,{theme:"outline",size:"24",fill:"#333",onClick:v,className:B.panelButton}),o&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"}),e("input",{id:"addDirInput"}),e("div",{className:B.uploadButton,onClick:x,children:"\u65B0\u5EFA"})]})]})]}),e("div",{}),e("div",{className:B.dirButtonContainer,children:f})]})},qt="_main_1p8zt_1",Rt="_addInput_1p8zt_12",Wt="_title_1p8zt_21",Ut="_addButton_1p8zt_29";var M={main:qt,addInput:Rt,title:Wt,addButton:Ut};const Vt=t=>{const i=()=>{const d={gameName:n.currentEditGame,sceneName:document.getElementById("addSceneName").value};A.post(`${n.domain}/api/editGame/addNewScene/`,d).then(h=>{t.added()}).catch(h=>{console.log(h)})};return s("div",{className:M.main,children:[s("div",{className:M.title,children:["\u573A\u666F\u540D\u79F0",e("input",{className:M.addInput,id:"addSceneName"})]}),e("div",{className:M.addButton,onClick:i,children:"\u65B0\u5EFA\u573A\u666F"})]})},Jt="_titleText_juf2g_1",Ht="_scene_juf2g_11",Kt="_newSceneButton_juf2g_22",Qt="_sceneList_juf2g_35";var V={titleText:Jt,scene:Ht,newSceneButton:Kt,sceneList:Qt};const J=()=>{n.currentEditScene!==""&&(n.sceneScrollTop[n.currentEditScene]=document.getElementById("currentSentenceList").scrollTop)},Xt=()=>{const[t,i]=r.exports.useState([]),[d,h]=r.exports.useState(!1),o=()=>{const x={dir:`/${n.currentEditGame}/game/scene`};A.post(`${n.domain}/api/editGame/getAssets/`,x).then(N=>{i(N.data)}).catch(N=>{console.log(N)})},l=()=>{o(),h(!d)};r.exports.useEffect(()=>{o()},[]);const p=m=>{n.currentOpendSceneEdit.includes(m)||n.currentOpendSceneEdit.push(m),J(),n.currentEditScene=m,c.set("updateEditor",!c.get("updateEditor"))},u=[];for(const m of t){let _=!1,x=m.split(".");x[x.length-1]==="json"&&(_=!0);const N=s("div",{className:V.scene,onClick:()=>p(m),children:[e($,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),m]},m);_&&u.push(N)}return s("div",{style:{width:"100%"},children:[s("div",{className:V.newSceneButton,onClick:()=>{h(!d)},children:[e(we,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0",transform:"translate(0,2px)"}}),"\u65B0\u5EFA\u573A\u666F"]}),e("div",{children:d&&e(Vt,{added:l})}),e("div",{className:V.sceneList,children:u})]})},Yt=()=>{const t=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[i,d]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refSideBar",i),c.connect("refSideBar",()=>{d(c.get("refSideBar"))},"refSideBarFunc")},[]);const h=[];for(const u of t){let m="#333";u===n.editorTag?(I.optionMarker,m="#8e354a"):I.optionMarkerOff;let _=e(Ie,{theme:"outline",size:"14",fill:m});u==="\u7D20\u6750\u7BA1\u7406"&&(_=e(Ae,{theme:"outline",size:"14",fill:m})),u==="\u573A\u666F\u7BA1\u7406"&&(_=e($,{theme:"outline",size:"14",fill:m}));const x=e("div",{className:u===n.editorTag?I.tagButton+" "+I.tagButtonOn:I.tagButton,onClick:()=>{n.editorTag=u,c.set("refSideBar",!c.get("refSideBar"))},children:s("div",{children:[_,e("span",{style:{margin:"0 5px 0 0 "}}),u]})},u);h.push(x)}let o;switch(n.editorTag){case"\u6E38\u620F\u914D\u7F6E":o=e(At,{});break;case"\u7D20\u6750\u7BA1\u7406":o=e(jt,{});break;case"\u573A\u666F\u7BA1\u7406":o=e(Xt,{});break}function l(u){n.isRealtimeRefreashPreview=u}function p(){const u=document.getElementById("gamePreviewIframe");u.src="",u.src=`${n.domain}/Games/${n.currentEditGame}`}return s("aside",{className:I.aside,children:[s("div",{className:I.asidePreviewControlBar,children:[e("div",{className:I.asidePreviewControlBar_single,children:e("span",{className:I.gamePrevTitle,children:"\u6E38\u620F\u9884\u89C8"})}),s("div",{id:"refPreviewButton",className:I.asidePreviewControlBar_button,onClick:p,children:[e(Fe,{style:{transform:"translate(0,0)",margin:"0 3px 0 0 "},theme:"outline",size:"14",fill:"#000",strokeWidth:3}),"\u5237\u65B0"]}),s("div",{className:I.asidePreviewControlBar_single,children:["\u5B9E\u65F6\u66F4\u65B0",e("span",{style:{margin:"0 10px 0 0 "}}),e(z,{defaultChecked:!0,onChange:l,size:"small"})]})]}),e("iframe",{id:"gamePreviewIframe",frameBorder:"0",className:I.previewWindow,src:`${n.domain}/Games/${n.currentEditGame}`}),s("div",{className:I.sideBarMain,children:[e("div",{className:I.option,children:h}),e("div",{className:I.sideBarContent,children:o})]})]})},Zt="_main_r7n8t_1";var en={main:Zt};const tn="_main_1m1df_1",nn="_tag_1m1df_8",sn="_tagOpened_1m1df_19",an="_tagList_1m1df_26",cn="_tagIcon_1m1df_33",on="_closeIcon_1m1df_38";var b={main:tn,tag:nn,tagOpened:sn,tagList:an,tagIcon:cn,closeIcon:on};const dn="_main_1m4ta_1",ln="_topButtonList_1m4ta_5",rn="_topButton_1m4ta_5",un="_addSentencePanel_1m4ta_32",mn="_addSentencePanel_main_1m4ta_44",hn="_addSentenceButton_1m4ta_57",gn="_sentenceList_1m4ta_67",pn="_sentence_1m4ta_67",fn="_sentenceIn_1m4ta_1",Sn="_lineNumber_1m4ta_81",_n="_sentenceMain_1m4ta_91",Nn="_addItemIcon_1m4ta_105";var S={main:dn,topButtonList:ln,topButton:rn,addSentencePanel:un,addSentencePanel_main:mn,addSentenceButton:hn,sentenceList:gn,sentence:pn,sentenceIn:fn,lineNumber:Sn,sentenceMain:_n,addItemIcon:Nn};const vn=t=>{let i;switch(t){case"dialog":i={type:t,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":i={type:t,bg:"",noBg:!1,next:!1};break;case"bgm":i={type:t,bgm:"",noBgm:!1};break;case"changeScene":i={type:t,newScene:""};break;case"video":i={type:t,video:""};break;case"changeP":i={type:t,newP:"",next:!1,noP:!1,pos:""};break;case"choose":i={type:t,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break;case"intro":i={type:t,content:[]};break}return i},xn="_sentence_leq4c_1",Cn="_dialog_input_leq4c_7",En="_singleOption_leq4c_14",Bn="_optionTitle_leq4c_22",wn="_dialog_edit_title_leq4c_29",Fn="_optionContent_leq4c_34",In="_isolate_leq4c_38",An="_sentenceButtonList_leq4c_43",yn="_sentenceButton_leq4c_43",Dn="_sentenceIndexShow_leq4c_67",kn="_barContainer_leq4c_82",Pn="_mainEdit_leq4c_93",bn="_topContainer_leq4c_101";var a={sentence:xn,dialog_input:Cn,singleOption:En,optionTitle:Bn,dialog_edit_title:wn,optionContent:Fn,isolate:In,sentenceButtonList:An,sentenceButton:yn,sentenceIndexShow:Dn,barContainer:kn,mainEdit:Pn,topContainer:bn};const Ln=t=>{n.currentSceneSentenceList.splice(t,1),c.set("writeScene",!c.get("writeScene"))},re=(t,i)=>{if(!(t===0&&i===-1||t===n.currentSceneSentenceList.length-1&&i===1)){{const d=n.currentSceneSentenceList[t];n.currentSceneSentenceList.splice(t,1),n.currentSceneSentenceList.splice(t+i,0,d)}c.set("writeScene",!c.get("writeScene"))}},ue=t=>e("div",{style:{lineHeight:"18px"},children:s("div",{className:S.addSentencePanel,children:[s("div",{className:S.addSentenceButton,onClick:()=>{w("dialog",t.index)},children:[e(Z,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeP",t.index)},children:[e(R,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bg",t.index)},children:[e(U,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeScene",t.index)},children:[e(ee,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("choose",t.index)},children:[e(te,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bgm",t.index)},children:[e(W,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("video",t.index)},children:[e(q,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("intro",t.index)},children:[e(ne,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u9ED1\u5C4F\u6587\u5B57"]})]})}),L=t=>s("div",{className:a.sentenceButtonList,children:[s("div",{className:a.sentenceButton,onClick:()=>{Ln(t.index)},children:[e(ye,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),s("div",{onClick:()=>{re(t.index,-1)},className:a.sentenceButton,children:[e(De,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{re(t.index,1)},className:a.sentenceButton,children:[e(ke,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{t.data.setShowAddPre(!t.data.showAddPre)},className:a.sentenceButton,children:[e(se,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",t.data.showAddPre&&e(ue,{index:t.data.indexPre})]}),s("div",{onClick:()=>{t.data.setShowAddAfter(!t.data.showAddAfter)},className:a.sentenceButton,children:[e(se,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",t.data.showAddAfter&&e(ue,{index:t.data.indexAfter})]})]}),T=t=>{const i=n.wsConn;n.isRealtimeRefreashPreview&&setTimeout(()=>{i.send(`jmp ${n.currentEditScene} ${t+1}`)},500)},Tn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1),p=t.index,u=t.index+1,m={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:l,indexPre:p,indexAfter:u};r.exports.useEffect(()=>{document.getElementById("speakerInput"+t.index).value=t.data.speaker,document.getElementById("contentInput"+t.index).value=t.data.content});const _=()=>{n.currentSceneSentenceList[t.index].speaker=document.getElementById("speakerInput"+t.index).value,n.currentSceneSentenceList[t.index].content=document.getElementById("contentInput"+t.index).value,c.set("writeScene",!c.get("writeScene")),i()},x=v=>{n.currentSceneSentenceList[t.index].ignoreSpeaker=v,c.set("writeScene",!c.get("writeScene")),i()},N=()=>v=>{n.currentSceneSentenceList[t.index].vocal=v,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u57FA\u672C\u5BF9\u8BDD"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:m})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.dialog_edit_title,children:"\u89D2\u8272\uFF1A"}),e("input",{className:a.dialog_input,onBlur:_,id:"speakerInput"+t.index}),e("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.dialog_edit_title,children:"\u5BF9\u8BDD\uFF1A"}),e("textarea",{className:a.dialog_input,onBlur:_,id:"contentInput"+t.index})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u65C1\u767D\u6A21\u5F0F"}),s("span",{className:a.optionContent,children:[e(z,{size:"small",id:"dialog_pbms",checked:t.data.ignoreSpeaker,onChange:x}),"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"]}),e("div",{className:a.optionTitle,children:"\u914D\u97F3\u6587\u4EF6"}),e(D,{setShow:()=>{},id:"vocalPicker",dir:"vocal",set:N()}),e("span",{className:a.optionContent,children:t.data.vocal})]})]})]},t.index+"dialog")},zn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1),p=t.index,u=t.index+1,m={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:l,indexPre:p,indexAfter:u};r.exports.useEffect(()=>{});const _=v=>{n.currentSceneSentenceList[t.index].noBg=v,c.set("writeScene",!c.get("writeScene")),i()},x=v=>{n.currentSceneSentenceList[t.index].next=v,c.set("writeScene",!c.get("writeScene")),i()},N=()=>v=>{n.currentSceneSentenceList[t.index].bg=v,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u66F4\u6539\u80CC\u666F"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:m})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u80CC\u666F"}),s("span",{className:a.optionContent,children:[e(z,{size:"small",checked:t.data.noBg,id:"bg_none"+t.index,onChange:_}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"]}),e("span",{className:a.optionTitle,children:"\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5"}),e("span",{className:a.optionContent,children:e(z,{size:"small",id:"bg_next"+t.index,checked:t.data.next,onChange:x})})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u80CC\u666F\u6587\u4EF6"}),e(D,{setShow:()=>{},id:"bgPicker",dir:"background",set:N()}),e("span",{className:a.optionContent,children:t.data.bg})]})]})]},t.index+"bg")},Gn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1),p=t.index,u=t.index+1,m={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:l,indexPre:p,indexAfter:u};r.exports.useEffect(()=>{});const _=N=>{n.currentSceneSentenceList[t.index].noBgm=N,c.set("writeScene",!c.get("writeScene")),i()},x=()=>N=>{n.currentSceneSentenceList[t.index].bgm=N,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u66F4\u6539\u97F3\u4E50"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:m})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u80CC\u666F\u97F3\u4E50"}),s("span",{className:a.optionContent,children:[e(z,{size:"small",id:"bgm_none"+t.index,checked:t.data.noBgm,onChange:_}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"]})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u80CC\u666F\u97F3\u4E50\u6587\u4EF6"}),e(D,{setShow:()=>{},id:"bgmPicker",dir:"bgm",set:x()}),e("span",{className:a.optionContent,children:t.data.bgm})]})]})]},t.index+"bgm")},On=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1),p=t.index,u=t.index+1,m={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:l,indexPre:p,indexAfter:u};r.exports.useEffect(()=>{});const _=()=>x=>{n.currentSceneSentenceList[t.index].newScene=x,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5207\u6362\u573A\u666F"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:m})})]}),e("main",{className:a.mainEdit,children:s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u65B0\u573A\u666F"}),e(D,{setShow:()=>{},id:"scenePicker",dir:"scene",set:_()}),e("span",{className:a.optionContent,children:t.data.newScene})]})})]},t.index+"scene")},$n=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1),p=t.index,u=t.index+1,m={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:l,indexPre:p,indexAfter:u};r.exports.useEffect(()=>{});const _=()=>x=>{n.currentSceneSentenceList[t.index].video=x,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u64AD\u653E\u89C6\u9891"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:m})})]}),e("main",{className:a.mainEdit,children:s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u89C6\u9891\u6587\u4EF6"}),e(D,{setShow:()=>{},id:"videoPicker",dir:"video",set:_()}),e("span",{className:a.optionContent,children:t.data.video})]})})]},t.index+"scene")},{Option:H}=ie,Mn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1),p=t.index,u=t.index+1,m={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:l,indexPre:p,indexAfter:u};r.exports.useEffect(()=>{});const _=f=>{n.currentSceneSentenceList[t.index].noP=f,c.set("writeScene",!c.get("writeScene")),i()},x=f=>{n.currentSceneSentenceList[t.index].next=f,c.set("writeScene",!c.get("writeScene")),i()},N=()=>f=>{n.currentSceneSentenceList[t.index].newP=f,c.set("writeScene",!c.get("writeScene")),i()},v=f=>{n.currentSceneSentenceList[t.index].pos=f,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5207\u6362\u7ACB\u7ED8"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:m})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u7ACB\u7ED8"}),e("span",{className:a.optionContent,children:e(z,{size:"small",id:"p_none",checked:t.data.noP,onChange:_})}),e("span",{className:a.optionContent,children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"}),e("span",{className:a.optionTitle,children:"\u7ACB\u7ED8\u4F4D\u7F6E"}),s(ie,{size:"small",defaultValue:t.data.pos,style:{width:120},onChange:v,children:[e(H,{value:"left",children:"\u5DE6"}),e(H,{value:"",children:"\u4E2D"}),e(H,{value:"right",children:"\u53F3"})]}),e("span",{className:a.optionContent,children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),e("span",{className:a.optionContent,children:e(z,{size:"small",id:"p_none",checked:t.data.next,onChange:x})})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u7ACB\u7ED8\u6587\u4EF6"}),e(D,{setShow:()=>{},id:"pPicker",dir:"figure",set:N()}),e("span",{className:a.optionContent,children:t.data.newP})]})]})]},t.index+"dialog")},jn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1),p=t.index,u=t.index+1,m={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:l,indexPre:p,indexAfter:u};r.exports.useEffect(()=>{for(let g=0;g<t.data.chooseItem.length;g++)document.getElementById("chooseInput"+t.index+"itemIndex"+g).value=t.data.chooseItem[g].text});const _=()=>{n.currentSceneSentenceList[t.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),c.set("writeScene",!c.get("writeScene")),i()},x=g=>{const C=parseInt(g.split("Index")[1]);console.log(C),n.currentSceneSentenceList[t.index].chooseItem[C].text=document.getElementById(g).value,c.set("writeScene",!c.get("writeScene")),i()},N=g=>C=>{n.currentSceneSentenceList[t.index].chooseItem[g].scene=C,c.set("writeScene",!c.get("writeScene")),i()};let v=[],f=0;for(const g of t.data.chooseItem){const C="chooseInput"+t.index+"itemIndex"+f;let E=s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5206\u652F\u540D\u79F0"}),e("input",{className:a.dialog_input,style:{width:"200px"},onBlur:()=>{x(C)},id:C}),e("span",{className:a.optionContent,children:e(Pe,{theme:"outline",size:"24",fill:"#333"})}),e("span",{className:a.optionTitle,children:"\u8DF3\u8F6C\u7684\u573A\u666F"}),e(D,{id:"scenePicker",dir:"scene",set:N(f)}),e("span",{className:a.optionContent,children:g.scene})]},f);v.push(E),f++}return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5206\u652F\u9009\u62E9"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:m})})]}),s("main",{className:a.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:_,className:a.sentenceButton,children:[e(ae,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),v]})]},t.index+"choose")},qn=t=>{const i=()=>T(t.index),[d,h]=r.exports.useState(!1),[o,l]=r.exports.useState(!1),p=t.index,u=t.index+1,m={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:l,indexPre:p,indexAfter:u};r.exports.useEffect(()=>{for(let f=0;f<t.data.content.length;f++)document.getElementById("introInput"+t.index+"itemIndex"+f).value=t.data.content[f]});const _=()=>{n.currentSceneSentenceList[t.index].content.push("\u5728\u6B64\u586B\u5165\u8981\u5C55\u793A\u7684\u6587\u5B57"),c.set("writeScene",!c.get("writeScene")),i()},x=f=>{const g=parseInt(f.split("Index")[1]);console.log(g),n.currentSceneSentenceList[t.index].content[g]=document.getElementById(f).value,c.set("writeScene",!c.get("writeScene")),i()};let N=[],v=0;for(const f of t.data.content){const g="introInput"+t.index+"itemIndex"+v;let C=s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u663E\u793A\u6587\u5B57"}),e("input",{className:a.dialog_input,style:{width:"200px"},onBlur:()=>{x(g)},id:g})]},v);N.push(C),v++}return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u9ED1\u5C4F\u6587\u5B57"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:m})})]}),s("main",{className:a.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:_,className:a.sentenceButton,children:[e(ae,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u6587\u5B57"]})}),N]})]},t.index+"intro")},Rn=(t,i)=>{let d;switch(t.type){case"dialog":d=e(Tn,{data:t,index:i},i);break;case"bg":d=e(zn,{data:t,index:i},i);break;case"bgm":d=e(Gn,{data:t,index:i},i);break;case"changeScene":d=e(On,{data:t,index:i},i);break;case"video":d=e($n,{data:t,index:i},i);break;case"changeP":d=e(Mn,{data:t,index:i},i);break;case"choose":d=e(jn,{data:t,index:i},i);break;case"intro":d=e(qn,{data:t,index:i},i);break}return d};const Wn=t=>{const[i,d]=r.exports.useState(!0),[h,o]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateScene",i),c.connect("updateScene",()=>{d(c.get("updateScene"))},"updateSceneFunc"),c.set("refScene",!0),c.connect("refScene",()=>{K()},"refSceneFunc"),c.get("writeScene")===void 0&&c.set("writeScene",!0),c.connect("writeScene",()=>{me()},"writeSceneFunc"),K(),n.sceneScrollTop.hasOwnProperty(n.currentEditScene)&&setTimeout(()=>{document.getElementById("currentSentenceList").scrollTop=n.sceneScrollTop[n.currentEditScene]},0)},[]);let l=[];const p=JSON.parse(JSON.stringify(n.currentSceneSentenceList));console.log("\u91CD\u65B0\u6E32\u67D3"),console.log(p);for(let m=0;m<p.length;m++){const _=p[m],x=Rn(_,m),N=s("div",{id:"sentence"+m+n.currentEditScene,className:S.sentence,children:[e("div",{className:S.lineNumber,children:m+1}),e("div",{className:S.sentenceMain,children:x})]},"sentence"+m+n.currentEditScene);l.push(N)}const u=s("div",{className:S.addSentencePanel_main,children:[s("div",{className:S.addSentenceButton,onClick:()=>{w("dialog"),o(!1)},children:[e(Z,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeP"),o(!1)},children:[e(R,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bg"),o(!1)},children:[e(U,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeScene"),o(!1)},children:[e(ee,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("choose"),o(!1)},children:[e(te,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bgm"),o(!1)},children:[e(W,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("video"),o(!1)},children:[e(q,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("intro"),o(!1)},children:[e(ne,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u9ED1\u5C4F\u6587\u5B57"]})]});return s("div",{className:S.main,id:n.currentEditScene,children:[s("div",{className:S.topButtonList,children:[e("div",{className:S.topButton,onClick:()=>{o(!h)},children:e(X,{theme:"outline",size:"24",fill:"#fff"})}),e("div",{children:h&&u})]}),e("div",{className:S.sentenceList,id:"currentSentenceList",children:l})]},n.currentEditScene)};function K(){let t=n.currentEditScene;if(t==="")return;const i=`${n.domain}/Games/${n.currentEditGame}/game/scene/${t}`;A.get(i).then(d=>{n.currentSceneSentenceList=d.data,c.set("updateScene",!c.get("updateScene"))}).catch(d=>console.log(d))}function w(t,i){const d=vn(t);i!==void 0?n.currentSceneSentenceList.splice(i,0,d):n.currentSceneSentenceList.push(d),me()}function me(){const t=`${n.domain}/api/editGame/editScene/`,i={gameName:n.currentEditGame,sceneName:n.currentEditScene,sceneData:n.currentSceneSentenceList};A.post(t,i).then(d=>{K()}).catch(d=>console.log(d))}const Un=()=>{const[t,i]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateEditor",t),c.connect("updateEditor",()=>{i(c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},"updateEditorFunc")},[]);const d=l=>{J(),n.currentEditScene=l,c.set("updateEditor",!c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},h=l=>{J();const p=n.currentOpendSceneEdit.indexOf(l);n.currentOpendSceneEdit.splice(p,1);const u=n.currentOpendSceneEdit.length===0;l===n.currentEditScene&&(u?n.currentEditScene="":n.currentOpendSceneEdit.length<=p?n.currentEditScene=n.currentOpendSceneEdit[n.currentOpendSceneEdit.length-1]:n.currentEditScene=n.currentOpendSceneEdit[p]),c.set("updateEditor",!c.get("updateEditor"))},o=[];for(const l of n.currentOpendSceneEdit){let p;l===n.currentEditScene?p=s("div",{className:b.tagOpened,children:[e($,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),l,e(ce,{theme:"outline",size:"20",fill:"#333",className:b.closeIcon,onClick:()=>{h(l)}})]},l):p=s("div",{className:b.tag,onClick:()=>{d(l)},children:[e($,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),l,e(ce,{theme:"outline",size:"20",fill:"#333",className:b.closeIcon,onClick:u=>{u.preventDefault(),u.stopPropagation(),h(l)}})]},l),o.push(p)}return s("div",{className:b.main,children:[e("div",{className:b.tagList,children:o}),e("div",{children:n.currentEditScene!==""&&e(Wn,{sceneName:n.currentEditScene},n.currentEditScene)})]})},Vn=()=>{const[t,i]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("updateEditor",!0),c.connect("updateEditor",()=>{i(c.get("updateEditor"))},"ForceUpdateEditor");try{const h=`ws://${window.location.hostname}:9999`;console.log("\u6B63\u5728\u542F\u52A8socket\u8FDE\u63A5\u4F4D\u4E8E\uFF1A"+h);const o=new WebSocket(h);o.onopen=()=>{console.log("socket\u5DF2\u8FDE\u63A5"),o.send("WebGAL Origine \u5DF2\u548C Terre \u5EFA\u7ACB\u8FDE\u63A5")},o.onmessage=l=>{console.log("\u6536\u5230\u4FE1\u606F",l.data)},n.wsConn=o}catch{console.warn("ws\u8FDE\u63A5\u5931\u8D25")}},[]),s("div",{children:[e(et,{}),s("main",{className:en.main,children:[e(Yt,{}),e(Un,{})]})]})};function Jn(){const[t,i]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("isManageMent",!0),c.connect("isManagement",()=>{i(c.get("isManagement"))},"setIsManagementFunc"),console.log("WebGAL Origine 1.1.4"),console.log("Github: https://github.com/MakinoharaShoko/WebGAL "),console.log("Made with \u2764 by MakinoharaShoko")},[]),s("div",{className:"App",children:[t&&e(Ke,{}),!t&&e(Vn,{})]})}be.render(e(Le.StrictMode,{children:e(Jn,{})}),document.getElementById("root"));
