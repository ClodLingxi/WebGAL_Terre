import{f as he,r,a as y,j as s,b as e,G as ge,P as X,L as pe,F as Y,N as fe,E as Se,c as _e,D as ve,V as Ne,d as j,A as q,e as R,g as U,R as xe,U as Ce,h as Ee,i as O,k as Be,l as we,S as T,m as Fe,n as Ie,C as Z,o as ee,p as te,q as ne,s as Ae,t as ye,u as ke,v as se,w as ie,x as De,y as ae,z as ce,B as Pe,H as be}from"./vendor.846008d9.js";const Le=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))h(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const f of u.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&h(f)}).observe(document,{childList:!0,subtree:!0});function d(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function h(o){if(o.ep)return;o.ep=!0;const u=d(o);fetch(o.href,u)}};Le();const ze="_nav_v57rx_1",Te="_title_v57rx_11",Ge="_subTitle_v57rx_18",Oe="_main_v57rx_26",$e="_gameList_v57rx_30",Me="_singleGameEntryButton_v57rx_36",je="_buttonIcon_v57rx_51",qe="_addTitle_v57rx_55",Re="_addIcon_v57rx_61",Ue="_createPanel_v57rx_77",We="_createPanelTitle_v57rx_89",Ve="_createPanelInput_v57rx_95",Je="_createButton_v57rx_102";var A={nav:ze,title:Te,subTitle:Ge,main:Oe,gameList:$e,singleGameEntryButton:Me,buttonIcon:je,addTitle:qe,addIcon:Re,createPanel:Ue,createPanelTitle:We,createPanelInput:Ve,createButton:Je};const c=new he;c.set("updateEditor",!0);const oe={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[],sceneScrollTop:{},isRealtimeRefreashPreview:!0,wsConn:null},n=JSON.parse(JSON.stringify(oe)),He=()=>{const[t,i]=r.exports.useState(!0),[d,h]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refManagement",t),c.connect("refManagement",()=>{i(c.get("refManagement"))},"refManagementFunc"),o()},[]);const o=()=>{y.get(n.domain+"/api/manageGame/gameList").then(m=>{n.gameList=m.data,c.set("refManagement",!c.get("refManagement"))}).catch(m=>{console.log(m)})};let u=[];for(const m of n.gameList){const g=s("div",{className:A.singleGameEntryButton,onClick:()=>{for(const _ in n)n[_]=oe[_];n.currentEditGame=m,c.set("isManagement",!1)},children:[e(ge,{theme:"outline",size:"18",fill:"#333",className:A.buttonIcon}),m]},m);u.push(g)}const f=m=>{const g=`${n.domain}/api/manageGame/createGame/${m}`;y.get(g).then(_=>{h(!1),o()})};return s("div",{children:[e("header",{children:e("nav",{children:e("div",{className:A.nav,children:e("div",{children:e("span",{className:A.title,children:"WebGAL ORIGINE"})})})})}),s("main",{className:A.main,children:[s("div",{className:A.subTitle,children:[e("span",{className:A.addTitle,children:"\u6E38\u620F\u5217\u8868"}),s("div",{children:[s("span",{onClick:()=>h(!d),className:A.addIcon,children:[e(X,{theme:"outline",size:"16",fill:"#434343",style:{padding:"0 5px 0 0 "}}),"\u65B0\u5EFA\u6E38\u620F"]}),d&&s("div",{className:A.createPanel,children:[e("div",{className:A.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),s("div",{children:["\u6E38\u620F\u540D\u79F0",e("input",{id:"createInput",className:A.createPanelInput})]}),e("div",{style:{textAlign:"center"},children:e("div",{onClick:()=>f(document.getElementById("createInput").value),className:A.createButton,children:"\u521B\u5EFA"})})]})]})]}),e("div",{className:A.gameList,children:u})]})]})},Ke="_nav_1nq56_1",Qe="_title_1nq56_13",Xe="_titleIcon_1nq56_20";var W={nav:Ke,title:Qe,titleIcon:Xe};const Ye=()=>s("div",{className:W.nav,children:[e(pe,{theme:"filled",size:"30",fill:"#333",className:W.titleIcon,onClick:()=>{c.set("isManagement",!0)}}),e("div",{className:W.title,children:"WebGAL ORIGINE"})]}),Ze="_aside_1yqyp_1",et="_option_1yqyp_11",tt="_optionMarker_1yqyp_20",nt="_optionMarkerOff_1yqyp_28",st="_chooseItem_1yqyp_36",it="_chooseTitle_1yqyp_47",at="_chooseDescription_1yqyp_52",ct="_tagButton_1yqyp_57",ot="_tagButtonOn_1yqyp_74",dt="_sideBarContent_1yqyp_81",lt="_previewWindow_1yqyp_88",rt="_sideBarMain_1yqyp_93",ut="_asidePreviewControlBar_1yqyp_102",mt="_gamePrevTitle_1yqyp_111",ht="_asidePreviewControlBar_button_1yqyp_119",gt="_asidePreviewControlBar_single_1yqyp_133";var I={aside:Ze,option:et,optionMarker:tt,optionMarkerOff:nt,chooseItem:st,chooseTitle:it,chooseDescription:at,tagButton:ct,tagButtonOn:ot,sideBarContent:dt,previewWindow:lt,sideBarMain:rt,asidePreviewControlBar:ut,gamePrevTitle:mt,asidePreviewControlBar_button:ht,asidePreviewControlBar_single:gt};const pt="_title_11hgn_1",ft="_previewGameButton_11hgn_10",St="_gameNameInput_11hgn_19",_t="_optionContent_11hgn_32";var D={title:pt,previewGameButton:ft,gameNameInput:St,optionContent:_t};const vt="_choosed_10yxa_1",Nt="_chooseBox_10yxa_7",xt="_chooseIcon_10yxa_11",Ct="_chooseTitle_10yxa_22",Et="_fileList_10yxa_32",Bt="_singleFile_10yxa_46",wt="_fileIcon_10yxa_62";var P={choosed:vt,chooseBox:Nt,chooseIcon:xt,chooseTitle:Ct,fileList:Et,singleFile:Bt,fileIcon:wt};const k=t=>{const[i,d]=r.exports.useState(!1),[h,o]=r.exports.useState(t.dir),[u,f]=r.exports.useState([]),[m,g]=r.exports.useState(""),_=p=>{const N={dir:`/${n.currentEditGame}/game/${p}`};y.post(`${n.domain}/api/editGame/getAssets/`,N).then(E=>{f(E.data)}).catch(E=>{console.log(E)})},C=p=>{let l=p.split("/");p="";let N=0;for(const E of l)E!==t.dir&&(N!==0&&(p=p+"/"),N++,p=p+E);return p},v=p=>{let l=h+"/"+p;l=C(l),t.set(l),t.hasOwnProperty("setShow")&&t.setShow(l)};r.exports.useEffect(()=>{_(h)},[]);let x=[];for(const p of u){let l=!0,N=!0;p.match(/\.json/)&&(N=!1),p.match(/\./)&&(l=!1);let E=e("div",{children:""});l?E=s("div",{className:P.singleFile,onClick:()=>{const F=h+"/"+p;o(F),_(F)},children:[e(Y,{theme:"outline",size:"18",fill:"#333",className:P.fileIcon}),p]},p):E=s("div",{className:P.singleFile,onClick:()=>{g(C(h+"/"+p)),v(p),d(!i)},children:[e(fe,{theme:"outline",size:"18",fill:"#333",className:P.fileIcon}),p]},p),N&&x.push(E)}return s("div",{children:[e("div",{className:P.chooseBox,children:s("div",{className:P.chooseIcon,onClick:()=>{i===!1&&(o(t.dir),g(""),_(t.dir)),d(!i)},children:[e(Se,{theme:"outline",size:"16",fill:"#333"}),e("span",{className:P.chooseTitle,children:"\u9009\u62E9\u6587\u4EF6"})]})}),e("div",{style:{position:"relative"},children:i&&e("div",{className:P.fileList,children:x})})]})},Ft=()=>{r.exports.useState(!1);const[t,i]=r.exports.useState(""),[d,h]=r.exports.useState(""),[o,u]=r.exports.useState(""),f=()=>{y.get(`${n.domain}/Games/${n.currentEditGame}/game/gameConfig.json`).then(v=>{let x=v.data;n.currentGameConfig=v.data,document.getElementById("gameNameInput").value=x.Game_name,i(x.Title_bgm),h(x.Title_img),u(x.Loading_img)})},m=()=>{n.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,C()},g=(v,x)=>{n.currentGameConfig[v]=x,C()},_=v=>x=>{g(v,x)},C=()=>{let v={currentEditGame:n.currentEditGame,config:n.currentGameConfig};y.post(`${n.domain}/api/manageGame/config`,v).then(x=>{})};return r.exports.useEffect(()=>{f()},[]),s("div",{style:{width:"100%"},children:[e("div",{children:e("a",{style:{color:"black",textDecoration:"none"},href:`${n.domain}/Games/${n.currentEditGame}`,target:"_blank",children:s("div",{className:D.previewGameButton,children:[e(_e,{theme:"outline",size:"24",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,5px)"}}),"\u5728\u65B0\u6807\u7B7E\u9875\u9884\u89C8\u6E38\u620F"]})})}),s("div",{children:[e("div",{className:D.title,children:"\u6E38\u620F\u540D\u79F0"}),e("div",{className:D.optionContent,children:e("input",{onBlur:m,id:"gameNameInput",className:D.gameNameInput})})]}),s("div",{children:[e("div",{className:D.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),s("div",{className:D.optionContent,children:[t,e(k,{setShow:i,id:"bgmPicker",dir:"bgm",set:_("Title_bgm")})]})]}),s("div",{children:[e("div",{className:D.title,children:"\u6807\u9898\u80CC\u666F"}),s("div",{className:D.optionContent,children:[d,e(k,{setShow:h,id:"bgPicker",dir:"background",set:_("Title_img")})]})]})]})},It="_main_z7pjj_2",At="_dirButtonContainer_z7pjj_8",yt="_icon_small_z7pjj_14",kt="_controlPanel_z7pjj_21",Dt="_upload_z7pjj_25",Pt="_dirButton_z7pjj_8",bt="_fileElement_z7pjj_47",Lt="_title_z7pjj_64",zt="_currentDirShow_z7pjj_74",Tt="_panelButton_z7pjj_84",Gt="_uploadTitle_z7pjj_96",Ot="_uploadButton_z7pjj_104";var B={main:It,dirButtonContainer:At,icon_small:yt,controlPanel:kt,upload:Dt,dirButton:Pt,fileElement:bt,title:Lt,currentDirShow:zt,panelButton:Tt,uploadTitle:Gt,uploadButton:Ot};const de={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},le=t=>{let i=e(Y,{theme:"outline",size:"22",fill:"#333"});switch(t.icon){case"background":i=e(U,{theme:"outline",size:"22",fill:"#333"});break;case"bgm":i=e(R,{theme:"outline",size:"22",fill:"#333"});break;case"figure":i=e(q,{theme:"outline",size:"22",fill:"#333"});break;case"video":i=e(j,{theme:"outline",size:"22",fill:"#333"});break;case"vocal":i=e(Ne,{theme:"outline",size:"22",fill:"#333"});break;case"file":i=e(ve,{theme:"outline",size:"22",fill:"#333"})}return i},$t=()=>{const[t,i]=r.exports.useState(!0),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refAssetsManagement",t),c.connect("refAssetsManagement",()=>{i(c.get("refAssetsManagement"))},"refAssetsManagement"),f()},[]);const f=()=>{const l=n.currentEditGame,N=n.currentDir,E={dir:`/${l}/game/${N}`};y.post(`${n.domain}/api/editGame/getAssets/`,E).then(F=>{n.currentDirContent=F.data,c.set("refAssetsManagement",!c.get("refAssetsManagement"))}).catch(F=>{console.log(F)})},m=()=>{if(n.currentDir==="")return;let l=n.currentDir.split("/");l.pop(),n.currentDir=l.reduce((N,E)=>""+N+"/"+E),f()},g=l=>{n.currentDir=n.currentDir+`/${l}`,f()},_=()=>{const l=n.currentEditGame,N=n.currentDir,E=`/${l}/game/${N}`;let F=new FormData;F.append("dir",E);const M=document.getElementById("uploadFile").files[0];let G=document.getElementById("uploadFile").value;F.append("file",M,G),y.post(`${n.domain}/api/editGame/addAsset/`,F,{headers:{"Content-Type":"multipart/form-data"}}).then(Q=>{h(!1),f()}).catch(Q=>{console.log(Q)})},C=()=>{const l=n.currentEditGame,N=n.currentDir,E=`/${l}/game/${N}`,F=document.getElementById("addDirInput").value,M={current:E,Name:F};y.post(`${n.domain}/api/editGame/mkdir/`,M).then(G=>{u(!1),f()}).catch(G=>{console.log(G)})},v=()=>{h(!d)},x=()=>{u(!o)},p=[];for(const l of n.currentDirContent){let N="",E=!0;if(l.match(/\./))n.currentDir===""&&(E=!1),N=s("div",{className:B.fileElement,children:[e("span",{className:B.icon_small,children:e(le,{icon:"file"})}),l]},l);else{let F=l;n.currentDir===""&&de.hasOwnProperty(l)&&(F=de[l]),N=s("div",{className:B.dirButton,onClick:()=>g(l),children:[e("span",{className:B.icon_small,children:e(le,{icon:l})}),F]},l),l==="scene"&&n.currentDir===""&&(E=!1)}E&&p.push(N)}return s("div",{className:B.main,children:[n.currentDir!==""&&e("div",{className:B.currentDirShow,children:n.currentDir}),n.currentDir!==""&&s("div",{className:B.controlPanel,children:[e("div",{children:e(xe,{theme:"outline",size:"24",fill:"#333",onClick:m,className:B.panelButton})}),s("div",{children:[e(Ce,{theme:"outline",size:"24",fill:"#333",onClick:v,className:B.panelButton}),d&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u4E0A\u4F20\u6587\u4EF6"}),e("input",{id:"uploadFile",type:"file"}),e("div",{className:B.uploadButton,onClick:_,children:"\u4E0A\u4F20"})]})]}),s("div",{children:[e(Ee,{theme:"outline",size:"24",fill:"#333",onClick:x,className:B.panelButton}),o&&s("div",{className:B.upload,children:[e("div",{className:B.uploadTitle,children:"\u65B0\u5EFA\u6587\u4EF6\u5939"}),e("input",{id:"addDirInput"}),e("div",{className:B.uploadButton,onClick:C,children:"\u65B0\u5EFA"})]})]})]}),e("div",{}),e("div",{className:B.dirButtonContainer,children:p})]})},Mt="_main_1p8zt_1",jt="_addInput_1p8zt_12",qt="_title_1p8zt_21",Rt="_addButton_1p8zt_29";var $={main:Mt,addInput:jt,title:qt,addButton:Rt};const Ut=t=>{const i=()=>{const d={gameName:n.currentEditGame,sceneName:document.getElementById("addSceneName").value};y.post(`${n.domain}/api/editGame/addNewScene/`,d).then(h=>{t.added()}).catch(h=>{console.log(h)})};return s("div",{className:$.main,children:[s("div",{className:$.title,children:["\u573A\u666F\u540D\u79F0",e("input",{className:$.addInput,id:"addSceneName"})]}),e("div",{className:$.addButton,onClick:i,children:"\u65B0\u5EFA\u573A\u666F"})]})},Wt="_titleText_juf2g_1",Vt="_scene_juf2g_11",Jt="_newSceneButton_juf2g_22",Ht="_sceneList_juf2g_35";var V={titleText:Wt,scene:Vt,newSceneButton:Jt,sceneList:Ht};const J=()=>{n.currentEditScene!==""&&(n.sceneScrollTop[n.currentEditScene]=document.getElementById("currentSentenceList").scrollTop)},Kt=()=>{const[t,i]=r.exports.useState([]),[d,h]=r.exports.useState(!1),o=()=>{const C={dir:`/${n.currentEditGame}/game/scene`};y.post(`${n.domain}/api/editGame/getAssets/`,C).then(v=>{i(v.data)}).catch(v=>{console.log(v)})},u=()=>{o(),h(!d)};r.exports.useEffect(()=>{o()},[]);const f=g=>{n.currentOpendSceneEdit.includes(g)||n.currentOpendSceneEdit.push(g),J(),n.currentEditScene=g,c.set("updateEditor",!c.get("updateEditor"))},m=[];for(const g of t){let _=!1,C=g.split(".");C[C.length-1]==="json"&&(_=!0);const v=s("div",{className:V.scene,onClick:()=>f(g),children:[e(O,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),g]},g);_&&m.push(v)}return s("div",{style:{width:"100%"},children:[s("div",{className:V.newSceneButton,onClick:()=>{h(!d)},children:[e(Be,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0",transform:"translate(0,2px)"}}),"\u65B0\u5EFA\u573A\u666F"]}),e("div",{children:d&&e(Ut,{added:u})}),e("div",{className:V.sceneList,children:m})]})},Qt=()=>{const t=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[i,d]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("refSideBar",i),c.connect("refSideBar",()=>{d(c.get("refSideBar"))},"refSideBarFunc")},[]);const h=[];for(const m of t){let g="#333";m===n.editorTag?(I.optionMarker,g="#8e354a"):I.optionMarkerOff;let _=e(Fe,{theme:"outline",size:"14",fill:g});m==="\u7D20\u6750\u7BA1\u7406"&&(_=e(Ie,{theme:"outline",size:"14",fill:g})),m==="\u573A\u666F\u7BA1\u7406"&&(_=e(O,{theme:"outline",size:"14",fill:g}));const C=e("div",{className:m===n.editorTag?I.tagButton+" "+I.tagButtonOn:I.tagButton,onClick:()=>{n.editorTag=m,c.set("refSideBar",!c.get("refSideBar"))},children:s("div",{children:[_,e("span",{style:{margin:"0 5px 0 0 "}}),m]})},m);h.push(C)}let o;switch(n.editorTag){case"\u6E38\u620F\u914D\u7F6E":o=e(Ft,{});break;case"\u7D20\u6750\u7BA1\u7406":o=e($t,{});break;case"\u573A\u666F\u7BA1\u7406":o=e(Kt,{});break}function u(m){n.isRealtimeRefreashPreview=m}function f(){const m=document.getElementById("gamePreviewIframe");m.src="",m.src=`${n.domain}/Games/${n.currentEditGame}`}return s("aside",{className:I.aside,children:[s("div",{className:I.asidePreviewControlBar,children:[e("div",{className:I.asidePreviewControlBar_single,children:e("span",{className:I.gamePrevTitle,children:"\u6E38\u620F\u9884\u89C8"})}),s("div",{id:"refPreviewButton",className:I.asidePreviewControlBar_button,onClick:f,children:[e(we,{style:{transform:"translate(0,0)",margin:"0 3px 0 0 "},theme:"outline",size:"14",fill:"#000",strokeWidth:3}),"\u5237\u65B0"]}),s("div",{className:I.asidePreviewControlBar_single,children:["\u5B9E\u65F6\u66F4\u65B0",e("span",{style:{margin:"0 10px 0 0 "}}),e(T,{defaultChecked:!0,onChange:u,size:"small"})]})]}),e("iframe",{id:"gamePreviewIframe",frameBorder:"0",className:I.previewWindow,src:`${n.domain}/Games/${n.currentEditGame}`}),s("div",{className:I.sideBarMain,children:[e("div",{className:I.option,children:h}),e("div",{className:I.sideBarContent,children:o})]})]})},Xt="_main_r7n8t_1";var Yt={main:Xt};const Zt="_main_1m1df_1",en="_tag_1m1df_8",tn="_tagOpened_1m1df_19",nn="_tagList_1m1df_26",sn="_tagIcon_1m1df_33",an="_closeIcon_1m1df_38";var b={main:Zt,tag:en,tagOpened:tn,tagList:nn,tagIcon:sn,closeIcon:an};const cn="_main_1m4ta_1",on="_topButtonList_1m4ta_5",dn="_topButton_1m4ta_5",ln="_addSentencePanel_1m4ta_32",rn="_addSentencePanel_main_1m4ta_44",un="_addSentenceButton_1m4ta_57",mn="_sentenceList_1m4ta_67",hn="_sentence_1m4ta_67",gn="_sentenceIn_1m4ta_1",pn="_lineNumber_1m4ta_81",fn="_sentenceMain_1m4ta_91",Sn="_addItemIcon_1m4ta_105";var S={main:cn,topButtonList:on,topButton:dn,addSentencePanel:ln,addSentencePanel_main:rn,addSentenceButton:un,sentenceList:mn,sentence:hn,sentenceIn:gn,lineNumber:pn,sentenceMain:fn,addItemIcon:Sn};const _n=t=>{let i;switch(t){case"dialog":i={type:t,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":i={type:t,bg:"",noBg:!1,next:!1};break;case"bgm":i={type:t,bgm:"",noBgm:!1};break;case"changeScene":i={type:t,newScene:""};break;case"video":i={type:t,video:""};break;case"changeP":i={type:t,newP:"",next:!1,noP:!1,pos:""};break;case"choose":i={type:t,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break;case"intro":i={type:t,content:[]};break}return i},vn="_sentence_zvp9k_1",Nn="_dialog_input_zvp9k_7",xn="_singleOption_zvp9k_14",Cn="_optionTitle_zvp9k_22",En="_dialog_edit_title_zvp9k_29",Bn="_optionContent_zvp9k_34",wn="_isolate_zvp9k_38",Fn="_sentenceButtonList_zvp9k_43",In="_sentenceButton_zvp9k_43",An="_sentenceIndexShow_zvp9k_66",yn="_barContainer_zvp9k_80",kn="_mainEdit_zvp9k_91",Dn="_topContainer_zvp9k_99";var a={sentence:vn,dialog_input:Nn,singleOption:xn,optionTitle:Cn,dialog_edit_title:En,optionContent:Bn,isolate:wn,sentenceButtonList:Fn,sentenceButton:In,sentenceIndexShow:An,barContainer:yn,mainEdit:kn,topContainer:Dn};const Pn=t=>{n.currentSceneSentenceList.splice(t,1),c.set("writeScene",!c.get("writeScene"))},re=(t,i)=>{if(!(t===0&&i===-1||t===n.currentSceneSentenceList.length-1&&i===1)){{const d=n.currentSceneSentenceList[t];n.currentSceneSentenceList.splice(t,1),n.currentSceneSentenceList.splice(t+i,0,d)}c.set("writeScene",!c.get("writeScene"))}},ue=t=>e("div",{style:{lineHeight:"18px"},children:s("div",{className:S.addSentencePanel,children:[s("div",{className:S.addSentenceButton,onClick:()=>{w("dialog",t.index)},children:[e(Z,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeP",t.index)},children:[e(q,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bg",t.index)},children:[e(U,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeScene",t.index)},children:[e(ee,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("choose",t.index)},children:[e(te,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bgm",t.index)},children:[e(R,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("video",t.index)},children:[e(j,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("intro",t.index)},children:[e(ne,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u9ED1\u5C4F\u6587\u5B57"]})]})}),L=t=>s("div",{className:a.sentenceButtonList,children:[s("div",{className:a.sentenceButton,onClick:()=>{Pn(t.index)},children:[e(Ae,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),s("div",{onClick:()=>{re(t.index,-1)},className:a.sentenceButton,children:[e(ye,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{re(t.index,1)},className:a.sentenceButton,children:[e(ke,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),s("div",{onClick:()=>{t.data.setShowAddPre(!t.data.showAddPre)},className:a.sentenceButton,children:[e(se,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",t.data.showAddPre&&e(ue,{index:t.data.indexPre})]}),s("div",{onClick:()=>{t.data.setShowAddAfter(!t.data.showAddAfter)},className:a.sentenceButton,children:[e(se,{theme:"outline",size:"14",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",t.data.showAddAfter&&e(ue,{index:t.data.indexAfter})]})]}),z=t=>{const i=n.wsConn;n.isRealtimeRefreashPreview&&setTimeout(()=>{i.send(`jmp ${n.currentEditScene} ${t}`)},500)},bn=t=>{const i=()=>z(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{document.getElementById("speakerInput"+t.index).value=t.data.speaker,document.getElementById("contentInput"+t.index).value=t.data.content});const _=()=>{n.currentSceneSentenceList[t.index].speaker=document.getElementById("speakerInput"+t.index).value,n.currentSceneSentenceList[t.index].content=document.getElementById("contentInput"+t.index).value,c.set("writeScene",!c.get("writeScene")),i()},C=l=>{n.currentSceneSentenceList[t.index].ignoreSpeaker=l,c.set("writeScene",!c.get("writeScene")),i()},[v,x]=r.exports.useState(t.data.vocal),p=()=>l=>{n.currentSceneSentenceList[t.index].vocal=l,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u57FA\u672C\u5BF9\u8BDD"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.dialog_edit_title,children:"\u89D2\u8272\uFF1A"}),e("input",{className:a.dialog_input,onBlur:_,id:"speakerInput"+t.index}),e("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.dialog_edit_title,children:"\u5BF9\u8BDD\uFF1A"}),e("textarea",{className:a.dialog_input,onBlur:_,id:"contentInput"+t.index})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u65C1\u767D\u6A21\u5F0F"}),s("span",{className:a.optionContent,children:[e(T,{size:"small",id:"dialog_pbms",checked:t.data.ignoreSpeaker,onChange:C}),"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"]}),e("div",{className:a.optionTitle,children:"\u914D\u97F3\u6587\u4EF6"}),e(k,{setShow:x,id:"vocalPicker",dir:"vocal",set:p()}),e("span",{className:a.optionContent,children:v})]})]})]},t.index+"dialog")},Ln=t=>{const i=()=>z(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const _=l=>{n.currentSceneSentenceList[t.index].noBg=l,c.set("writeScene",!c.get("writeScene")),i()},C=l=>{n.currentSceneSentenceList[t.index].next=l,c.set("writeScene",!c.get("writeScene")),i()},[v,x]=r.exports.useState(t.data.bg),p=()=>l=>{n.currentSceneSentenceList[t.index].bg=l,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u66F4\u6539\u80CC\u666F"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u80CC\u666F"}),s("span",{className:a.optionContent,children:[e(T,{size:"small",checked:t.data.noBg,id:"bg_none"+t.index,onChange:_}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"]}),e("span",{className:a.optionTitle,children:"\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5"}),e("span",{className:a.optionContent,children:e(T,{size:"small",id:"bg_next"+t.index,checked:t.data.next,onChange:C})})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u80CC\u666F\u6587\u4EF6"}),e(k,{setShow:x,id:"bgPicker",dir:"background",set:p()}),e("span",{className:a.optionContent,children:v})]})]})]},t.index+"bg")},zn=t=>{const i=()=>z(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const _=p=>{n.currentSceneSentenceList[t.index].noBgm=p,c.set("writeScene",!c.get("writeScene")),i()},[C,v]=r.exports.useState(t.data.bgm),x=()=>p=>{n.currentSceneSentenceList[t.index].bgm=p,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u66F4\u6539\u97F3\u4E50"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u80CC\u666F\u97F3\u4E50"}),s("span",{className:a.optionContent,children:[e(T,{size:"small",id:"bgm_none"+t.index,checked:t.data.noBgm,onChange:_}),"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"]})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u80CC\u666F\u97F3\u4E50\u6587\u4EF6"}),e(k,{setShow:v,id:"bgmPicker",dir:"bgm",set:x()}),e("span",{className:a.optionContent,children:C})]})]})]},t.index+"bgm")},Tn=t=>{const i=()=>z(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const[_,C]=r.exports.useState(t.data.newScene),v=()=>x=>{n.currentSceneSentenceList[t.index].newScene=x,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5207\u6362\u573A\u666F"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),e("main",{className:a.mainEdit,children:s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u65B0\u573A\u666F"}),e(k,{setShow:C,id:"scenePicker",dir:"scene",set:v()}),e("span",{className:a.optionContent,children:_})]})})]},t.index+"scene")},Gn=t=>{const i=()=>z(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const[_,C]=r.exports.useState(t.data.video),v=()=>x=>{n.currentSceneSentenceList[t.index].video=x,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u64AD\u653E\u89C6\u9891"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),e("main",{className:a.mainEdit,children:s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u89C6\u9891\u6587\u4EF6"}),e(k,{setShow:C,id:"videoPicker",dir:"video",set:v()}),e("span",{className:a.optionContent,children:_})]})})]},t.index+"scene")},{Option:H}=ie,On=t=>{const i=()=>z(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{});const _=N=>{n.currentSceneSentenceList[t.index].noP=N,c.set("writeScene",!c.get("writeScene")),i()},C=N=>{n.currentSceneSentenceList[t.index].next=N,c.set("writeScene",!c.get("writeScene")),i()},[v,x]=r.exports.useState(t.data.newP),p=()=>N=>{n.currentSceneSentenceList[t.index].newP=N,c.set("writeScene",!c.get("writeScene")),i()},l=N=>{n.currentSceneSentenceList[t.index].pos=N,c.set("writeScene",!c.get("writeScene")),i()};return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5207\u6362\u7ACB\u7ED8"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5173\u95ED\u7ACB\u7ED8"}),e("span",{className:a.optionContent,children:e(T,{size:"small",id:"p_none",checked:t.data.noP,onChange:_})}),e("span",{className:a.optionContent,children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"}),e("span",{className:a.optionTitle,children:"\u7ACB\u7ED8\u4F4D\u7F6E"}),s(ie,{size:"small",defaultValue:t.data.pos,style:{width:120},onChange:l,children:[e(H,{value:"left",children:"\u5DE6"}),e(H,{value:"",children:"\u4E2D"}),e(H,{value:"right",children:"\u53F3"})]}),e("span",{className:a.optionContent,children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5"}),e("span",{className:a.optionContent,children:e(T,{size:"small",id:"p_none",checked:t.data.next,onChange:C})})]}),s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u7ACB\u7ED8\u6587\u4EF6"}),e(k,{setShow:x,id:"pPicker",dir:"figure",set:p()}),e("span",{className:a.optionContent,children:v})]})]})]},t.index+"dialog")},$n=t=>{const i=()=>z(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{for(let l=0;l<t.data.chooseItem.length;l++)document.getElementById("chooseInput"+t.index+"itemIndex"+l).value=t.data.chooseItem[l].text});const _=()=>{n.currentSceneSentenceList[t.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),c.set("writeScene",!c.get("writeScene")),i()},C=l=>{const N=parseInt(l.split("Index")[1]);console.log(N),n.currentSceneSentenceList[t.index].chooseItem[N].text=document.getElementById(l).value,c.set("writeScene",!c.get("writeScene")),i()},v=l=>N=>{n.currentSceneSentenceList[t.index].chooseItem[l].scene=N,c.set("writeScene",!c.get("writeScene")),i()};let x=[],p=0;for(const l of t.data.chooseItem){const N="chooseInput"+t.index+"itemIndex"+p;let E=s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u5206\u652F\u540D\u79F0"}),e("input",{className:a.dialog_input,style:{width:"200px"},onBlur:()=>{C(N)},id:N}),e("span",{className:a.optionContent,children:e(De,{theme:"outline",size:"24",fill:"#333"})}),e("span",{className:a.optionTitle,children:"\u8DF3\u8F6C\u7684\u573A\u666F"}),e(k,{id:"scenePicker",dir:"scene",set:v(p)}),e("span",{className:a.optionContent,children:l.scene})]},p);x.push(E),p++}return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u5206\u652F\u9009\u62E9"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:_,className:a.sentenceButton,children:[e(ae,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),x]})]},t.index+"choose")},Mn=t=>{const i=()=>z(t.index),[d,h]=r.exports.useState(!1),[o,u]=r.exports.useState(!1),f=t.index,m=t.index+1,g={showAddPre:d,setShowAddPre:h,showAddAfter:o,setShowAddAfter:u,indexPre:f,indexAfter:m};r.exports.useEffect(()=>{for(let p=0;p<t.data.content.length;p++)document.getElementById("introInput"+t.index+"itemIndex"+p).value=t.data.content[p]});const _=()=>{n.currentSceneSentenceList[t.index].content.push("\u5728\u6B64\u586B\u5165\u8981\u5C55\u793A\u7684\u6587\u5B57"),c.set("writeScene",!c.get("writeScene")),i()},C=p=>{const l=parseInt(p.split("Index")[1]);console.log(l),n.currentSceneSentenceList[t.index].content[l]=document.getElementById(p).value,c.set("writeScene",!c.get("writeScene")),i()};let v=[],x=0;for(const p of t.data.content){const l="introInput"+t.index+"itemIndex"+x;let N=s("div",{className:a.singleOption,children:[e("span",{className:a.optionTitle,children:"\u663E\u793A\u6587\u5B57"}),e("input",{className:a.dialog_input,style:{width:"200px"},onBlur:()=>{C(l)},id:l})]},x);v.push(N),x++}return s("div",{className:a.sentence,children:[s("div",{className:a.topContainer,children:[e("div",{className:a.sentenceIndexShow,children:"\u9ED1\u5C4F\u6587\u5B57"}),e("div",{className:a.barContainer,children:e(L,{index:t.index,data:g})})]}),s("main",{className:a.mainEdit,children:[e("div",{style:{display:"flex",padding:"5px 0 0 0"},children:s("div",{onClick:_,className:a.sentenceButton,children:[e(ae,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u6587\u5B57"]})}),v]})]},t.index+"intro")},jn=(t,i)=>{let d;switch(t.type){case"dialog":d=e(bn,{data:t,index:i},i);break;case"bg":d=e(Ln,{data:t,index:i},i);break;case"bgm":d=e(zn,{data:t,index:i},i);break;case"changeScene":d=e(Tn,{data:t,index:i},i);break;case"video":d=e(Gn,{data:t,index:i},i);break;case"changeP":d=e(On,{data:t,index:i},i);break;case"choose":d=e($n,{data:t,index:i},i);break;case"intro":d=e(Mn,{data:t,index:i},i);break}return d};const qn=t=>{const[i,d]=r.exports.useState(!0),[h,o]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateScene",i),c.connect("updateScene",()=>{d(c.get("updateScene"))},"updateSceneFunc"),c.set("refScene",!0),c.connect("refScene",()=>{K()},"refSceneFunc"),c.get("writeScene")===void 0&&c.set("writeScene",!0),c.connect("writeScene",()=>{me()},"writeSceneFunc"),K(),n.sceneScrollTop.hasOwnProperty(n.currentEditScene)&&setTimeout(()=>{document.getElementById("currentSentenceList").scrollTop=n.sceneScrollTop[n.currentEditScene]},0)},[]);let u=[];const f=JSON.parse(JSON.stringify(n.currentSceneSentenceList));for(let g=0;g<f.length;g++){const _=f[g],C=jn(_,g),v=s("div",{className:S.sentence,children:[e("div",{className:S.lineNumber,children:g+1}),e("div",{className:S.sentenceMain,children:C})]},"sentence"+g);u.push(v)}const m=s("div",{className:S.addSentencePanel_main,children:[s("div",{className:S.addSentenceButton,onClick:()=>{w("dialog"),o(!1)},children:[e(Z,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeP"),o(!1)},children:[e(q,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bg"),o(!1)},children:[e(U,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("changeScene"),o(!1)},children:[e(ee,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("choose"),o(!1)},children:[e(te,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("bgm"),o(!1)},children:[e(R,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("video"),o(!1)},children:[e(j,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]}),s("div",{className:S.addSentenceButton,onClick:()=>{w("intro"),o(!1)},children:[e(ne,{className:S.addItemIcon,theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u9ED1\u5C4F\u6587\u5B57"]})]});return s("div",{className:S.main,children:[s("div",{className:S.topButtonList,children:[e("div",{className:S.topButton,onClick:()=>{o(!h)},children:e(X,{theme:"outline",size:"24",fill:"#fff"})}),e("div",{children:h&&m})]}),e("div",{className:S.sentenceList,id:"currentSentenceList",children:u})]})};function K(){let t=n.currentEditScene;if(t==="")return;const i=`${n.domain}/Games/${n.currentEditGame}/game/scene/${t}`;y.get(i).then(d=>{n.currentSceneSentenceList=d.data,c.set("updateScene",!c.get("updateScene"))}).catch(d=>console.log(d))}function w(t,i){const d=_n(t);i!==void 0?n.currentSceneSentenceList.splice(i,0,d):n.currentSceneSentenceList.push(d),me()}function me(){const t=`${n.domain}/api/editGame/editScene/`,i={gameName:n.currentEditGame,sceneName:n.currentEditScene,sceneData:n.currentSceneSentenceList};y.post(t,i).then(d=>{K()}).catch(d=>console.log(d))}const Rn=()=>{const[t,i]=r.exports.useState(!1);r.exports.useEffect(()=>{c.set("updateEditor",t),c.connect("updateEditor",()=>{i(c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},"updateEditorFunc")},[]);const d=u=>{J(),n.currentEditScene=u,c.set("updateEditor",!c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},h=u=>{J();const f=n.currentOpendSceneEdit.indexOf(u);n.currentOpendSceneEdit.splice(f,1);const m=n.currentOpendSceneEdit.length===0;u===n.currentEditScene&&(m?n.currentEditScene="":n.currentOpendSceneEdit.length<=f?n.currentEditScene=n.currentOpendSceneEdit[n.currentOpendSceneEdit.length-1]:n.currentEditScene=n.currentOpendSceneEdit[f]),c.set("updateEditor",!c.get("updateEditor"))},o=[];for(const u of n.currentOpendSceneEdit){let f;u===n.currentEditScene?f=s("div",{className:b.tagOpened,children:[e(O,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),u,e(ce,{theme:"outline",size:"20",fill:"#333",className:b.closeIcon,onClick:()=>{h(u)}})]},u):f=s("div",{className:b.tag,onClick:()=>{d(u)},children:[e(O,{theme:"outline",size:"20",fill:"#333",className:b.tagIcon}),u,e(ce,{theme:"outline",size:"20",fill:"#333",className:b.closeIcon,onClick:m=>{m.preventDefault(),m.stopPropagation(),h(u)}})]},u),o.push(f)}return s("div",{className:b.main,children:[e("div",{className:b.tagList,children:o}),e("div",{children:n.currentEditScene!==""&&e(qn,{sceneName:n.currentEditScene},n.currentEditScene)})]})},Un=()=>{const[t,i]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("updateEditor",!0),c.connect("updateEditor",()=>{i(c.get("updateEditor"))},"ForceUpdateEditor");try{const h=`ws://${window.location.hostname}:9999`;console.log("\u6B63\u5728\u542F\u52A8socket\u8FDE\u63A5\u4F4D\u4E8E\uFF1A"+h);const o=new WebSocket(h);o.onopen=()=>{console.log("socket\u5DF2\u8FDE\u63A5"),o.send("WebGAL Origine \u5DF2\u548C Terre \u5EFA\u7ACB\u8FDE\u63A5")},o.onmessage=u=>{console.log("\u6536\u5230\u4FE1\u606F",u.data)},n.wsConn=o}catch{console.warn("ws\u8FDE\u63A5\u5931\u8D25")}},[]),s("div",{children:[e(Ye,{}),s("main",{className:Yt.main,children:[e(Qt,{}),e(Rn,{})]})]})};function Wn(){const[t,i]=r.exports.useState(!0);return r.exports.useEffect(()=>{c.set("isManageMent",!0),c.connect("isManagement",()=>{i(c.get("isManagement"))},"setIsManagementFunc")},[]),s("div",{className:"App",children:[t&&e(He,{}),!t&&e(Un,{})]})}Pe.render(e(be.StrictMode,{children:e(Wn,{})}),document.getElementById("root"));
