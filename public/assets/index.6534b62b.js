import{f as ue,r as o,a as w,j as n,b as t,G as re,A as H,L as le,F as Q,N as me,E as he,P as ge,V as Se,c as T,d as j,e as U,g as R,h as fe,D as X,R as xe,U as pe,i as _e,k as Ee,C as Y,l as Z,S as ee,m as ve,n as Fe,o as te,p as P,q as ne,s as Be,t as Ce,u as ie,v as se,w as Ne,x as we}from"./vendor.aef5ca88.js";const Ae=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))h(u);new MutationObserver(u=>{for(const a of u)if(a.type==="childList")for(const m of a.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&h(m)}).observe(document,{childList:!0,subtree:!0});function d(u){const a={};return u.integrity&&(a.integrity=u.integrity),u.referrerpolicy&&(a.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?a.credentials="include":u.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function h(u){if(u.ep)return;u.ep=!0;const a=d(u);fetch(u.href,a)}};Ae();const ye="_nav_rg28x_2",De="_title_rg28x_12",ke="_subTitle_rg28x_20",Ie="_main_rg28x_29",be="_gameList_rg28x_33",Pe="_singleGameEntryButton_rg28x_38",Le="_buttonIcon_rg28x_53",ze="_addIcon_rg28x_57",Ge="_createPanel_rg28x_64",Oe="_createPanelTitle_rg28x_74",$e="_createPanelInput_rg28x_80",Me="_createButton_rg28x_86";var A={nav:ye,title:De,subTitle:ke,main:Ie,gameList:be,singleGameEntryButton:Pe,buttonIcon:Le,addIcon:ze,createPanel:Ge,createPanelTitle:Oe,createPanelInput:$e,createButton:Me};const c=new ue;c.set("updateEditor",!0);const ce={editorTag:"\u6E38\u620F\u914D\u7F6E",domain:"",gameList:[],currentEditGame:"",currentGameConfig:{},currentDir:"",currentDirContent:[],currentEditScene:"",currentOpendSceneEdit:[],currentSceneSentenceList:[]},i=JSON.parse(JSON.stringify(ce)),Te=()=>{const[e,s]=o.exports.useState(!0),[d,h]=o.exports.useState(!1);o.exports.useEffect(()=>{c.set("refManagement",e),c.connect("refManagement",()=>{s(c.get("refManagement"))},"refManagementFunc"),u()},[]);const u=()=>{w.get(i.domain+"/api/manageGame/gameList").then(S=>{i.gameList=S.data,c.set("refManagement",!c.get("refManagement"))}).catch(S=>{console.log(S)})};let a=[];for(const S of i.gameList){const g=n("div",{className:A.singleGameEntryButton,onClick:()=>{for(const x in i)i[x]=ce[x];i.currentEditGame=S,c.set("isManagement",!1)},children:[t(re,{theme:"outline",size:"24",fill:"#333",className:A.buttonIcon}),S]},S);a.push(g)}const m=S=>{const g=`${i.domain}/api/manageGame/createGame/${S}`;w.get(g).then(x=>{h(!1),u()})};return n("div",{children:[t("header",{children:t("nav",{children:t("div",{className:A.nav,children:t("div",{className:A.title,children:"WebGAL ORIGINE"})})})}),n("main",{className:A.main,children:[n("div",{className:A.subTitle,children:["\u6E38\u620F\u5217\u8868",n("span",{onClick:()=>h(!d),className:A.addIcon,children:[t(H,{theme:"outline",size:"18",fill:"#8E354A"})," \u65B0\u5EFA\u6E38\u620F"]}),d&&n("div",{className:A.createPanel,children:[t("div",{className:A.createPanelTitle,children:"\u521B\u5EFA\u6E38\u620F"}),n("div",{children:["\u6E38\u620F\u540D\u79F0\uFF1A",t("input",{id:"createInput",className:A.createPanelInput})]}),t("div",{style:{textAlign:"center"},children:t("div",{onClick:()=>m(document.getElementById("createInput").value),className:A.createButton,children:"\u521B\u5EFA"})})]})]}),t("div",{className:A.gameList,children:a})]})]})},je="_nav_1x6hc_1",Ue="_title_1x6hc_11",Re="_titleIcon_1x6hc_19";var V={nav:je,title:Ue,titleIcon:Re};const Ve=()=>n("div",{className:V.nav,children:[t(le,{theme:"filled",size:"30",fill:"#333",className:V.titleIcon,onClick:()=>{c.set("isManagement",!0)}}),t("div",{className:V.title,children:"WebGAL ORIGINE"})]}),qe="_aside_jzyyx_1",Je="_option_jzyyx_9",We="_optionMarker_jzyyx_18",Ke="_chooseItem_jzyyx_26",He="_chooseTitle_jzyyx_37",Qe="_chooseDescription_jzyyx_42",Xe="_tagButton_jzyyx_47",Ye="_tagButtonOn_jzyyx_55",Ze="_sideBarContent_jzyyx_66";var L={aside:qe,option:Je,optionMarker:We,chooseItem:Ke,chooseTitle:He,chooseDescription:Qe,tagButton:Xe,tagButtonOn:Ye,sideBarContent:Ze};const et="_title_1xmzb_1",tt="_previewGameButton_1xmzb_9",nt="_gameNameInput_1xmzb_20";var z={title:et,previewGameButton:tt,gameNameInput:nt};const it="_choosed_skz1j_1",st="_chooseBox_skz1j_7",ct="_chooseIcon_skz1j_11",at="_fileList_skz1j_26",dt="_singleFile_skz1j_38",ot="_fileIcon_skz1j_49";var I={choosed:it,chooseBox:st,chooseIcon:ct,fileList:at,singleFile:dt,fileIcon:ot};const D=e=>{const[s,d]=o.exports.useState(!1),[h,u]=o.exports.useState(e.dir),[a,m]=o.exports.useState([]),[S,g]=o.exports.useState(""),x=r=>{const F={dir:`/${i.currentEditGame}/game/${r}`};w.post(`${i.domain}/api/editGame/getAssets/`,F).then(v=>{m(v.data)}).catch(v=>{console.log(v)})},E=r=>{let l=r.split("/");r="";let F=0;for(const v of l)v!==e.dir&&(F!==0&&(r=r+"/"),F++,r=r+v);return r},p=r=>{let l=h+"/"+r;l=E(l),e.set(l),e.hasOwnProperty("setShow")&&e.setShow(l)};o.exports.useEffect(()=>{x(h)},[]);let _=[];for(const r of a){let l=!0,F=!0;r.match(/\.json/)&&(F=!1),r.match(/\./)&&(l=!1);let v=t("div",{children:""});l?v=n("div",{className:I.singleFile,onClick:()=>{const C=h+"/"+r;u(C),x(C)},children:[t(Q,{theme:"outline",size:"18",fill:"#333",className:I.fileIcon}),r]},r):v=n("div",{className:I.singleFile,onClick:()=>{g(E(h+"/"+r)),p(r),d(!s)},children:[t(me,{theme:"outline",size:"18",fill:"#333",className:I.fileIcon}),r]},r),F&&_.push(v)}return n("div",{children:[t("div",{className:I.chooseBox,children:n("div",{className:I.chooseIcon,onClick:()=>{s===!1&&(u(e.dir),g(""),x(e.dir)),d(!s)},children:[t(he,{theme:"outline",size:"18",fill:"#333"})," \u9009\u62E9\u6587\u4EF6"]})}),t("div",{style:{position:"relative"},children:s&&t("div",{className:I.fileList,children:_})})]})},ut=()=>{o.exports.useState(!1);const[e,s]=o.exports.useState(""),[d,h]=o.exports.useState(""),[u,a]=o.exports.useState(""),m=()=>{w.get(`${i.domain}/Games/${i.currentEditGame}/game/gameConfig.json`).then(p=>{let _=p.data;i.currentGameConfig=p.data,document.getElementById("gameNameInput").value=_.Game_name,s(_.Title_bgm),h(_.Title_img),a(_.Loading_img)})},S=()=>{i.currentGameConfig.Game_name=document.getElementById("gameNameInput").value,E()},g=(p,_)=>{i.currentGameConfig[p]=_,E()},x=p=>_=>{g(p,_)},E=()=>{let p={currentEditGame:i.currentEditGame,config:i.currentGameConfig};w.post(`${i.domain}/api/manageGame/config`,p).then(_=>{})};return o.exports.useEffect(()=>{m()},[]),n("div",{children:[t("div",{children:t("a",{style:{color:"black",textDecoration:"none"},href:`${i.domain}/Games/${i.currentEditGame}`,target:"_blank",children:n("div",{className:z.previewGameButton,children:[t(ge,{theme:"outline",size:"28",fill:"#FFF",style:{padding:"0 5px 0 0",transform:"translate(0,4px)"}}),"\u9884\u89C8\u6E38\u620F"]})})}),n("div",{children:[t("div",{className:z.title,children:"\u6E38\u620F\u540D\u79F0"}),t("div",{children:t("input",{onInput:S,id:"gameNameInput",className:z.gameNameInput})})]}),n("div",{children:[t("div",{className:z.title,children:"\u6807\u9898\u80CC\u666F\u97F3\u4E50"}),n("div",{children:[e,t(D,{setShow:s,id:"bgmPicker",dir:"bgm",set:x("Title_bgm")})]})]}),n("div",{children:[t("div",{className:z.title,children:"\u6807\u9898\u80CC\u666F"}),n("div",{children:[d,t(D,{setShow:h,id:"bgPicker",dir:"background",set:x("Title_img")})]})]}),n("div",{children:[t("div",{className:z.title,children:"\u52A0\u8F7D\u56FE"}),n("div",{children:[u,t(D,{setShow:a,id:"loadImgPicker",dir:"background",set:x("Loading_img")})]})]})]})},rt="_dirButtonContainer_1bra8_1",lt="_icon_small_1bra8_6",mt="_controlPanel_1bra8_13",ht="_upload_1bra8_17",gt="_dirButton_1bra8_1",St="_fileElement_1bra8_36",ft="_title_1bra8_46",xt="_currentDirShow_1bra8_56",pt="_panelButton_1bra8_65";var y={dirButtonContainer:rt,icon_small:lt,controlPanel:mt,upload:ht,dirButton:gt,fileElement:St,title:ft,currentDirShow:xt,panelButton:pt};const ae={background:"\u80CC\u666F",bgm:"\u97F3\u4E50",figure:"\u7ACB\u7ED8",video:"\u89C6\u9891",vocal:"\u8BED\u97F3"},_t=e=>{let s=t(Q,{theme:"outline",size:"24",fill:"#333"});switch(e.icon){case"background":s=t(R,{theme:"outline",size:"24",fill:"#333"});break;case"bgm":s=t(U,{theme:"outline",size:"24",fill:"#333"});break;case"figure":s=t(j,{theme:"outline",size:"24",fill:"#333"});break;case"video":s=t(T,{theme:"outline",size:"24",fill:"#333"});break;case"vocal":s=t(Se,{theme:"outline",size:"24",fill:"#333"});break}return s},Et=()=>{const[e,s]=o.exports.useState(!0),[d,h]=o.exports.useState(!1),[u,a]=o.exports.useState(!1);o.exports.useEffect(()=>{c.set("refAssetsManagement",e),c.connect("refAssetsManagement",()=>{s(c.get("refAssetsManagement"))},"refAssetsManagement"),m()},[]);const m=()=>{const l=i.currentEditGame,F=i.currentDir,v={dir:`/${l}/game/${F}`};w.post(`${i.domain}/api/editGame/getAssets/`,v).then(C=>{i.currentDirContent=C.data,c.set("refAssetsManagement",!c.get("refAssetsManagement"))}).catch(C=>{console.log(C)})},S=()=>{if(i.currentDir==="")return;let l=i.currentDir.split("/");l.pop(),i.currentDir=l.reduce((F,v)=>""+F+"/"+v),m()},g=l=>{i.currentDir=i.currentDir+`/${l}`,m()},x=()=>{const l=i.currentEditGame,F=i.currentDir,v=`/${l}/game/${F}`;let C=new FormData;C.append("dir",v);const M=document.getElementById("uploadFile").files[0];let G=document.getElementById("uploadFile").value;C.append("file",M,G),w.post(`${i.domain}/api/editGame/addAsset/`,C,{headers:{"Content-Type":"multipart/form-data"}}).then(K=>{h(!1),m()}).catch(K=>{console.log(K)})},E=()=>{const l=i.currentEditGame,F=i.currentDir,v=`/${l}/game/${F}`,C=document.getElementById("addDirInput").value,M={current:v,Name:C};w.post(`${i.domain}/api/editGame/mkdir/`,M).then(G=>{a(!1),m()}).catch(G=>{console.log(G)})},p=()=>{h(!d)},_=()=>{a(!u)},r=[];for(const l of i.currentDirContent){let F="",v=!0;if(l.match(/\./))i.currentDir===""&&(v=!1),F=n("div",{className:y.fileElement,children:[l,n("div",{children:[t(fe,{theme:"outline",size:"24",fill:"#333"}),t(X,{theme:"outline",size:"24",fill:"#333"})]})]},l);else{let C=l;i.currentDir===""&&ae.hasOwnProperty(l)&&(C=ae[l]),F=n("div",{className:y.dirButton,onClick:()=>g(l),children:[t("span",{className:y.icon_small,children:t(_t,{icon:l})}),C]},l),l==="scene"&&i.currentDir===""&&(v=!1)}v&&r.push(F)}return n("div",{children:[t("div",{className:y.title,children:"\u7D20\u6750\u7BA1\u7406"}),i.currentDir!==""&&t("div",{className:y.currentDirShow,children:i.currentDir}),i.currentDir!==""&&n("div",{className:y.controlPanel,children:[t("div",{children:t(xe,{theme:"outline",size:"24",fill:"#333",onClick:S,className:y.panelButton})}),n("div",{children:[t(pe,{theme:"outline",size:"24",fill:"#333",onClick:p,className:y.panelButton}),d&&n("div",{className:y.upload,children:["\u4E0A\u4F20\u6587\u4EF6",t("br",{}),t("input",{id:"uploadFile",type:"file"}),t("div",{onClick:x,children:"\u4E0A\u4F20"})]})]}),n("div",{children:[t(_e,{theme:"outline",size:"24",fill:"#333",onClick:_,className:y.panelButton}),u&&n("div",{className:y.upload,children:["\u65B0\u5EFA\u6587\u4EF6\u5939",t("br",{}),t("input",{id:"addDirInput"}),t("div",{onClick:E,children:"\u65B0\u5EFA"})]})]})]}),t("div",{}),t("div",{className:y.dirButtonContainer,children:r})]})},vt="_main_1dzb8_1",Ft="_addInput_1dzb8_12",Bt="_title_1dzb8_20",Ct="_addButton_1dzb8_26";var O={main:vt,addInput:Ft,title:Bt,addButton:Ct};const Nt=e=>{const s=()=>{const d={gameName:i.currentEditGame,sceneName:document.getElementById("addSceneName").value};w.post(`${i.domain}/api/editGame/addNewScene/`,d).then(h=>{e.added()}).catch(h=>{console.log(h)})};return n("div",{className:O.main,children:[n("div",{className:O.title,children:["\u573A\u666F\u540D\u79F0\uFF1A",t("input",{className:O.addInput,id:"addSceneName"})]}),t("div",{className:O.addButton,onClick:s,children:"\u65B0\u5EFA\u573A\u666F"})]})},wt="_titleText_il1uv_1",At="_scene_il1uv_11",yt="_newSceneButton_il1uv_22",Dt="_sceneList_il1uv_31";var $={titleText:wt,scene:At,newSceneButton:yt,sceneList:Dt};const kt=()=>{const[e,s]=o.exports.useState([]),[d,h]=o.exports.useState(!1),u=()=>{const E={dir:`/${i.currentEditGame}/game/scene`};w.post(`${i.domain}/api/editGame/getAssets/`,E).then(p=>{s(p.data)}).catch(p=>{console.log(p)})},a=()=>{u(),h(!d)};o.exports.useEffect(()=>{u()},[]);const m=g=>{i.currentOpendSceneEdit.includes(g)||i.currentOpendSceneEdit.push(g),i.currentEditScene=g,c.set("updateEditor",!c.get("updateEditor"))},S=[];for(const g of e){let x=!1,E=g.split(".");E[E.length-1]==="json"&&(x=!0);const p=n("div",{className:$.scene,onClick:()=>m(g),children:[t(Ee,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),g]},g);x&&S.push(p)}return n("div",{children:[t("div",{className:$.titleText,children:"\u573A\u666F\u7BA1\u7406"}),n("div",{className:$.newSceneButton,onClick:()=>{h(!d)},children:[t(H,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u65B0\u5EFA\u573A\u666F"]}),t("div",{children:d&&t(Nt,{added:a})}),t("div",{className:$.sceneList,children:S})]})},It=()=>{const e=["\u6E38\u620F\u914D\u7F6E","\u7D20\u6750\u7BA1\u7406","\u573A\u666F\u7BA1\u7406"],[s,d]=o.exports.useState(!1);o.exports.useEffect(()=>{c.set("refSideBar",s),c.connect("refSideBar",()=>{d(c.get("refSideBar"))},"refSideBarFunc")},[]);const h=[];for(const a of e){let m;a===i.editorTag?m=t("div",{className:L.optionMarker}):m=t("div",{});const S=n("div",{className:a===i.editorTag?L.tagButtonOn:L.tagButton,onClick:()=>{i.editorTag=a,c.set("refSideBar",!c.get("refSideBar"))},children:[t("div",{children:a}),m]},a);h.push(S)}let u;switch(i.editorTag){case"\u6E38\u620F\u914D\u7F6E":u=t(ut,{});break;case"\u7D20\u6750\u7BA1\u7406":u=t(Et,{});break;case"\u573A\u666F\u7BA1\u7406":u=t(kt,{});break}return n("aside",{className:L.aside,children:[t("div",{className:L.option,children:h}),t("div",{className:L.sideBarContent,children:u})]})},bt="_main_19sml_1";var Pt={main:bt};const Lt="_main_yjjiw_1",zt="_tag_yjjiw_7",Gt="_tagOpened_yjjiw_17",Ot="_tagList_yjjiw_24",$t="_tagIcon_yjjiw_28";var k={main:Lt,tag:zt,tagOpened:Gt,tagList:Ot,tagIcon:$t};const Mt="_topButtonList_nuwbr_1",Tt="_topButton_nuwbr_1",jt="_addSentencePanel_nuwbr_16",Ut="_addSentenceButton_nuwbr_25",Rt="_sentenceList_nuwbr_35";var B={topButtonList:Mt,topButton:Tt,addSentencePanel:jt,addSentenceButton:Ut,sentenceList:Rt};const Vt=e=>{let s;switch(e){case"dialog":s={type:e,speaker:"",content:"",vocal:"",ignoreSpeaker:!1};break;case"bg":s={type:e,bg:"",noBg:!1,next:!1};break;case"bgm":s={type:e,bgm:"",noBgm:!1};break;case"changeScene":s={type:e,newScene:""};break;case"video":s={type:e,video:""};break;case"changeP":s={type:e,newP:"",next:!1,noP:!1,pos:""};break;case"choose":s={type:e,chooseItem:[{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""},{text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}]};break}return s},qt="_sentence_1ym9a_1",Jt="_dialog_input_1ym9a_11",Wt="_singleOption_1ym9a_19",Kt="_sentenceButtonList_1ym9a_23",Ht="_sentenceButton_1ym9a_23",Qt="_sentenceIndexShow_1ym9a_41";var f={sentence:qt,dialog_input:Jt,singleOption:Wt,sentenceButtonList:Kt,sentenceButton:Ht,sentenceIndexShow:Qt};const Xt=e=>{i.currentSceneSentenceList.splice(e,1),c.set("writeScene",!c.get("writeScene"))},de=(e,s)=>{if(!(e===0&&s===-1||e===i.currentSceneSentenceList.length-1&&s===1)){{const d=i.currentSceneSentenceList[e];i.currentSceneSentenceList.splice(e,1),i.currentSceneSentenceList.splice(e+s,0,d)}c.set("writeScene",!c.get("writeScene"))}},oe=e=>n("div",{className:B.addSentencePanel,children:[n("div",{className:B.addSentenceButton,onClick:()=>{N("dialog",e.index)},children:[t(Y,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("changeP",e.index)},children:[t(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("bg",e.index)},children:[t(R,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("changeScene",e.index)},children:[t(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("choose",e.index)},children:[t(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("bgm",e.index)},children:[t(U,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("video",e.index)},children:[t(T,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]}),b=e=>n("div",{className:f.sentenceButtonList,children:[n("div",{className:f.sentenceButton,onClick:()=>{Xt(e.index)},children:[t(X,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5220\u9664\u672C\u53E5"]}),n("div",{onClick:()=>{de(e.index,-1)},className:f.sentenceButton,children:[t(ve,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0A\u79FB\u672C\u53E5"]}),n("div",{onClick:()=>{de(e.index,1)},className:f.sentenceButton,children:[t(Fe,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u4E0B\u79FB\u672C\u53E5"]}),n("div",{onClick:()=>{e.data.setShowAddPre(!e.data.showAddPre)},className:f.sentenceButton,children:[t(te,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u524D\u63D2\u5165\u53E5\u5B50",e.data.showAddPre&&t(oe,{index:e.data.indexPre})]}),n("div",{onClick:()=>{e.data.setShowAddAfter(!e.data.showAddAfter)},className:f.sentenceButton,children:[t(te,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5728\u672C\u53E5\u540E\u63D2\u5165\u53E5\u5B50",e.data.showAddAfter&&t(oe,{index:e.data.indexAfter})]})]}),Yt=e=>{const[s,d]=o.exports.useState(!1),[h,u]=o.exports.useState(!1),a=e.index,m=e.index+1,S={showAddPre:s,setShowAddPre:d,showAddAfter:h,setShowAddAfter:u,indexPre:a,indexAfter:m};o.exports.useEffect(()=>{document.getElementById("speakerInput"+e.index).value=e.data.speaker,document.getElementById("contentInput"+e.index).value=e.data.content});const g=()=>{i.currentSceneSentenceList[e.index].speaker=document.getElementById("speakerInput"+e.index).value,i.currentSceneSentenceList[e.index].content=document.getElementById("contentInput"+e.index).value,c.set("writeScene",!c.get("writeScene"))},x=r=>{i.currentSceneSentenceList[e.index].ignoreSpeaker=r,c.set("writeScene",!c.get("writeScene"))},[E,p]=o.exports.useState(e.data.vocal),_=()=>r=>{i.currentSceneSentenceList[e.index].vocal=r,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:f.sentence,children:[n("div",{className:f.sentenceIndexShow,children:["\u8BED\u53E5",e.index+1,":\u57FA\u672C\u5BF9\u8BDD"]}),t(b,{index:e.index,data:S}),n("main",{children:[n("div",{className:f.singleOption,children:["\u65C1\u767D\u6A21\u5F0F",t("span",{style:{padding:"0 5px 0 0"},children:" "}),t(P,{id:"dialog_pbms",checked:e.data.ignoreSpeaker,onChange:x}),t("span",{style:{padding:"0 0 0 5px"},children:"\uFF08\u5C06\u4E0D\u4F1A\u663E\u793A\u89D2\u8272\u540D\uFF09"})]}),n("div",{className:f.singleOption,children:["\u89D2\u8272\uFF1A",t("input",{className:f.dialog_input,onChange:g,id:"speakerInput"+e.index}),t("span",{style:{padding:"0 0 0 5px"},children:"\u63D0\u793A\uFF1A\u7559\u7A7A\u53EF\u4EE5\u7EE7\u627F\u4E0A\u4E00\u6761\u5BF9\u8BDD\u7684\u89D2\u8272\u540D"})]}),n("div",{className:f.singleOption,children:["\u5BF9\u8BDD\uFF1A",t("input",{className:f.dialog_input,onChange:g,id:"contentInput"+e.index})]}),n("div",{className:f.singleOption,children:["\u914D\u97F3\u6587\u4EF6\uFF1A",E,t(D,{setShow:p,id:"vocalPicker",dir:"vocal",set:_()})]})]})]},e.index+"dialog")},Zt=e=>{const[s,d]=o.exports.useState(!1),[h,u]=o.exports.useState(!1),a=e.index,m=e.index+1,S={showAddPre:s,setShowAddPre:d,showAddAfter:h,setShowAddAfter:u,indexPre:a,indexAfter:m};o.exports.useEffect(()=>{});const g=r=>{i.currentSceneSentenceList[e.index].noBg=r,c.set("writeScene",!c.get("writeScene"))},x=r=>{i.currentSceneSentenceList[e.index].next=r,c.set("writeScene",!c.get("writeScene"))},[E,p]=o.exports.useState(e.data.bg),_=()=>r=>{i.currentSceneSentenceList[e.index].bg=r,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:f.sentence,children:[n("div",{className:f.sentenceIndexShow,children:["\u8BED\u53E5",e.index+1,":\u66F4\u6539\u80CC\u666F"]}),t(b,{index:e.index,data:S}),n("main",{children:[n("div",{className:f.singleOption,children:["\u5173\u95ED\u80CC\u666F",t("span",{style:{padding:"0 5px 0 0"},children:" "}),t(P,{checked:e.data.noBg,id:"bg_none"+e.index,onChange:g}),t("span",{style:{padding:"0 0 0 5px"},children:"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\uFF09"})]}),n("div",{className:f.singleOption,children:["\u66F4\u6539\u80CC\u666F\u540E\u7EE7\u7EED\u4E0B\u4E00\u53E5",t("span",{style:{padding:"0 5px 0 0"},children:" "}),t(P,{id:"bg_next"+e.index,checked:e.data.next,onChange:x})]}),n("div",{className:f.singleOption,children:["\u80CC\u666F\u6587\u4EF6\uFF1A",E,t(D,{setShow:p,id:"bgPicker",dir:"background",set:_()})]})]})]},e.index+"bg")},en=e=>{const[s,d]=o.exports.useState(!1),[h,u]=o.exports.useState(!1),a=e.index,m=e.index+1,S={showAddPre:s,setShowAddPre:d,showAddAfter:h,setShowAddAfter:u,indexPre:a,indexAfter:m};o.exports.useEffect(()=>{});const g=_=>{i.currentSceneSentenceList[e.index].noBgm=_,c.set("writeScene",!c.get("writeScene"))},[x,E]=o.exports.useState(e.data.bgm),p=()=>_=>{i.currentSceneSentenceList[e.index].bgm=_,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:f.sentence,children:[n("div",{className:f.sentenceIndexShow,children:["\u8BED\u53E5",e.index+1,":\u66F4\u6539\u80CC\u666F\u97F3\u4E50"]}),t(b,{index:e.index,data:S}),n("main",{children:[n("div",{className:f.singleOption,children:["\u5173\u95ED\u80CC\u666F\u97F3\u4E50",t("span",{style:{padding:"0 5px 0 0"},children:" "}),t(P,{id:"bgm_none"+e.index,checked:e.data.noBgm,onChange:g}),t("span",{style:{padding:"0 0 0 5px"},children:"\uFF08\u5C06\u5173\u95ED\u80CC\u666F\u97F3\u4E50\uFF09"})]}),n("div",{className:f.singleOption,children:["\u80CC\u666F\u97F3\u4E50\u6587\u4EF6\uFF1A",x,t(D,{setShow:E,id:"bgmPicker",dir:"bgm",set:p()})]})]})]},e.index+"bgm")},tn=e=>{const[s,d]=o.exports.useState(!1),[h,u]=o.exports.useState(!1),a=e.index,m=e.index+1,S={showAddPre:s,setShowAddPre:d,showAddAfter:h,setShowAddAfter:u,indexPre:a,indexAfter:m};o.exports.useEffect(()=>{});const[g,x]=o.exports.useState(e.data.newScene),E=()=>p=>{i.currentSceneSentenceList[e.index].newScene=p,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:f.sentence,children:[n("div",{className:f.sentenceIndexShow,children:["\u8BED\u53E5",e.index+1,":\u5207\u6362\u573A\u666F"]}),t(b,{index:e.index,data:S}),t("main",{children:n("div",{className:f.singleOption,children:["\u65B0\u573A\u666F\uFF1A",g,t(D,{setShow:x,id:"scenePicker",dir:"scene",set:E()})]})})]},e.index+"scene")},nn=e=>{const[s,d]=o.exports.useState(!1),[h,u]=o.exports.useState(!1),a=e.index,m=e.index+1,S={showAddPre:s,setShowAddPre:d,showAddAfter:h,setShowAddAfter:u,indexPre:a,indexAfter:m};o.exports.useEffect(()=>{});const[g,x]=o.exports.useState(e.data.video),E=()=>p=>{i.currentSceneSentenceList[e.index].video=p,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:f.sentence,children:[n("div",{className:f.sentenceIndexShow,children:["\u8BED\u53E5",e.index+1,":\u64AD\u653E\u89C6\u9891"]}),t(b,{index:e.index,data:S}),t("main",{children:n("div",{className:f.singleOption,children:["\u89C6\u9891\u6587\u4EF6\uFF1A",g,t(D,{setShow:x,id:"videoPicker",dir:"video",set:E()})]})})]},e.index+"scene")},{Option:q}=ne,sn=e=>{const[s,d]=o.exports.useState(!1),[h,u]=o.exports.useState(!1),a=e.index,m=e.index+1,S={showAddPre:s,setShowAddPre:d,showAddAfter:h,setShowAddAfter:u,indexPre:a,indexAfter:m};o.exports.useEffect(()=>{});const g=l=>{i.currentSceneSentenceList[e.index].noP=l,c.set("writeScene",!c.get("writeScene"))},x=l=>{i.currentSceneSentenceList[e.index].next=l,c.set("writeScene",!c.get("writeScene"))},[E,p]=o.exports.useState(e.data.newP),_=()=>l=>{i.currentSceneSentenceList[e.index].newP=l,c.set("writeScene",!c.get("writeScene"))},r=l=>{i.currentSceneSentenceList[e.index].pos=l,c.set("writeScene",!c.get("writeScene"))};return n("div",{className:f.sentence,children:[n("div",{className:f.sentenceIndexShow,children:["\u8BED\u53E5",e.index+1,":\u5207\u6362\u7ACB\u7ED8"]}),t(b,{index:e.index,data:S}),n("main",{children:[n("div",{className:f.singleOption,children:["\u5173\u95ED\u7ACB\u7ED8",t("span",{style:{padding:"0 5px 0 0"},children:" "}),t(P,{id:"p_none",checked:e.data.noP,onChange:g}),t("span",{style:{padding:"0 0 0 5px"},children:"\uFF08\u5C06\u5173\u95ED\u7ACB\u7ED8\uFF09"})]}),n("div",{className:f.singleOption,children:["\u7ACB\u7ED8\u4F4D\u7F6E",t("span",{style:{padding:"0 5px 0 0"},children:" "}),n(ne,{defaultValue:e.data.pos,style:{width:120},onChange:r,children:[t(q,{value:"left",children:"\u5DE6"}),t(q,{value:"",children:"\u4E2D"}),t(q,{value:"right",children:"\u53F3"})]}),t("span",{style:{padding:"0 0 0 5px"},children:"\uFF08\u6539\u53D8\u7ACB\u7ED8\u7684\u4F4D\u7F6E\uFF09"})]}),n("div",{className:f.singleOption,children:["\u5207\u6362\u540E\u6267\u884C\u4E0B\u4E00\u6761\u8BED\u53E5",t("span",{style:{padding:"0 5px 0 0"},children:" "}),t(P,{id:"p_none",checked:e.data.next,onChange:x})]}),n("div",{className:f.singleOption,children:["\u7ACB\u7ED8\u6587\u4EF6\uFF1A",E,t(D,{setShow:p,id:"pPicker",dir:"figure",set:_()})]})]})]},e.index+"dialog")},cn=e=>{const[s,d]=o.exports.useState(!1),[h,u]=o.exports.useState(!1),a=e.index,m=e.index+1,S={showAddPre:s,setShowAddPre:d,showAddAfter:h,setShowAddAfter:u,indexPre:a,indexAfter:m};o.exports.useEffect(()=>{for(let r=0;r<e.data.chooseItem.length;r++)document.getElementById("chooseInput"+e.index+"itemIndex"+r).value=e.data.chooseItem[r].text});const g=()=>{i.currentSceneSentenceList[e.index].chooseItem.push({text:"\u5728\u6B64\u586B\u5165\u5206\u652F\u7684\u540D\u79F0",scene:""}),c.set("writeScene",!c.get("writeScene"))},x=r=>{const l=parseInt(r.split("Index")[1]);console.log(l),i.currentSceneSentenceList[e.index].chooseItem[l].text=document.getElementById(r).value,c.set("writeScene",!c.get("writeScene"))},E=r=>l=>{i.currentSceneSentenceList[e.index].chooseItem[r].scene=l,c.set("writeScene",!c.get("writeScene"))};let p=[],_=0;for(const r of e.data.chooseItem){const l="chooseInput"+e.index+"itemIndex"+_;let F=n("div",{className:f.singleOption,children:["\u5206\u652F\u540D\u79F0\uFF1A",t("input",{className:f.dialog_input,style:{width:"200px"},onChange:()=>{x(l)},id:l}),t(Be,{theme:"outline",size:"24",fill:"#333"}),"\u8DF3\u8F6C\u7684\u573A\u666F\uFF1A",r.scene,t(D,{id:"scenePicker",dir:"scene",set:E(_)})]},_);p.push(F),_++}return n("div",{className:f.sentence,children:[n("div",{className:f.sentenceIndexShow,children:["\u8BED\u53E5",e.index+1,":\u5206\u652F\u8DF3\u8F6C"]}),t(b,{index:e.index,data:S}),n("main",{children:[t("div",{style:{display:"flex",padding:"5px 0 0 0"},children:n("div",{onClick:g,className:f.sentenceButton,children:[t(Ce,{theme:"outline",size:"16",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5206\u652F"]})}),p]})]},e.index+"choose")},an=(e,s)=>{let d;switch(e.type){case"dialog":d=t(Yt,{data:e,index:s},s);break;case"bg":d=t(Zt,{data:e,index:s},s);break;case"bgm":d=t(en,{data:e,index:s},s);break;case"changeScene":d=t(tn,{data:e,index:s},s);break;case"video":d=t(nn,{data:e,index:s},s);break;case"changeP":d=t(sn,{data:e,index:s},s);break;case"choose":d=t(cn,{data:e,index:s},s);break}return d};const dn=e=>{const[s,d]=o.exports.useState(!0),[h,u]=o.exports.useState(!1);o.exports.useEffect(()=>{c.set("updateScene",s),c.connect("updateScene",()=>{d(c.get("updateScene"))},"updateSceneFunc"),c.set("refScene",!0),c.connect("refScene",()=>{J()},"refSceneFunc"),c.get("writeScene")===void 0&&c.set("writeScene",!0),c.connect("writeScene",()=>{W()},"writeSceneFunc"),J()},[]);let a=[];const m=JSON.parse(JSON.stringify(i.currentSceneSentenceList));for(let g=0;g<m.length;g++){const x=m[g],E=an(x,g);a.push(E)}const S=n("div",{className:B.addSentencePanel,children:[n("div",{className:B.addSentenceButton,onClick:()=>{N("dialog")},children:[t(Y,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u6DFB\u52A0\u5BF9\u8BDD"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("dialog")},children:[t(j,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u7ACB\u7ED8"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("dialog")},children:[t(R,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5207\u6362\u80CC\u666F"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("dialog")},children:[t(Z,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u573A\u666F\u8DF3\u8F6C"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("dialog")},children:[t(ee,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u5206\u652F\u9009\u62E9"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("dialog")},children:[t(U,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u80CC\u666F\u97F3\u4E50"]}),n("div",{className:B.addSentenceButton,onClick:()=>{N("dialog")},children:[t(T,{theme:"outline",size:"18",fill:"#333",style:{padding:"0 5px 0 0"}}),"\u63D2\u5165\u89C6\u9891"]})]});return n("div",{children:[n("div",{className:B.topButtonList,children:[t("div",{className:B.topButton,onClick:W,children:"\u4FDD\u5B58\u573A\u666F"}),t("div",{className:B.topButton,onClick:()=>{u(!h)},children:"\u6DFB\u52A0\u8BED\u53E5"}),t("div",{children:h&&S})]}),t("div",{className:B.sentenceList,children:a})]})};function J(){let e=i.currentEditScene;if(e==="")return;const s=`${i.domain}/Games/${i.currentEditGame}/game/scene/${e}`;w.get(s).then(d=>{i.currentSceneSentenceList=d.data,c.set("updateScene",!c.get("updateScene"))}).catch(d=>console.log(d))}function N(e,s){const d=Vt(e);s!==void 0?i.currentSceneSentenceList.splice(s,0,d):i.currentSceneSentenceList.push(d),W()}function W(){const e=`${i.domain}/api/editGame/editScene/`,s={gameName:i.currentEditGame,sceneName:i.currentEditScene,sceneData:i.currentSceneSentenceList};w.post(e,s).then(d=>{J()}).catch(d=>console.log(d))}const on=()=>{const[e,s]=o.exports.useState(!1);o.exports.useEffect(()=>{c.set("updateEditor",e),c.connect("updateEditor",()=>{s(c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},"updateEditorFunc")},[]);const d=a=>{i.currentEditScene=a,c.set("updateEditor",!c.get("updateEditor")),c.set("refScene",!c.get("refScene"))},h=a=>{const m=i.currentOpendSceneEdit.indexOf(a);i.currentOpendSceneEdit.splice(m,1);const S=i.currentOpendSceneEdit.length===0;a===i.currentEditScene&&(S?i.currentEditScene="":i.currentOpendSceneEdit.length<=m?i.currentEditScene=i.currentOpendSceneEdit[i.currentOpendSceneEdit.length-1]:i.currentEditScene=i.currentOpendSceneEdit[m]),c.set("updateEditor",!c.get("updateEditor"))},u=[];for(const a of i.currentOpendSceneEdit){let m;a===i.currentEditScene?m=n("div",{className:k.tagOpened,children:[t(ie,{theme:"outline",size:"20",fill:"#333",className:k.tagIcon}),a,t(se,{theme:"outline",size:"20",fill:"#333",className:k.tagIcon,onClick:()=>{h(a)}})]},a):m=n("div",{className:k.tag,onClick:()=>{d(a)},children:[t(ie,{theme:"outline",size:"20",fill:"#333",className:k.tagIcon}),a,t(se,{theme:"outline",size:"20",fill:"#333",className:k.tagIcon,onClick:S=>{S.preventDefault(),S.stopPropagation(),h(a)}})]},a),u.push(m)}return n("div",{className:k.main,children:[t("div",{className:k.tagList,children:u}),t("div",{children:i.currentEditScene!==""&&t(dn,{sceneName:i.currentEditScene})})]})},un=()=>{const[e,s]=o.exports.useState(!0);return o.exports.useEffect(()=>{c.set("updateEditor",!0),c.connect("updateEditor",()=>{s(c.get("updateEditor"))},"ForceUpdateEditor")},[]),n("div",{children:[t(Ve,{}),n("main",{className:Pt.main,children:[t(It,{}),t(on,{})]})]})};function rn(){const[e,s]=o.exports.useState(!0);return o.exports.useEffect(()=>{c.set("isManageMent",!0),c.connect("isManagement",()=>{s(c.get("isManagement"))},"setIsManagementFunc")},[]),n("div",{className:"App",children:[e&&t(Te,{}),!e&&t(un,{})]})}Ne.render(t(we.StrictMode,{children:t(rn,{})}),document.getElementById("root"));
